Campus Calm - Full Dump (models, views, templates e arquivos de suporte)
================================================================================

### apps/access_requests/__init__.py
--------------------------------------------------------------------------------


### apps/access_requests/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from access_requests.models import AccessRequest, AITriageLog


@admin.register(AccessRequest)
class AccessRequestAdmin(admin.ModelAdmin):
    list_display = ("requester_email", "requester_type", "status", "recommended_plan", "decided_plan")
    list_filter = ("status", "requester_type")
    search_fields = ("requester_email", "requester_name")


@admin.register(AITriageLog)
class AITriageLogAdmin(admin.ModelAdmin):
    list_display = ("access_request", "model_name", "created_at")

### apps/access_requests/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class AccessRequestsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'access_requests'

### apps/access_requests/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='AccessRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('requester_email', models.EmailField(max_length=254)),
                ('requester_name', models.CharField(blank=True, max_length=255)),
                ('requester_type', models.CharField(choices=[('INDIVIDUAL', 'Individual'), ('INSTITUTION', 'Institution')], max_length=20)),
                ('institution_name', models.CharField(blank=True, max_length=255)),
                ('estimated_users', models.PositiveIntegerField(blank=True, null=True)),
                ('wants_features', models.JSONField(default=list)),
                ('message', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected')], default='PENDING', max_length=20)),
                ('recommended_plan', models.CharField(blank=True, choices=[('LITE', 'Lite'), ('PRO', 'Pro')], max_length=10)),
                ('decided_plan', models.CharField(blank=True, choices=[('LITE', 'Lite'), ('PRO', 'Pro')], max_length=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='AITriageLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('model_name', models.CharField(max_length=100)),
                ('input_payload', models.JSONField()),
                ('output_payload', models.JSONField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('access_request', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='triage_logs', to='access_requests.accessrequest')),
            ],
        ),
    ]

### apps/access_requests/migrations/0002_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('access_requests', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='accessrequest',
            name='created_user',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL),
        ),
    ]

### apps/access_requests/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/access_requests/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models

from utils.constants import ACCESS_STATUS_CHOICES, ACCESS_PENDING, PLAN_CHOICES, REQUESTER_TYPE_CHOICES


class AccessRequest(models.Model):
    requester_email = models.EmailField()
    requester_name = models.CharField(max_length=255, blank=True)
    requester_type = models.CharField(max_length=20, choices=REQUESTER_TYPE_CHOICES)
    institution_name = models.CharField(max_length=255, blank=True)
    estimated_users = models.PositiveIntegerField(null=True, blank=True)
    wants_features = models.JSONField(default=list)
    message = models.TextField(blank=True)
    status = models.CharField(max_length=20, choices=ACCESS_STATUS_CHOICES, default=ACCESS_PENDING)
    recommended_plan = models.CharField(max_length=10, choices=PLAN_CHOICES, blank=True)
    decided_plan = models.CharField(max_length=10, choices=PLAN_CHOICES, blank=True)
    created_user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        return self.requester_email


class AITriageLog(models.Model):
    access_request = models.ForeignKey(AccessRequest, on_delete=models.CASCADE, related_name="triage_logs")
    model_name = models.CharField(max_length=100)
    input_payload = models.JSONField()
    output_payload = models.JSONField()
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.access_request.id} - {self.model_name}"

### apps/access_requests/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from access_requests.models import AccessRequest, AITriageLog
from utils.constants import ACCESS_APPROVED, ACCESS_REJECTED


class AccessRequestCreateSerializer(serializers.ModelSerializer):
    class Meta:
        model = AccessRequest
        fields = (
            "id",
            "requester_email",
            "requester_name",
            "requester_type",
            "institution_name",
            "estimated_users",
            "wants_features",
            "message",
            "status",
            "recommended_plan",
            "created_at",
        )
        read_only_fields = ("id", "status", "recommended_plan", "created_at")


class AccessRequestSerializer(serializers.ModelSerializer):
    class Meta:
        model = AccessRequest
        fields = "__all__"


class AITriageLogSerializer(serializers.ModelSerializer):
    class Meta:
        model = AITriageLog
        fields = ("id", "model_name", "input_payload", "output_payload", "created_at")
        read_only_fields = fields


class AccessDecisionSerializer(serializers.Serializer):
    decided_plan = serializers.CharField(required=False)

    def validate_decided_plan(self, value):
        if value and value not in {"LITE", "PRO"}:
            raise serializers.ValidationError("Plano invalido")
        return value

### apps/access_requests/tests.py
--------------------------------------------------------------------------------
from rest_framework.test import APITestCase

from utils.constants import FEATURE_EMAIL_NOTIFICATIONS, PLAN_PRO


class AccessRequestTriageTests(APITestCase):
    def test_triage_recommends_pro(self):
        payload = {
            "requester_email": "inst@example.com",
            "requester_type": "INDIVIDUAL",
            "wants_features": [FEATURE_EMAIL_NOTIFICATIONS],
        }
        response = self.client.post("/api/access/requests/", payload, format="json")
        self.assertEqual(response.status_code, 201)
        self.assertEqual(response.data["recommended_plan"], PLAN_PRO)

### apps/access_requests/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from access_requests.views import (
    AccessApproveView,
    AccessRejectView,
    AccessRequestDetailView,
    AccessRequestListCreateView,
    AccessTriageLogView,
)

urlpatterns = [
    path("requests/", AccessRequestListCreateView.as_view(), name="access-request-list-create"),
    path("requests/<int:pk>/", AccessRequestDetailView.as_view(), name="access-request-detail"),
    path("requests/<int:pk>/approve/", AccessApproveView.as_view(), name="access-request-approve"),
    path("requests/<int:pk>/reject/", AccessRejectView.as_view(), name="access-request-reject"),
    path("triage/<int:pk>/log/", AccessTriageLogView.as_view(), name="access-triage-log"),
]

### apps/access_requests/views.py
--------------------------------------------------------------------------------
from django.shortcuts import get_object_or_404
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from access_requests.models import AccessRequest, AITriageLog
from access_requests.serializers import (
    AccessDecisionSerializer,
    AccessRequestCreateSerializer,
    AccessRequestSerializer,
    AITriageLogSerializer,
)
from utils.constants import ACCESS_APPROVED, ACCESS_REJECTED
from utils.triage import TRIAGE_MODEL_NAME, run_triage


class AccessRequestListCreateView(APIView):
    def get_permissions(self):
        if self.request.method == "POST":
            return [permissions.AllowAny()]
        return [permissions.IsAdminUser()]

    def get(self, request):
        requests = AccessRequest.objects.all().order_by("-created_at")
        return Response(AccessRequestSerializer(requests, many=True).data)

    def post(self, request):
        serializer = AccessRequestCreateSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        access_request = serializer.save()
        triage_result = run_triage(access_request)
        recommended_plan = triage_result["recommended_plan"]
        access_request.recommended_plan = recommended_plan
        access_request.save(update_fields=["recommended_plan"])
        input_payload = serializer.validated_data
        output_payload = triage_result["output_payload"]
        AITriageLog.objects.create(
            access_request=access_request,
            model_name=TRIAGE_MODEL_NAME,
            input_payload=input_payload,
            output_payload=output_payload,
        )
        return Response(AccessRequestCreateSerializer(access_request).data, status=status.HTTP_201_CREATED)


class AccessRequestDetailView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def get(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        return Response(AccessRequestSerializer(access_request).data)


class AccessApproveView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def post(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        serializer = AccessDecisionSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        access_request.status = ACCESS_APPROVED
        access_request.decided_plan = serializer.validated_data.get("decided_plan") or access_request.recommended_plan
        access_request.save(update_fields=["status", "decided_plan"])
        return Response(AccessRequestSerializer(access_request).data)


class AccessRejectView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def post(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        access_request.status = ACCESS_REJECTED
        access_request.save(update_fields=["status"])
        return Response(AccessRequestSerializer(access_request).data)


class AccessTriageLogView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def get(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        log = access_request.triage_logs.order_by("-created_at").first()
        if not log:
            return Response({"detail": "Sem log de triagem."}, status=status.HTTP_404_NOT_FOUND)
        return Response(AITriageLogSerializer(log).data)

### apps/accounts/__init__.py
--------------------------------------------------------------------------------


### apps/accounts/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin as DjangoUserAdmin

from accounts.models import User, UserProfile


@admin.register(User)
class UserAdmin(DjangoUserAdmin):
    model = User
    ordering = ("email",)
    list_display = ("email", "name", "is_staff", "is_active", "created_at")
    search_fields = ("email", "name")
    fieldsets = (
        (None, {"fields": ("email", "password")}),
        ("Personal info", {"fields": ("name", "phone_number")}),
        ("Permissions", {"fields": ("is_active", "is_staff", "is_superuser", "groups", "user_permissions")}),
        ("Important dates", {"fields": ("last_login",)}),
    )
    add_fieldsets = (
        (
            None,
            {
                "classes": ("wide",),
                "fields": ("email", "name", "password1", "password2", "is_staff", "is_superuser"),
            },
        ),
    )


@admin.register(UserProfile)
class UserProfileAdmin(admin.ModelAdmin):
    list_display = ("user", "plan", "allow_email", "allow_whatsapp", "allow_sms", "consent_at")
    list_filter = ("plan", "allow_email", "allow_whatsapp", "allow_sms")

### apps/accounts/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class AccountsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'accounts'

    def ready(self):
        from accounts import signals  # noqa: F401

### apps/accounts/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.db import migrations, models
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('name', models.CharField(max_length=255)),
                ('phone_number', models.CharField(blank=True, max_length=30)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('is_active', models.BooleanField(default=True)),
                ('is_staff', models.BooleanField(default=False)),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'abstract': False,
            },
        ),
    ]

### apps/accounts/migrations/0002_userprofile.py
--------------------------------------------------------------------------------
# Generated by Django 6.0.1 on 2026-02-02 14:09

import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('accounts', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='UserProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('phone', models.CharField(blank=True, max_length=30)),
                ('plan', models.CharField(choices=[('FREE', 'Free'), ('PAGO', 'Pago')], default='FREE', max_length=10)),
                ('allow_whatsapp', models.BooleanField(default=True)),
                ('allow_sms', models.BooleanField(default=False)),
                ('allow_email', models.BooleanField(default=True)),
                ('consent_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='profile', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/accounts/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/accounts/models.py
--------------------------------------------------------------------------------
from django.contrib.auth.models import AbstractBaseUser, BaseUserManager, PermissionsMixin
from django.db import models
from django.utils import timezone


class UserManager(BaseUserManager):
    def create_user(self, email, password=None, **extra_fields):
        if not email:
            raise ValueError("Email is required")
        email = self.normalize_email(email)
        user = self.model(email=email, **extra_fields)
        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_superuser(self, email, password=None, **extra_fields):
        extra_fields.setdefault("is_staff", True)
        extra_fields.setdefault("is_superuser", True)
        extra_fields.setdefault("is_active", True)
        if not extra_fields.get("is_staff"):
            raise ValueError("Superuser must have is_staff=True")
        if not extra_fields.get("is_superuser"):
            raise ValueError("Superuser must have is_superuser=True")
        return self.create_user(email, password, **extra_fields)


class User(AbstractBaseUser, PermissionsMixin):
    email = models.EmailField(unique=True)
    name = models.CharField(max_length=255)
    phone_number = models.CharField(max_length=30, blank=True)
    created_at = models.DateTimeField(default=timezone.now)

    is_active = models.BooleanField(default=True)
    is_staff = models.BooleanField(default=False)

    objects = UserManager()

    EMAIL_FIELD = "email"
    USERNAME_FIELD = "email"
    REQUIRED_FIELDS = ["name"]

    def __str__(self):
        return self.email


# Bloco: Perfil e consentimentos do usuario
class UserProfile(models.Model):
    PLAN_FREE = "FREE"
    PLAN_PAID = "PAGO"
    PLAN_CHOICES = [
        (PLAN_FREE, "Free"),
        (PLAN_PAID, "Pago"),
    ]

    user = models.OneToOneField(User, on_delete=models.CASCADE, related_name="profile")
    phone = models.CharField(max_length=30, blank=True)
    plan = models.CharField(max_length=10, choices=PLAN_CHOICES, default=PLAN_FREE)
    allow_whatsapp = models.BooleanField(default=True)
    allow_sms = models.BooleanField(default=False)
    allow_email = models.BooleanField(default=True)
    consent_at = models.DateTimeField(default=timezone.now)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.user.email} profile"

### apps/accounts/serializers.py
--------------------------------------------------------------------------------
from django.contrib.auth import get_user_model
from rest_framework import serializers

User = get_user_model()


class UserSerializer(serializers.ModelSerializer):
    class Meta:
        model = User
        fields = ("id", "email", "name", "phone_number", "created_at")
        read_only_fields = ("id", "created_at")


class RegisterSerializer(serializers.ModelSerializer):
    password = serializers.CharField(write_only=True, min_length=6)

    class Meta:
        model = User
        fields = ("email", "name", "phone_number", "password")

    def create(self, validated_data):
        password = validated_data.pop("password")
        user = User.objects.create_user(password=password, **validated_data)
        return user

### apps/accounts/signals.py
--------------------------------------------------------------------------------
from django.db.models.signals import post_save
from django.dispatch import receiver

from accounts.models import User, UserProfile


# Bloco: Criacao automatica de perfil
@receiver(post_save, sender=User)
def ensure_user_profile(sender, instance, created, **kwargs):
    if created:
        UserProfile.objects.get_or_create(
            user=instance,
            defaults={
                "phone": instance.phone_number or "",
                "plan": UserProfile.PLAN_FREE,
                "allow_whatsapp": True,
                "allow_sms": False,
                "allow_email": True,
            },
        )

### apps/accounts/tests.py
--------------------------------------------------------------------------------
from django.urls import reverse
from rest_framework.test import APITestCase


class AuthTests(APITestCase):
    def test_register_and_login(self):
        register_url = "/api/auth/register/"
        payload = {
            "email": "test@example.com",
            "name": "Teste",
            "password": "strongpass123",
        }
        response = self.client.post(register_url, payload, format="json")
        self.assertEqual(response.status_code, 201)
        self.assertIn("access", response.data)

        login_url = "/api/auth/login/"
        login_response = self.client.post(login_url, {"email": payload["email"], "password": payload["password"]})
        self.assertEqual(login_response.status_code, 200)
        self.assertIn("access", login_response.data)

### apps/accounts/urls.py
--------------------------------------------------------------------------------
from django.urls import path
from rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView

from accounts.views import MeView, RegisterView

urlpatterns = [
    path("register/", RegisterView.as_view(), name="auth-register"),
    path("login/", TokenObtainPairView.as_view(), name="auth-login"),
    path("refresh/", TokenRefreshView.as_view(), name="auth-refresh"),
    path("me/", MeView.as_view(), name="auth-me"),
]

### apps/accounts/views.py
--------------------------------------------------------------------------------
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView
from rest_framework_simplejwt.tokens import RefreshToken

from accounts.serializers import RegisterSerializer, UserSerializer
from billing.models import Plan, UserSubscription
from utils.constants import PLAN_LITE


class RegisterView(APIView):
    permission_classes = [permissions.AllowAny]

    def post(self, request):
        serializer = RegisterSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        user = serializer.save()
        plan = Plan.objects.filter(code=PLAN_LITE, is_active=True).first()
        if plan:
            UserSubscription.objects.get_or_create(user=user, defaults={"plan": plan})
        refresh = RefreshToken.for_user(user)
        return Response(
            {
                "user": UserSerializer(user).data,
                "refresh": str(refresh),
                "access": str(refresh.access_token),
            },
            status=status.HTTP_201_CREATED,
        )


class MeView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        return Response(UserSerializer(request.user).data)

### apps/agenda/__init__.py
--------------------------------------------------------------------------------


### apps/agenda/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from agenda.models import CalendarEvent, ReminderRule


@admin.register(CalendarEvent)
class CalendarEventAdmin(admin.ModelAdmin):
    list_display = ("title", "user", "event_type", "start_at")
    list_filter = ("event_type",)
    search_fields = ("title", "user__email")


@admin.register(ReminderRule)
class ReminderRuleAdmin(admin.ModelAdmin):
    list_display = ("user", "target_type", "remind_before_minutes", "is_active")
    list_filter = ("target_type", "is_active")

### apps/agenda/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class AgendaConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'agenda'

### apps/agenda/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('planner', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='ReminderRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('target_type', models.CharField(choices=[('TASK', 'Task'), ('EVENT', 'Event')], max_length=10)),
                ('remind_before_minutes', models.PositiveIntegerField()),
                ('channels', models.JSONField(default=list)),
                ('is_active', models.BooleanField(default=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reminder_rules', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='CalendarEvent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('event_type', models.CharField(choices=[('PROVA', 'Prova'), ('ENTREGA', 'Entrega'), ('APRESENTACAO', 'Apresentacao'), ('AULA_IMPORTANTE', 'Aula importante'), ('OUTRO', 'Outro')], max_length=20)),
                ('start_at', models.DateTimeField()),
                ('end_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('related_task', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='events', to='planner.task')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='events', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/agenda/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/agenda/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models

from planner.models import Task
from utils.constants import EVENT_TYPE_CHOICES, REMINDER_TARGET_CHOICES


class CalendarEvent(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="events")
    title = models.CharField(max_length=200)
    event_type = models.CharField(max_length=20, choices=EVENT_TYPE_CHOICES)
    start_at = models.DateTimeField()
    end_at = models.DateTimeField(null=True, blank=True)
    related_task = models.ForeignKey(Task, on_delete=models.SET_NULL, null=True, blank=True, related_name="events")
    notes = models.TextField(blank=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title


class ReminderRule(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="reminder_rules")
    target_type = models.CharField(max_length=10, choices=REMINDER_TARGET_CHOICES)
    remind_before_minutes = models.PositiveIntegerField()
    channels = models.JSONField(default=list)
    is_active = models.BooleanField(default=True)

    def __str__(self):
        return f"{self.user.email} - {self.target_type}"

### apps/agenda/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from agenda.models import CalendarEvent, ReminderRule


class CalendarEventSerializer(serializers.ModelSerializer):
    class Meta:
        model = CalendarEvent
        fields = (
            "id",
            "title",
            "event_type",
            "start_at",
            "end_at",
            "related_task",
            "notes",
            "created_at",
        )
        read_only_fields = ("id", "created_at")


class ReminderRuleSerializer(serializers.ModelSerializer):
    class Meta:
        model = ReminderRule
        fields = ("id", "target_type", "remind_before_minutes", "channels", "is_active")
        read_only_fields = ("id",)

### apps/agenda/tests.py
--------------------------------------------------------------------------------
from datetime import date

from django.contrib.auth import get_user_model
from rest_framework.test import APITestCase
from rest_framework_simplejwt.tokens import RefreshToken

from billing.models import Plan, UserSubscription
from utils.constants import FEATURE_IN_APP_REMINDERS, FEATURE_PLANNER_BASIC, PLAN_LITE

User = get_user_model()


class ReminderGenerationTests(APITestCase):
    def setUp(self):
        self.user = User.objects.create_user(email="agenda@example.com", name="Agenda", password="pass12345")
        plan, _ = Plan.objects.get_or_create(
            code=PLAN_LITE,
            defaults={
                "name": "Lite",
                "features": [FEATURE_PLANNER_BASIC, FEATURE_IN_APP_REMINDERS],
                "is_active": True,
            },
        )
        UserSubscription.objects.create(user=self.user, plan=plan)
        refresh = RefreshToken.for_user(self.user)
        self.client.credentials(HTTP_AUTHORIZATION=f"Bearer {refresh.access_token}")

    def test_task_create_and_generate_reminders(self):
        task_payload = {
            "title": "Trabalho",
            "description": "Entrega final",
            "due_date": date.today().isoformat(),
            "stress_level": 3,
            "status": "TODO",
        }
        task_response = self.client.post("/api/planner/tasks/", task_payload, format="json")
        self.assertEqual(task_response.status_code, 201)

        rule_payload = {
            "target_type": "TASK",
            "remind_before_minutes": 60,
            "channels": ["EMAIL"],
            "is_active": True,
        }
        rule_response = self.client.post("/api/agenda/reminder-rules/", rule_payload, format="json")
        self.assertEqual(rule_response.status_code, 201)

        generate_response = self.client.post("/api/agenda/generate-reminders/", {}, format="json")
        self.assertEqual(generate_response.status_code, 200)
        self.assertIn("created", generate_response.data)

### apps/agenda/urls.py
--------------------------------------------------------------------------------
from django.urls import path
from rest_framework.routers import DefaultRouter

from agenda.views import CalendarEventViewSet, GenerateRemindersView, AgendaWeekView, ReminderRuleViewSet

router = DefaultRouter()
router.register(r"events", CalendarEventViewSet, basename="events")
router.register(r"reminder-rules", ReminderRuleViewSet, basename="reminder-rules")

urlpatterns = router.urls + [
    path("week/", AgendaWeekView.as_view(), name="agenda-week"),
    path("generate-reminders/", GenerateRemindersView.as_view(), name="agenda-generate-reminders"),
]

### apps/agenda/views.py
--------------------------------------------------------------------------------
from datetime import datetime, time, timedelta

from django.utils import timezone
from rest_framework import permissions, status, viewsets
from rest_framework.response import Response
from rest_framework.views import APIView

from agenda.models import CalendarEvent, ReminderRule
from agenda.serializers import CalendarEventSerializer, ReminderRuleSerializer
from notifications.models import NotificationQueue
from notifications.services.reminder_queue import create_notifications_for_user
from planner.models import Task
from utils.constants import (
    CHANNEL_EMAIL,
    FEATURE_AGENDA_BASIC,
    FEATURE_IN_APP_REMINDERS,
    NOTIF_PENDING,
    REMINDER_TARGET_EVENT,
    REMINDER_TARGET_TASK,
)
from utils.features import require_feature
from utils.gating import gate_generate_reminders


class CalendarEventViewSet(viewsets.ModelViewSet):
    serializer_class = CalendarEventSerializer
    permission_classes = [permissions.IsAuthenticated]

    def initial(self, request, *args, **kwargs):
        require_feature(request.user, FEATURE_AGENDA_BASIC)
        return super().initial(request, *args, **kwargs)

    def get_queryset(self):
        return CalendarEvent.objects.filter(user=self.request.user).order_by("start_at")

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)


class ReminderRuleViewSet(viewsets.ModelViewSet):
    serializer_class = ReminderRuleSerializer
    permission_classes = [permissions.IsAuthenticated]

    def initial(self, request, *args, **kwargs):
        require_feature(request.user, FEATURE_IN_APP_REMINDERS)
        return super().initial(request, *args, **kwargs)

    def get_queryset(self):
        return ReminderRule.objects.filter(user=self.request.user)

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)


class AgendaWeekView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_AGENDA_BASIC)
        now = timezone.now()
        start_of_week = now - timedelta(days=now.weekday())
        end_of_week = start_of_week + timedelta(days=6)
        events = CalendarEvent.objects.filter(
            user=request.user,
            start_at__date__gte=start_of_week.date(),
            start_at__date__lte=end_of_week.date(),
        ).order_by("start_at")
        return Response(CalendarEventSerializer(events, many=True).data)


class GenerateRemindersView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request):
        require_feature(request.user, FEATURE_IN_APP_REMINDERS)
        allowed, message = gate_generate_reminders(request.user)
        if not allowed:
            return Response({"detail": message}, status=status.HTTP_403_FORBIDDEN)

        # Bloco: Geracao de lembretes para usuario
        created = create_notifications_for_user(request.user)
        return Response({"created": created})

### apps/analytics/__init__.py
--------------------------------------------------------------------------------


### apps/analytics/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

# No models to register for MVP.

### apps/analytics/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class AnalyticsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'analytics'

### apps/analytics/management/__init__.py
--------------------------------------------------------------------------------


### apps/analytics/management/commands/__init__.py
--------------------------------------------------------------------------------


### apps/analytics/management/commands/seed_demo_data.py
--------------------------------------------------------------------------------
from datetime import date, timedelta

from django.core.management.base import BaseCommand
from django.utils import timezone

from agenda.models import CalendarEvent, ReminderRule
from billing.models import Plan, UserSubscription
from content.models import GuidedContent
from mood.models import MoodEntry
from planner.models import Task
from semester.models import Assessment, Course, Semester
from utils.constants import (
    CONTENT_ANTI_PROCRASTINACAO,
    CONTENT_FOCO,
    CONTENT_PRE_PROVA,
    EVENT_ENTREGA,
    EVENT_PROVA,
    MOOD_BAD,
    MOOD_GOOD,
    MOOD_OK,
    MOOD_VERY_GOOD,
    PLAN_LITE,
)
from django.contrib.auth import get_user_model


class Command(BaseCommand):
    help = "Cria dados de exemplo para o MVP"

    def add_arguments(self, parser):
        parser.add_argument("--email", help="Email do usuario para popular dados")

    def handle(self, *args, **options):
        User = get_user_model()
        email = options.get("email")
        if email:
            user = User.objects.filter(email=email).first()
            if not user:
                self.stdout.write(self.style.ERROR("Usuario nao encontrado."))
                return
        else:
            user = User.objects.first()
            if not user:
                self.stdout.write(self.style.ERROR("Nenhum usuario encontrado."))
                return

        plan = Plan.objects.filter(code=PLAN_LITE).first()
        if plan:
            UserSubscription.objects.get_or_create(user=user, defaults={"plan": plan})

        MoodEntry.objects.get_or_create(user=user, mood=MOOD_OK, defaults={"notes": "Inicio do semestre"})
        MoodEntry.objects.get_or_create(user=user, mood=MOOD_GOOD, defaults={"notes": "Boa semana"})
        MoodEntry.objects.get_or_create(user=user, mood=MOOD_BAD, defaults={"notes": "Cansaco"})
        MoodEntry.objects.get_or_create(user=user, mood=MOOD_VERY_GOOD, defaults={"notes": "Semana excelente"})

        Task.objects.get_or_create(
            user=user,
            title="Trabalho final",
            defaults={
                "description": "Entrega da disciplina X",
                "due_date": date.today() + timedelta(days=10),
                "stress_level": 3,
                "status": "TODO",
            },
        )
        Task.objects.get_or_create(
            user=user,
            title="Leitura cap. 3",
            defaults={
                "description": "Revisao para prova",
                "due_date": date.today() + timedelta(days=5),
                "stress_level": 2,
                "status": "DOING",
            },
        )
        Task.objects.get_or_create(
            user=user,
            title="Lista de exercicios",
            defaults={
                "description": "Praticar conteudos de logica",
                "due_date": date.today() + timedelta(days=3),
                "stress_level": 2,
                "status": "TODO",
            },
        )

        semester, _ = Semester.objects.get_or_create(
            user=user,
            name="2026.1",
            defaults={
                "start_date": date.today() - timedelta(days=20),
                "end_date": date.today() + timedelta(days=120),
            },
        )

        course_math, _ = Course.objects.get_or_create(
            semester=semester,
            title="Matematica Discreta",
            defaults={"teacher": "Prof. Silva", "credits": 4},
        )
        course_alg, _ = Course.objects.get_or_create(
            semester=semester,
            title="Algoritmos I",
            defaults={"teacher": "Prof. Souza", "credits": 4},
        )
        course_db, _ = Course.objects.get_or_create(
            semester=semester,
            title="Banco de Dados",
            defaults={"teacher": "Profa. Carla", "credits": 4},
        )

        Assessment.objects.get_or_create(
            course=course_math,
            title="Prova 1",
            defaults={"score": 7.5, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=7)},
        )
        Assessment.objects.get_or_create(
            course=course_math,
            title="Trabalho 1",
            defaults={"score": 8.0, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=14)},
        )
        Assessment.objects.get_or_create(
            course=course_alg,
            title="Trabalho 1",
            defaults={"score": 8.0, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=12)},
        )
        Assessment.objects.get_or_create(
            course=course_db,
            title="Prova 1",
            defaults={"score": 6.5, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=9)},
        )

        CalendarEvent.objects.get_or_create(
            user=user,
            title="Entrega Trabalho Final",
            defaults={"event_type": EVENT_ENTREGA, "start_at": timezone.now() + timedelta(days=9)},
        )
        CalendarEvent.objects.get_or_create(
            user=user,
            title="Prova Matematica",
            defaults={"event_type": EVENT_PROVA, "start_at": timezone.now() + timedelta(days=7)},
        )
        CalendarEvent.objects.get_or_create(
            user=user,
            title="Prova Banco de Dados",
            defaults={"event_type": EVENT_PROVA, "start_at": timezone.now() + timedelta(days=9)},
        )

        ReminderRule.objects.get_or_create(
            user=user,
            target_type="TASK",
            defaults={"remind_before_minutes": 1440, "channels": ["EMAIL"], "is_active": True},
        )

        GuidedContent.objects.get_or_create(
            title="Respiracao pre-prova",
            defaults={
                "category": CONTENT_PRE_PROVA,
                "duration_minutes": 8,
                "body_text": "Exercicio guiado de respiracao para antes da prova.",
                "is_premium": False,
            },
        )
        GuidedContent.objects.get_or_create(
            title="Anti-procrastinacao em 10 minutos",
            defaults={
                "category": CONTENT_ANTI_PROCRASTINACAO,
                "duration_minutes": 10,
                "body_text": "Passos curtos para iniciar tarefas e manter o ritmo.",
                "is_premium": False,
            },
        )
        GuidedContent.objects.get_or_create(
            title="Foco profundo 25min",
            defaults={
                "category": CONTENT_FOCO,
                "duration_minutes": 25,
                "body_text": "Sessao guiada de foco com pausas conscientes.",
                "is_premium": True,
            },
        )

        self.stdout.write(self.style.SUCCESS("seed_demo_data: ok"))

### apps/analytics/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/analytics/models.py
--------------------------------------------------------------------------------
from django.db import models

# Intencionalmente vazio para o MVP.

### apps/analytics/tests.py
--------------------------------------------------------------------------------


### apps/analytics/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from analytics.views import DashboardView, SemesterAnalyticsView

urlpatterns = [
    path("dashboard/", DashboardView.as_view(), name="analytics-dashboard"),
    path("semester/<int:semester_id>/", SemesterAnalyticsView.as_view(), name="analytics-semester"),
]

### apps/analytics/views.py
--------------------------------------------------------------------------------
from django.shortcuts import get_object_or_404
from django.utils import timezone
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from agenda.models import CalendarEvent
from mood.models import MoodEntry
from planner.models import Task
from semester.models import Semester
from utils.constants import FEATURE_DASHBOARD_BASIC, FEATURE_REPORTS_ADVANCED, SEMESTER_ACTIVE
from utils.features import has_feature, require_feature


class DashboardView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_DASHBOARD_BASIC)
        now = timezone.now()
        tasks = Task.objects.filter(user=request.user)
        events = CalendarEvent.objects.filter(user=request.user, start_at__gte=now)
        moods = MoodEntry.objects.filter(user=request.user)
        active_semester = Semester.objects.filter(user=request.user, status=SEMESTER_ACTIVE).first()
        return Response(
            {
                "tasks": {
                    "todo": tasks.filter(status="TODO").count(),
                    "doing": tasks.filter(status="DOING").count(),
                    "done": tasks.filter(status="DONE").count(),
                },
                "upcoming_events": events.count(),
                "mood_entries": moods.count(),
                "active_semester": active_semester.name if active_semester else None,
            }
        )


class SemesterAnalyticsView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request, semester_id):
        if not has_feature(request.user, FEATURE_REPORTS_ADVANCED):
            return Response({"detail": "Plano atual nao permite analytics avancado."}, status=status.HTTP_403_FORBIDDEN)
        semester = get_object_or_404(Semester, pk=semester_id, user=request.user)
        courses = semester.courses.all()
        return Response(
            {
                "semester": semester.name,
                "courses": [
                    {
                        "title": course.title,
                        "status": course.status,
                        "final_grade": course.final_grade,
                    }
                    for course in courses
                ],
            }
        )

### apps/billing/__init__.py
--------------------------------------------------------------------------------


### apps/billing/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from billing.models import Plan, UserSubscription


@admin.register(Plan)
class PlanAdmin(admin.ModelAdmin):
    list_display = ("code", "name", "is_active")
    list_filter = ("is_active",)


@admin.register(UserSubscription)
class UserSubscriptionAdmin(admin.ModelAdmin):
    list_display = ("user", "plan", "is_active", "started_at")
    list_filter = ("is_active", "plan")

### apps/billing/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig
from django.db.models.signals import post_migrate


class BillingConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'billing'

    def ready(self):
        from billing.signals import seed_plans

        post_migrate.connect(seed_plans, sender=self)

### apps/billing/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Plan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(choices=[('LITE', 'Lite'), ('PRO', 'Pro')], max_length=10, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True)),
                ('features', models.JSONField(default=list)),
                ('is_active', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='UserSubscription',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('is_active', models.BooleanField(default=True)),
                ('plan', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='billing.plan')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='subscription', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/billing/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/billing/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models

from utils.constants import PLAN_CHOICES, PLAN_LITE


class Plan(models.Model):
    code = models.CharField(max_length=10, choices=PLAN_CHOICES, unique=True)
    name = models.CharField(max_length=100)
    description = models.TextField(blank=True)
    features = models.JSONField(default=list)
    is_active = models.BooleanField(default=True)

    def __str__(self):
        return f"{self.code}"

    @staticmethod
    def default_lite_features():
        return [
            "MOOD_BASIC",
            "POMODORO_BASIC",
            "PLANNER_BASIC",
            "AGENDA_BASIC",
            "IN_APP_REMINDERS",
            "DASHBOARD_BASIC",
            "CONTENT_LIMITED",
        ]

    @staticmethod
    def default_pro_features():
        return Plan.default_lite_features() + [
            "EMAIL_NOTIFICATIONS",
            "REPORTS_ADVANCED",
            "SEMESTER_SUMMARY",
            "COACH_ADVANCED",
            "CONTENT_FULL",
        ]


class UserSubscription(models.Model):
    user = models.OneToOneField(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="subscription")
    plan = models.ForeignKey(Plan, on_delete=models.PROTECT)
    started_at = models.DateTimeField(auto_now_add=True)
    is_active = models.BooleanField(default=True)

    def __str__(self):
        return f"{self.user.email} -> {self.plan.code if self.plan else PLAN_LITE}"

### apps/billing/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from billing.models import Plan, UserSubscription


class PlanSerializer(serializers.ModelSerializer):
    class Meta:
        model = Plan
        fields = ("code", "name", "description", "features")


class UserSubscriptionSerializer(serializers.ModelSerializer):
    plan = PlanSerializer()

    class Meta:
        model = UserSubscription
        fields = ("plan", "started_at", "is_active")


class SetPlanSerializer(serializers.Serializer):
    user_id = serializers.IntegerField()
    plan_code = serializers.CharField()

### apps/billing/signals.py
--------------------------------------------------------------------------------
from django.db import transaction

from billing.models import Plan
from utils.constants import (
    FEATURE_AGENDA_BASIC,
    FEATURE_COACH_ADVANCED,
    FEATURE_CONTENT_FULL,
    FEATURE_CONTENT_LIMITED,
    FEATURE_DASHBOARD_BASIC,
    FEATURE_EMAIL_NOTIFICATIONS,
    FEATURE_IN_APP_REMINDERS,
    FEATURE_MOOD_BASIC,
    FEATURE_PLANNER_BASIC,
    FEATURE_POMODORO_BASIC,
    FEATURE_REPORTS_ADVANCED,
    FEATURE_SEMESTER_SUMMARY,
    PLAN_LITE,
    PLAN_PRO,
)


def seed_plans(sender, **kwargs):
    with transaction.atomic():
        Plan.objects.get_or_create(
            code=PLAN_LITE,
            defaults={
                "name": "Lite",
                "description": "Plano basico para organizacao e bem-estar.",
                "features": [
                    FEATURE_MOOD_BASIC,
                    FEATURE_POMODORO_BASIC,
                    FEATURE_PLANNER_BASIC,
                    FEATURE_AGENDA_BASIC,
                    FEATURE_IN_APP_REMINDERS,
                    FEATURE_DASHBOARD_BASIC,
                    FEATURE_CONTENT_LIMITED,
                ],
                "is_active": True,
            },
        )
        Plan.objects.get_or_create(
            code=PLAN_PRO,
            defaults={
                "name": "Pro",
                "description": "Plano completo com notificacoes e relatorios.",
                "features": [
                    FEATURE_MOOD_BASIC,
                    FEATURE_POMODORO_BASIC,
                    FEATURE_PLANNER_BASIC,
                    FEATURE_AGENDA_BASIC,
                    FEATURE_IN_APP_REMINDERS,
                    FEATURE_DASHBOARD_BASIC,
                    FEATURE_CONTENT_LIMITED,
                    FEATURE_EMAIL_NOTIFICATIONS,
                    FEATURE_REPORTS_ADVANCED,
                    FEATURE_SEMESTER_SUMMARY,
                    FEATURE_COACH_ADVANCED,
                    FEATURE_CONTENT_FULL,
                ],
                "is_active": True,
            },
        )

### apps/billing/tests.py
--------------------------------------------------------------------------------


### apps/billing/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from billing.views import CurrentPlanView, SetPlanView

urlpatterns = [
    path("plan/", CurrentPlanView.as_view(), name="billing-plan"),
    path("set-plan/", SetPlanView.as_view(), name="billing-set-plan"),
]

### apps/billing/views.py
--------------------------------------------------------------------------------
from django.contrib.auth import get_user_model
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from billing.models import Plan, UserSubscription
from billing.serializers import PlanSerializer, SetPlanSerializer, UserSubscriptionSerializer
from utils.constants import PLAN_LITE

User = get_user_model()


class CurrentPlanView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        subscription = UserSubscription.objects.filter(user=request.user, is_active=True).select_related("plan").first()
        if subscription:
            return Response(UserSubscriptionSerializer(subscription).data)
        plan = Plan.objects.filter(code=PLAN_LITE, is_active=True).first()
        if not plan:
            return Response({"detail": "Plano nao configurado."}, status=status.HTTP_404_NOT_FOUND)
        return Response({"plan": PlanSerializer(plan).data, "started_at": None, "is_active": False})


class SetPlanView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def post(self, request):
        serializer = SetPlanSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        user = User.objects.get(id=serializer.validated_data["user_id"])
        plan = Plan.objects.get(code=serializer.validated_data["plan_code"])
        subscription, _ = UserSubscription.objects.get_or_create(user=user, defaults={"plan": plan})
        subscription.plan = plan
        subscription.is_active = True
        subscription.save()
        return Response(UserSubscriptionSerializer(subscription).data)

### apps/coach_ai/__init__.py
--------------------------------------------------------------------------------


### apps/coach_ai/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from coach_ai.models import CoachLog


@admin.register(CoachLog)
class CoachLogAdmin(admin.ModelAdmin):
    list_display = ("user", "trigger_type", "created_at")
    list_filter = ("trigger_type",)

### apps/coach_ai/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class CoachAiConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'coach_ai'

### apps/coach_ai/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='CoachLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('trigger_type', models.CharField(choices=[('PRAZO_PROXIMO', 'Prazo proximo'), ('ATRASO', 'Atraso'), ('HUMOR_BAIXO', 'Humor baixo'), ('SEMESTRE_CONCLUIDO', 'Semestre concluido'), ('REPROVACAO', 'Reprovacao')], max_length=30)),
                ('suggestion_text', models.TextField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='coach_logs', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/coach_ai/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/coach_ai/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models

from utils.constants import COACH_TRIGGER_CHOICES


class CoachLog(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="coach_logs")
    trigger_type = models.CharField(max_length=30, choices=COACH_TRIGGER_CHOICES)
    suggestion_text = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.user.email} - {self.trigger_type}"

### apps/coach_ai/tests.py
--------------------------------------------------------------------------------


### apps/coach_ai/views.py
--------------------------------------------------------------------------------


### apps/content/__init__.py
--------------------------------------------------------------------------------


### apps/content/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from content.models import GuidedContent


@admin.register(GuidedContent)
class GuidedContentAdmin(admin.ModelAdmin):
    list_display = ("title", "category", "duration_minutes", "is_premium")
    list_filter = ("category", "is_premium")

### apps/content/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class ContentConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'content'

### apps/content/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='GuidedContent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('category', models.CharField(choices=[('PRE_PROVA', 'Pre-prova'), ('ANTI_PROCRASTINACAO', 'Anti-procrastinacao'), ('FOCO', 'Foco')], max_length=50)),
                ('duration_minutes', models.PositiveIntegerField()),
                ('body_text', models.TextField()),
                ('is_premium', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
        ),
    ]

### apps/content/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/content/models.py
--------------------------------------------------------------------------------
from django.db import models

from utils.constants import CONTENT_CATEGORY_CHOICES


class GuidedContent(models.Model):
    title = models.CharField(max_length=200)
    category = models.CharField(max_length=50, choices=CONTENT_CATEGORY_CHOICES)
    duration_minutes = models.PositiveIntegerField()
    body_text = models.TextField()
    is_premium = models.BooleanField(default=False)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title

### apps/content/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from content.models import GuidedContent


class GuidedContentSerializer(serializers.ModelSerializer):
    class Meta:
        model = GuidedContent
        fields = ("id", "title", "category", "duration_minutes", "body_text", "is_premium", "created_at")
        read_only_fields = ("id", "created_at")

### apps/content/tests.py
--------------------------------------------------------------------------------


### apps/content/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from content.views import GuidedContentDetailView, GuidedContentListView

urlpatterns = [
    path("guided/", GuidedContentListView.as_view(), name="guided-content"),
    path("guided/<int:pk>/", GuidedContentDetailView.as_view(), name="guided-content-detail"),
]

### apps/content/views.py
--------------------------------------------------------------------------------
from django.shortcuts import get_object_or_404
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from content.models import GuidedContent
from content.serializers import GuidedContentSerializer
from utils.constants import FEATURE_CONTENT_FULL, FEATURE_CONTENT_LIMITED
from utils.features import has_feature


class GuidedContentListView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        if not has_feature(request.user, FEATURE_CONTENT_FULL) and not has_feature(request.user, FEATURE_CONTENT_LIMITED):
            return Response({"detail": "Plano atual nao permite conteudos."}, status=status.HTTP_403_FORBIDDEN)
        queryset = GuidedContent.objects.all().order_by("-created_at")
        if not has_feature(request.user, FEATURE_CONTENT_FULL):
            queryset = queryset.filter(is_premium=False)
        return Response(GuidedContentSerializer(queryset, many=True).data)


class GuidedContentDetailView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request, pk):
        content = get_object_or_404(GuidedContent, pk=pk)
        if content.is_premium and not has_feature(request.user, FEATURE_CONTENT_FULL):
            return Response({"detail": "Plano atual nao permite este conteudo."}, status=status.HTTP_403_FORBIDDEN)
        return Response(GuidedContentSerializer(content).data)

### apps/mood/__init__.py
--------------------------------------------------------------------------------


### apps/mood/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from mood.models import MoodEntry


@admin.register(MoodEntry)
class MoodEntryAdmin(admin.ModelAdmin):
    list_display = ("user", "mood", "created_at")
    list_filter = ("mood",)
    search_fields = ("user__email",)

### apps/mood/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class MoodConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'mood'

### apps/mood/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='MoodEntry',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('mood', models.CharField(choices=[('VERY_BAD', 'Very bad'), ('BAD', 'Bad'), ('OK', 'Ok'), ('GOOD', 'Good'), ('VERY_GOOD', 'Very good')], max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('tags', models.JSONField(default=list)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mood_entries', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/mood/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/mood/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models

from utils.constants import MOOD_CHOICES


class MoodEntry(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="mood_entries")
    mood = models.CharField(max_length=20, choices=MOOD_CHOICES)
    notes = models.TextField(blank=True)
    tags = models.JSONField(default=list)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.user.email} - {self.mood}"

### apps/mood/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from mood.models import MoodEntry


class MoodEntrySerializer(serializers.ModelSerializer):
    class Meta:
        model = MoodEntry
        fields = ("id", "mood", "notes", "tags", "created_at")
        read_only_fields = ("id", "created_at")

### apps/mood/tests.py
--------------------------------------------------------------------------------
from django.contrib.auth import get_user_model
from rest_framework.test import APITestCase
from rest_framework_simplejwt.tokens import RefreshToken

from billing.models import Plan, UserSubscription
from utils.constants import FEATURE_MOOD_BASIC, PLAN_LITE

User = get_user_model()


class MoodEntryTests(APITestCase):
    def setUp(self):
        self.user = User.objects.create_user(email="mood@example.com", name="Mood", password="pass12345")
        plan, _ = Plan.objects.get_or_create(
            code=PLAN_LITE, defaults={"name": "Lite", "features": [FEATURE_MOOD_BASIC], "is_active": True}
        )
        UserSubscription.objects.create(user=self.user, plan=plan)
        refresh = RefreshToken.for_user(self.user)
        self.client.credentials(HTTP_AUTHORIZATION=f"Bearer {refresh.access_token}")

    def test_create_mood_entry(self):
        response = self.client.post("/api/mood/entries/", {"mood": "OK", "notes": "Tudo bem"}, format="json")
        self.assertEqual(response.status_code, 201)

### apps/mood/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from mood.views import MoodEntryListCreateView, MoodWeeklySummaryView

urlpatterns = [
    path("entries/", MoodEntryListCreateView.as_view(), name="mood-entries"),
    path("summary/weekly/", MoodWeeklySummaryView.as_view(), name="mood-summary-weekly"),
]

### apps/mood/views.py
--------------------------------------------------------------------------------
from datetime import timedelta

from django.utils import timezone
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView
from rest_framework.generics import ListCreateAPIView

from mood.models import MoodEntry
from mood.serializers import MoodEntrySerializer
from utils.constants import FEATURE_MOOD_BASIC, MOOD_VERY_BAD
from utils.features import require_feature


class MoodEntryListCreateView(ListCreateAPIView):
    serializer_class = MoodEntrySerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        require_feature(self.request.user, FEATURE_MOOD_BASIC)
        return MoodEntry.objects.filter(user=self.request.user).order_by("-created_at")

    def perform_create(self, serializer):
        require_feature(self.request.user, FEATURE_MOOD_BASIC)
        serializer.save(user=self.request.user)

    def create(self, request, *args, **kwargs):
        response = super().create(request, *args, **kwargs)
        week_ago = timezone.now() - timedelta(days=7)
        very_bad_count = MoodEntry.objects.filter(
            user=request.user, mood=MOOD_VERY_BAD, created_at__gte=week_ago
        ).count()
        if very_bad_count >= 3:
            response.data["wellness_notice"] = (
                "Percebemos humor muito baixo recorrente. Procure apoio profissional."
                " No Brasil, o CVV atende 188 (24h)."
            )
        return response


class MoodWeeklySummaryView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_MOOD_BASIC)
        week_ago = timezone.now() - timedelta(days=7)
        entries = MoodEntry.objects.filter(user=request.user, created_at__gte=week_ago)
        summary = {}
        for mood, _label in MoodEntry._meta.get_field("mood").choices:
            summary[mood] = entries.filter(mood=mood).count()
        return Response({"summary": summary})

### apps/notifications/__init__.py
--------------------------------------------------------------------------------


### apps/notifications/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from notifications.models import IncomingMessage, NotificationQueue


@admin.register(NotificationQueue)
class NotificationQueueAdmin(admin.ModelAdmin):
    list_display = ("user", "channel", "status", "action_taken", "scheduled_for", "sent_at", "attempts")
    list_filter = ("channel", "status", "action_taken")


@admin.register(IncomingMessage)
class IncomingMessageAdmin(admin.ModelAdmin):
    list_display = ("phone_from", "parsed_action", "received_at", "matched_notification")
    list_filter = ("parsed_action",)

### apps/notifications/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class NotificationsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'notifications'

### apps/notifications/management/__init__.py
--------------------------------------------------------------------------------


### apps/notifications/management/commands/__init__.py
--------------------------------------------------------------------------------


### apps/notifications/management/commands/process_notification_queue.py
--------------------------------------------------------------------------------
from django.core.management.base import BaseCommand
from django.core.mail import send_mail
from django.utils import timezone

from accounts.models import UserProfile
from notifications.models import NotificationQueue
from notifications.services.whatsapp_cloud import normalize_phone, send_whatsapp_text
from utils.constants import (
    CHANNEL_EMAIL,
    CHANNEL_IN_APP,
    CHANNEL_SMS,
    CHANNEL_WHATSAPP,
    NOTIF_FAILED,
    NOTIF_PENDING,
    NOTIF_SENT,
)


class Command(BaseCommand):
    help = "Processa a fila de notificacoes pendentes."

    def handle(self, *args, **options):
        now = timezone.now()
        pending = NotificationQueue.objects.filter(status=NOTIF_PENDING, scheduled_for__lte=now)
        for notification in pending:
            try:
                # Bloco: Contagem de tentativas
                notification.attempts += 1

                if notification.channel == CHANNEL_EMAIL:
                    # Bloco: Envio de email
                    send_mail(notification.title, notification.message, None, [notification.user.email])
                elif notification.channel == CHANNEL_WHATSAPP:
                    # Bloco: Envio de WhatsApp
                    phone = notification.to_phone
                    if not phone:
                        try:
                            phone = notification.user.profile.phone
                        except UserProfile.DoesNotExist:
                            phone = notification.user.phone_number
                    phone = normalize_phone(phone)
                    if not phone:
                        raise RuntimeError("Telefone WhatsApp nao informado.")

                    body = f"{notification.message} [#N{notification.id}]\\nResponda 1 confirmar, 2 adiar 10min, 3 cancelar"
                    response = send_whatsapp_text(phone, body)
                    provider_id = ""
                    if isinstance(response, dict):
                        provider_id = response.get("messages", [{}])[0].get("id", "")
                    notification.provider = "META"
                    notification.provider_message_id = provider_id or ""
                    notification.to_phone = phone
                elif notification.channel == CHANNEL_SMS:
                    # Bloco: SMS mock (fallback)
                    notification.provider = "MOCK"
                elif notification.channel == CHANNEL_IN_APP:
                    # Bloco: In-app (sem envio externo)
                    notification.provider = "IN_APP"

                notification.status = NOTIF_SENT
                notification.sent_at = timezone.now()
                notification.last_error = ""
                notification.save()
                self.stdout.write(self.style.SUCCESS(f"Enviado: {notification.id}"))
            except Exception as exc:
                notification.status = NOTIF_FAILED
                notification.last_error = str(exc)
                notification.save()
                self.stdout.write(self.style.ERROR(f"Falhou: {notification.id}"))

### apps/notifications/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='NotificationQueue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel', models.CharField(choices=[('EMAIL', 'Email'), ('WHATSAPP', 'WhatsApp'), ('SMS', 'SMS')], max_length=20)),
                ('title', models.CharField(max_length=200)),
                ('message', models.TextField()),
                ('scheduled_for', models.DateTimeField()),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('SENT', 'Sent'), ('FAILED', 'Failed')], default='PENDING', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notifications', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/notifications/migrations/0002_notificationqueue_action_taken_and_more.py
--------------------------------------------------------------------------------
# Generated by Django 6.0.1 on 2026-02-02 14:09

import django.db.models.deletion
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('notifications', '0001_initial'),
    ]

    operations = [
        migrations.AddField(
            model_name='notificationqueue',
            name='action_taken',
            field=models.CharField(choices=[('NONE', 'None'), ('CONFIRMED', 'Confirmed'), ('DELAYED', 'Delayed'), ('CANCELED', 'Canceled')], default='NONE', max_length=20),
        ),
        migrations.AddField(
            model_name='notificationqueue',
            name='attempts',
            field=models.PositiveIntegerField(default=0),
        ),
        migrations.AddField(
            model_name='notificationqueue',
            name='last_error',
            field=models.TextField(blank=True),
        ),
        migrations.AddField(
            model_name='notificationqueue',
            name='provider',
            field=models.CharField(blank=True, max_length=50),
        ),
        migrations.AddField(
            model_name='notificationqueue',
            name='provider_message_id',
            field=models.CharField(blank=True, max_length=200),
        ),
        migrations.AddField(
            model_name='notificationqueue',
            name='sent_at',
            field=models.DateTimeField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='notificationqueue',
            name='to_phone',
            field=models.CharField(blank=True, max_length=30),
        ),
        migrations.AlterField(
            model_name='notificationqueue',
            name='channel',
            field=models.CharField(choices=[('IN_APP', 'In app'), ('EMAIL', 'Email'), ('WHATSAPP', 'WhatsApp'), ('SMS', 'SMS')], max_length=20),
        ),
        migrations.CreateModel(
            name='IncomingMessage',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('phone_from', models.CharField(max_length=30)),
                ('text', models.TextField()),
                ('received_at', models.DateTimeField(auto_now_add=True)),
                ('raw_payload', models.JSONField()),
                ('parsed_action', models.CharField(choices=[('NONE', 'None'), ('CONFIRMED', 'Confirmed'), ('DELAYED', 'Delayed'), ('CANCELED', 'Canceled')], default='NONE', max_length=20)),
                ('matched_notification', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='incoming_messages', to='notifications.notificationqueue')),
            ],
        ),
    ]

### apps/notifications/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/notifications/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models

from utils.constants import (
    CHANNEL_CHOICES,
    NOTIFICATION_ACTION_CHOICES,
    NOTIFICATION_STATUS_CHOICES,
    ACTION_NONE,
    NOTIF_PENDING,
)


# Bloco: Fila de notificacoes
class NotificationQueue(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="notifications")
    channel = models.CharField(max_length=20, choices=CHANNEL_CHOICES)
    title = models.CharField(max_length=200)
    message = models.TextField()
    scheduled_for = models.DateTimeField()
    status = models.CharField(max_length=20, choices=NOTIFICATION_STATUS_CHOICES, default=NOTIF_PENDING)
    action_taken = models.CharField(max_length=20, choices=NOTIFICATION_ACTION_CHOICES, default=ACTION_NONE)
    provider = models.CharField(max_length=50, blank=True)
    provider_message_id = models.CharField(max_length=200, blank=True)
    last_error = models.TextField(blank=True)
    attempts = models.PositiveIntegerField(default=0)
    to_phone = models.CharField(max_length=30, blank=True)
    sent_at = models.DateTimeField(null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.user.email} - {self.channel}"


# Bloco: Mensagens recebidas do WhatsApp
class IncomingMessage(models.Model):
    phone_from = models.CharField(max_length=30)
    text = models.TextField()
    received_at = models.DateTimeField(auto_now_add=True)
    raw_payload = models.JSONField()
    parsed_action = models.CharField(max_length=20, choices=NOTIFICATION_ACTION_CHOICES, default=ACTION_NONE)
    matched_notification = models.ForeignKey(
        NotificationQueue, on_delete=models.SET_NULL, null=True, blank=True, related_name="incoming_messages"
    )

    def __str__(self):
        return f"{self.phone_from} - {self.received_at:%Y-%m-%d %H:%M}"

### apps/notifications/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from notifications.models import NotificationQueue


class NotificationQueueSerializer(serializers.ModelSerializer):
    class Meta:
        model = NotificationQueue
        fields = (
            "id",
            "channel",
            "title",
            "message",
            "scheduled_for",
            "status",
            "created_at",
        )
        read_only_fields = ("id", "created_at")

### apps/notifications/services/reminder_queue.py
--------------------------------------------------------------------------------
from datetime import datetime, time, timedelta

from django.utils import timezone

from accounts.models import UserProfile
from agenda.models import CalendarEvent, ReminderRule
from notifications.models import NotificationQueue
from planner.models import Task
from utils.constants import (
    CHANNEL_EMAIL,
    CHANNEL_SMS,
    CHANNEL_WHATSAPP,
    NOTIF_PENDING,
    REMINDER_TARGET_EVENT,
    REMINDER_TARGET_TASK,
)


# Bloco: Preferencias do usuario
def _get_user_preferences(user):
    try:
        profile = user.profile
    except UserProfile.DoesNotExist:
        profile = None

    return {
        "allow_email": getattr(profile, "allow_email", True),
        "allow_whatsapp": getattr(profile, "allow_whatsapp", True),
        "allow_sms": getattr(profile, "allow_sms", False),
        "phone": getattr(profile, "phone", "") or getattr(user, "phone_number", ""),
    }


# Bloco: Filtro de canais permitidos
def _filter_channels(channels, prefs):
    allowed = []
    for channel in channels:
        if channel == CHANNEL_EMAIL and prefs["allow_email"]:
            allowed.append(channel)
        if channel == CHANNEL_WHATSAPP and prefs["allow_whatsapp"]:
            allowed.append(channel)
        if channel == CHANNEL_SMS and prefs["allow_sms"]:
            allowed.append(channel)
    return allowed


# Bloco: Criacao de notificacao
def _queue_notification(user, channel, title, message, scheduled_for, phone=""):
    exists = NotificationQueue.objects.filter(
        user=user,
        channel=channel,
        title=title,
        scheduled_for=scheduled_for,
    ).exists()
    if exists:
        return False

    NotificationQueue.objects.create(
        user=user,
        channel=channel,
        title=title,
        message=message,
        scheduled_for=scheduled_for,
        status=NOTIF_PENDING,
        to_phone=phone or "",
    )
    return True


# Bloco: Lembretes para evento
def create_notifications_for_event(user, event: CalendarEvent) -> int:
    now = timezone.now()
    created = 0
    prefs = _get_user_preferences(user)
    rules = ReminderRule.objects.filter(user=user, is_active=True, target_type=REMINDER_TARGET_EVENT)
    for rule in rules:
        channels = rule.channels or [CHANNEL_EMAIL]
        allowed_channels = _filter_channels(channels, prefs)
        scheduled_for = event.start_at - timedelta(minutes=rule.remind_before_minutes)
        if scheduled_for < now:
            scheduled_for = now
        for channel in allowed_channels:
            title = f"Lembrete: {event.title}"
            message = f"Evento {event.title} em {event.start_at}."
            phone = prefs["phone"] if channel in {CHANNEL_WHATSAPP, CHANNEL_SMS} else ""
            if _queue_notification(user, channel, title, message, scheduled_for, phone):
                created += 1
    return created


# Bloco: Lembretes para tarefa
def create_notifications_for_task(user, task: Task) -> int:
    now = timezone.now()
    created = 0
    prefs = _get_user_preferences(user)
    rules = ReminderRule.objects.filter(user=user, is_active=True, target_type=REMINDER_TARGET_TASK)
    for rule in rules:
        channels = rule.channels or [CHANNEL_EMAIL]
        allowed_channels = _filter_channels(channels, prefs)
        due_datetime = datetime.combine(task.due_date, time(9, 0), tzinfo=timezone.get_current_timezone())
        scheduled_for = due_datetime - timedelta(minutes=rule.remind_before_minutes)
        if scheduled_for < now:
            scheduled_for = now
        for channel in allowed_channels:
            title = f"Lembrete: {task.title}"
            message = f"Tarefa {task.title} vence em {task.due_date}."
            phone = prefs["phone"] if channel in {CHANNEL_WHATSAPP, CHANNEL_SMS} else ""
            if _queue_notification(user, channel, title, message, scheduled_for, phone):
                created += 1
    return created


# Bloco: Lembretes para usuario (geracao completa)
def create_notifications_for_user(user) -> int:
    created = 0
    now = timezone.now()
    events = CalendarEvent.objects.filter(user=user, start_at__gte=now)
    for event in events:
        created += create_notifications_for_event(user, event)

    tasks = Task.objects.filter(user=user, due_date__gte=timezone.localdate())
    for task in tasks:
        created += create_notifications_for_task(user, task)

    return created

### apps/notifications/services/whatsapp_cloud.py
--------------------------------------------------------------------------------
import json
import re
import urllib.request
from typing import Dict

from django.conf import settings


# Bloco: Normalizacao de telefone
def normalize_phone(raw_phone: str) -> str:
    if not raw_phone:
        return ""
    digits = re.sub(r"\D", "", raw_phone)
    if digits.startswith("55"):
        return digits
    return f"55{digits}"


# Bloco: Envio de mensagem via WhatsApp Cloud API
def send_whatsapp_text(to_phone: str, body: str) -> Dict:
    token = getattr(settings, "WHATSAPP_CLOUD_TOKEN", "")
    phone_number_id = getattr(settings, "WHATSAPP_PHONE_NUMBER_ID", "")
    if not token or not phone_number_id:
        raise RuntimeError("Credenciais do WhatsApp Cloud nao configuradas.")

    normalized = normalize_phone(to_phone)
    if not normalized:
        raise RuntimeError("Telefone invalido para envio de WhatsApp.")

    url = f"https://graph.facebook.com/v19.0/{phone_number_id}/messages"
    payload = {
        "messaging_product": "whatsapp",
        "to": normalized,
        "type": "text",
        "text": {"body": body},
    }
    data = json.dumps(payload).encode("utf-8")
    request = urllib.request.Request(
        url,
        data=data,
        headers={
            "Authorization": f"Bearer {token}",
            "Content-Type": "application/json",
        },
        method="POST",
    )
    try:
        with urllib.request.urlopen(request, timeout=10) as response:
            raw = response.read().decode("utf-8")
            return json.loads(raw)
    except Exception as exc:  # pragma: no cover
        raise RuntimeError(f"Erro ao enviar WhatsApp: {exc}") from exc

### apps/notifications/tests.py
--------------------------------------------------------------------------------


### apps/notifications/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from . import views

urlpatterns = [
    path("test-email/", views.TestEmailView.as_view(), name="notifications-test-email"),
    path("pending/", views.PendingNotificationsView.as_view(), name="notifications-pending"),
    path("whatsapp/webhook/", views.whatsapp_webhook_view, name="notifications-whatsapp-webhook"),
]

### apps/notifications/views.py
--------------------------------------------------------------------------------
import json
import re
from datetime import timedelta

from django.conf import settings
from django.core.mail import send_mail
from django.http import HttpResponse, HttpResponseForbidden, JsonResponse
from django.utils import timezone
from django.views.decorators.csrf import csrf_exempt
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from notifications.models import IncomingMessage, NotificationQueue
from notifications.serializers import NotificationQueueSerializer
from notifications.services.whatsapp_cloud import send_whatsapp_text
from utils.constants import (
    ACTION_CANCELED,
    ACTION_CONFIRMED,
    ACTION_DELAYED,
    ACTION_NONE,
    CHANNEL_EMAIL,
    CHANNEL_WHATSAPP,
    NOTIF_PENDING,
    NOTIF_SENT,
)
from utils.features import has_feature
from utils.constants import FEATURE_EMAIL_NOTIFICATIONS


class TestEmailView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request):
        if not has_feature(request.user, FEATURE_EMAIL_NOTIFICATIONS):
            return Response({"detail": "Plano atual nao permite email."}, status=status.HTTP_403_FORBIDDEN)
        subject = "Campus Calm - Teste de Email"
        message = "Este e um email de teste do Campus Calm."
        send_mail(subject, message, None, [request.user.email])
        return Response({"detail": "Email enviado para console."})


class PendingNotificationsView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        now = timezone.now()
        pending = NotificationQueue.objects.filter(
            user=request.user, status=NOTIF_PENDING, scheduled_for__lte=now
        ).order_by("scheduled_for")
        return Response(NotificationQueueSerializer(pending, many=True).data)


# Bloco: Webhook WhatsApp Cloud
@csrf_exempt
def whatsapp_webhook_view(request):
    if request.method == "GET":
        verify_token = request.GET.get("hub.verify_token", "")
        challenge = request.GET.get("hub.challenge", "")
        if verify_token and verify_token == getattr(settings, "WHATSAPP_VERIFY_TOKEN", ""):
            return HttpResponse(challenge, status=200)
        return HttpResponseForbidden("Token invalido.")

    if request.method != "POST":
        return JsonResponse({"detail": "Metodo nao permitido."}, status=405)

    try:
        payload = json.loads(request.body.decode("utf-8") or "{}")
    except json.JSONDecodeError:
        payload = {}

    phone_from, text_body = _extract_whatsapp_message(payload)
    parsed_action = _parse_action(text_body)
    matched_notification = _match_notification(phone_from, text_body)

    incoming = IncomingMessage.objects.create(
        phone_from=phone_from or "",
        text=text_body or "",
        raw_payload=payload,
        parsed_action=parsed_action,
        matched_notification=matched_notification,
    )

    if matched_notification and parsed_action != ACTION_NONE:
        _apply_action(matched_notification, parsed_action)

    return JsonResponse({"detail": "ok", "incoming_id": incoming.id})


# Bloco: Extracao de mensagem do payload
def _extract_whatsapp_message(payload):
    try:
        entry = payload.get("entry", [])[0]
        change = entry.get("changes", [])[0]
        value = change.get("value", {})
        message = value.get("messages", [])[0]
        phone_from = message.get("from", "")
        text_body = message.get("text", {}).get("body", "")
        return phone_from, text_body
    except (IndexError, AttributeError):
        return "", ""


# Bloco: Interpretacao da acao
def _parse_action(text_body: str):
    if not text_body:
        return ACTION_NONE
    text = text_body.strip()
    if text.startswith("1"):
        return ACTION_CONFIRMED
    if text.startswith("2"):
        return ACTION_DELAYED
    if text.startswith("3"):
        return ACTION_CANCELED
    return ACTION_NONE


# Bloco: Matching da notificacao
def _match_notification(phone_from: str, text_body: str):
    if not phone_from and not text_body:
        return None

    match = re.search(r"N(\\d+)", text_body.upper())
    if match:
        notification_id = int(match.group(1))
        notification = NotificationQueue.objects.filter(id=notification_id).first()
        if notification and (not notification.to_phone or notification.to_phone == phone_from):
            return notification
        return None

    if phone_from:
        since = timezone.now() - timedelta(hours=24)
        return (
            NotificationQueue.objects.filter(
                channel=CHANNEL_WHATSAPP,
                to_phone=phone_from,
                status=NOTIF_SENT,
                action_taken=ACTION_NONE,
                created_at__gte=since,
            )
            .order_by("-created_at")
            .first()
        )

    return None


# Bloco: Aplicacao da acao e resposta
def _apply_action(notification: NotificationQueue, action: str):
    notification.action_taken = action
    notification.save(update_fields=["action_taken"])

    if action == ACTION_CONFIRMED:
        _reply_whatsapp(notification.to_phone, "Confirmado ")
        return

    if action == ACTION_DELAYED:
        delayed_for = timezone.now() + timedelta(minutes=10)
        NotificationQueue.objects.create(
            user=notification.user,
            channel=notification.channel,
            title=notification.title,
            message=notification.message,
            scheduled_for=delayed_for,
            status=NOTIF_PENDING,
            to_phone=notification.to_phone,
        )
        _reply_whatsapp(notification.to_phone, "Adiado por 10 minutos ")
        return

    if action == ACTION_CANCELED:
        _reply_whatsapp(notification.to_phone, "Cancelado ")


# Bloco: Envio de resposta via WhatsApp
def _reply_whatsapp(phone: str, body: str):
    if not phone:
        return
    try:
        send_whatsapp_text(phone, body)
    except Exception:
        return

### apps/onboarding/__init__.py
--------------------------------------------------------------------------------


### apps/onboarding/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from onboarding.models import UserSetupProgress


@admin.register(UserSetupProgress)
class UserSetupProgressAdmin(admin.ModelAdmin):
    list_display = ("user", "has_profile", "has_active_semester", "has_at_least_one_course", "has_at_least_one_assessment", "has_reminder_rule")

### apps/onboarding/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class OnboardingConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'onboarding'

    def ready(self):
        from onboarding import signals  # noqa: F401

### apps/onboarding/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='UserSetupProgress',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('has_profile', models.BooleanField(default=False)),
                ('has_active_semester', models.BooleanField(default=False)),
                ('has_at_least_one_course', models.BooleanField(default=False)),
                ('has_at_least_one_assessment', models.BooleanField(default=False)),
                ('has_reminder_rule', models.BooleanField(default=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='setup_progress', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/onboarding/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/onboarding/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models


class UserSetupProgress(models.Model):
    user = models.OneToOneField(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="setup_progress")
    has_profile = models.BooleanField(default=False)
    has_active_semester = models.BooleanField(default=False)
    has_at_least_one_course = models.BooleanField(default=False)
    has_at_least_one_assessment = models.BooleanField(default=False)
    has_reminder_rule = models.BooleanField(default=False)
    updated_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        return self.user.email

### apps/onboarding/services.py
--------------------------------------------------------------------------------
from semester.models import Assessment, Course, Semester
from agenda.models import ReminderRule
from onboarding.models import UserSetupProgress
from utils.constants import SEMESTER_ACTIVE


def refresh_user_progress(user):
    progress, _ = UserSetupProgress.objects.get_or_create(user=user)
    progress.has_profile = bool(user.name)
    progress.has_active_semester = Semester.objects.filter(user=user, status=SEMESTER_ACTIVE).exists()
    progress.has_at_least_one_course = Course.objects.filter(semester__user=user).exists()
    progress.has_at_least_one_assessment = Assessment.objects.filter(course__semester__user=user).exists()
    progress.has_reminder_rule = ReminderRule.objects.filter(user=user, is_active=True).exists()
    progress.save()
    return progress

### apps/onboarding/signals.py
--------------------------------------------------------------------------------
from django.db.models.signals import post_delete, post_save
from django.dispatch import receiver

from accounts.models import User
from agenda.models import ReminderRule
from onboarding.services import refresh_user_progress
from semester.models import Assessment, Course, Semester


@receiver(post_save, sender=User)
def user_saved(sender, instance, **kwargs):
    refresh_user_progress(instance)


@receiver(post_save, sender=Semester)
@receiver(post_delete, sender=Semester)
def semester_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.user)


@receiver(post_save, sender=Course)
@receiver(post_delete, sender=Course)
def course_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.semester.user)


@receiver(post_save, sender=Assessment)
@receiver(post_delete, sender=Assessment)
def assessment_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.course.semester.user)


@receiver(post_save, sender=ReminderRule)
@receiver(post_delete, sender=ReminderRule)
def reminder_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.user)

### apps/onboarding/tests.py
--------------------------------------------------------------------------------


### apps/onboarding/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from onboarding.views import OnboardingStatusView

urlpatterns = [
    path("status/", OnboardingStatusView.as_view(), name="onboarding-status"),
]

### apps/onboarding/views.py
--------------------------------------------------------------------------------
from rest_framework import permissions
from rest_framework.response import Response
from rest_framework.views import APIView

from onboarding.services import refresh_user_progress
from utils.gating import compute_status


class OnboardingStatusView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        progress = refresh_user_progress(request.user)
        current_step, missing_steps, required_actions = compute_status(progress)
        return Response(
            {
                "current_step": current_step,
                "missing_steps": missing_steps,
                "required_actions": required_actions,
            }
        )

### apps/planner/__init__.py
--------------------------------------------------------------------------------


### apps/planner/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from planner.models import Task


@admin.register(Task)
class TaskAdmin(admin.ModelAdmin):
    list_display = ("title", "user", "due_date", "status")
    list_filter = ("status",)
    search_fields = ("title", "user__email")

### apps/planner/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class PlannerConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'planner'

### apps/planner/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Task',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('due_date', models.DateField()),
                ('stress_level', models.PositiveSmallIntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('status', models.CharField(choices=[('TODO', 'Todo'), ('DOING', 'Doing'), ('DONE', 'Done')], default='TODO', max_length=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/planner/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/planner/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.core.validators import MaxValueValidator, MinValueValidator
from django.db import models

from utils.constants import TASK_STATUS_CHOICES, TASK_TODO


class Task(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="tasks")
    title = models.CharField(max_length=200)
    description = models.TextField(blank=True)
    due_date = models.DateField()
    stress_level = models.PositiveSmallIntegerField(validators=[MinValueValidator(1), MaxValueValidator(5)])
    status = models.CharField(max_length=10, choices=TASK_STATUS_CHOICES, default=TASK_TODO)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title

### apps/planner/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from planner.models import Task


class TaskSerializer(serializers.ModelSerializer):
    class Meta:
        model = Task
        fields = (
            "id",
            "title",
            "description",
            "due_date",
            "stress_level",
            "status",
            "created_at",
        )
        read_only_fields = ("id", "created_at")

### apps/planner/tests.py
--------------------------------------------------------------------------------


### apps/planner/urls.py
--------------------------------------------------------------------------------
from rest_framework.routers import DefaultRouter

from planner.views import TaskViewSet

router = DefaultRouter()
router.register(r"tasks", TaskViewSet, basename="tasks")

urlpatterns = router.urls

### apps/planner/views.py
--------------------------------------------------------------------------------
from rest_framework import permissions, viewsets

from planner.models import Task
from planner.serializers import TaskSerializer
from utils.constants import FEATURE_PLANNER_BASIC
from utils.features import require_feature


class TaskViewSet(viewsets.ModelViewSet):
    serializer_class = TaskSerializer
    permission_classes = [permissions.IsAuthenticated]

    def initial(self, request, *args, **kwargs):
        require_feature(request.user, FEATURE_PLANNER_BASIC)
        return super().initial(request, *args, **kwargs)

    def get_queryset(self):
        return Task.objects.filter(user=self.request.user).order_by("-created_at")

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)

### apps/pomodoro/__init__.py
--------------------------------------------------------------------------------


### apps/pomodoro/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from pomodoro.models import PomodoroSession


@admin.register(PomodoroSession)
class PomodoroSessionAdmin(admin.ModelAdmin):
    list_display = ("user", "status", "started_at", "ended_at")
    list_filter = ("status",)

### apps/pomodoro/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class PomodoroConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'pomodoro'

### apps/pomodoro/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='PomodoroSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('focus_minutes', models.PositiveIntegerField(default=25)),
                ('break_minutes', models.PositiveIntegerField(default=5)),
                ('started_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('ended_at', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('COMPLETED', 'Completed'), ('STOPPED', 'Stopped')], default='STOPPED', max_length=20)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pomodoro_sessions', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

### apps/pomodoro/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/pomodoro/models.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.db import models
from django.utils import timezone

from utils.constants import POMODORO_STATUS_CHOICES, POMODORO_STOPPED


class PomodoroSession(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="pomodoro_sessions")
    focus_minutes = models.PositiveIntegerField(default=25)
    break_minutes = models.PositiveIntegerField(default=5)
    started_at = models.DateTimeField(default=timezone.now)
    ended_at = models.DateTimeField(null=True, blank=True)
    status = models.CharField(max_length=20, choices=POMODORO_STATUS_CHOICES, default=POMODORO_STOPPED)

    def __str__(self):
        return f"{self.user.email} - {self.status}"

### apps/pomodoro/serializers.py
--------------------------------------------------------------------------------
from rest_framework import serializers

from pomodoro.models import PomodoroSession


class PomodoroSessionSerializer(serializers.ModelSerializer):
    class Meta:
        model = PomodoroSession
        fields = (
            "id",
            "focus_minutes",
            "break_minutes",
            "started_at",
            "ended_at",
            "status",
        )
        read_only_fields = ("id", "started_at", "ended_at", "status")

### apps/pomodoro/tests.py
--------------------------------------------------------------------------------


### apps/pomodoro/urls.py
--------------------------------------------------------------------------------
from django.urls import path

from pomodoro.views import PomodoroStartView, PomodoroStopView, PomodoroWeeklySummaryView

urlpatterns = [
    path("start/", PomodoroStartView.as_view(), name="pomodoro-start"),
    path("stop/<int:pk>/", PomodoroStopView.as_view(), name="pomodoro-stop"),
    path("summary/weekly/", PomodoroWeeklySummaryView.as_view(), name="pomodoro-summary-weekly"),
]

### apps/pomodoro/views.py
--------------------------------------------------------------------------------
from datetime import timedelta

from django.utils import timezone
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from pomodoro.models import PomodoroSession
from pomodoro.serializers import PomodoroSessionSerializer
from utils.constants import FEATURE_POMODORO_BASIC, POMODORO_COMPLETED, POMODORO_STOPPED
from utils.features import require_feature


class PomodoroStartView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request):
        require_feature(request.user, FEATURE_POMODORO_BASIC)
        focus_minutes = int(request.data.get("focus_minutes", 25))
        break_minutes = int(request.data.get("break_minutes", 5))
        session = PomodoroSession.objects.create(
            user=request.user,
            focus_minutes=focus_minutes,
            break_minutes=break_minutes,
        )
        return Response(PomodoroSessionSerializer(session).data, status=status.HTTP_201_CREATED)


class PomodoroStopView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request, pk):
        require_feature(request.user, FEATURE_POMODORO_BASIC)
        session = PomodoroSession.objects.get(pk=pk, user=request.user)
        completed_value = request.data.get("completed", False)
        completed = str(completed_value).lower() in {"1", "true", "yes", "on"}
        session.ended_at = timezone.now()
        session.status = POMODORO_COMPLETED if completed else POMODORO_STOPPED
        session.save()
        return Response(PomodoroSessionSerializer(session).data)


class PomodoroWeeklySummaryView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_POMODORO_BASIC)
        week_ago = timezone.now() - timedelta(days=7)
        sessions = PomodoroSession.objects.filter(user=request.user, started_at__gte=week_ago)
        total_sessions = sessions.count()
        total_focus_minutes = sum(session.focus_minutes for session in sessions)
        return Response(
            {
                "total_sessions": total_sessions,
                "total_focus_minutes": total_focus_minutes,
            }
        )

### apps/semester/__init__.py
--------------------------------------------------------------------------------


### apps/semester/admin.py
--------------------------------------------------------------------------------
from django.contrib import admin

from semester.models import Assessment, Course, Semester, SemesterCheckin


@admin.register(Semester)
class SemesterAdmin(admin.ModelAdmin):
    list_display = ("name", "user", "status", "start_date", "end_date")
    list_filter = ("status",)


@admin.register(Course)
class CourseAdmin(admin.ModelAdmin):
    list_display = ("title", "semester", "status", "passing_grade", "final_grade")
    list_filter = ("status",)


@admin.register(Assessment)
class AssessmentAdmin(admin.ModelAdmin):
    list_display = ("title", "course", "score", "max_score", "weight")


@admin.register(SemesterCheckin)
class SemesterCheckinAdmin(admin.ModelAdmin):
    list_display = ("semester", "overall_stress", "created_at")

### apps/semester/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class SemesterConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'semester'

### apps/semester/migrations/0001_initial.py
--------------------------------------------------------------------------------
# Generated by Django 4.2.11 on 2026-01-28 13:35

from decimal import Decimal
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Semester',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('status', models.CharField(choices=[('ACTIVE', 'Active'), ('FINISHED', 'Finished')], default='ACTIVE', max_length=20)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='semesters', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='SemesterCheckin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('overall_stress', models.PositiveSmallIntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('comment', models.TextField(blank=True)),
                ('semester', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='checkins', to='semester.semester')),
            ],
        ),
        migrations.CreateModel(
            name='Course',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('teacher', models.CharField(blank=True, max_length=200)),
                ('credits', models.PositiveIntegerField(blank=True, null=True)),
                ('passing_grade', models.DecimalField(decimal_places=2, default=Decimal('7.0'), max_digits=4)),
                ('status', models.CharField(choices=[('IN_PROGRESS', 'In progress'), ('PASSED', 'Passed'), ('FAILED', 'Failed')], default='IN_PROGRESS', max_length=20)),
                ('final_grade', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('notes', models.TextField(blank=True)),
                ('semester', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='courses', to='semester.semester')),
            ],
        ),
        migrations.CreateModel(
            name='Assessment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('score', models.DecimalField(decimal_places=2, max_digits=5, validators=[django.core.validators.MinValueValidator(0)])),
                ('max_score', models.DecimalField(decimal_places=2, default=Decimal('10.0'), max_digits=5)),
                ('weight', models.DecimalField(decimal_places=2, default=Decimal('1.0'), max_digits=5, validators=[django.core.validators.MinValueValidator(0)])),
                ('date', models.DateField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('course', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assessments', to='semester.course')),
            ],
        ),
    ]

### apps/semester/migrations/__init__.py
--------------------------------------------------------------------------------


### apps/semester/models.py
--------------------------------------------------------------------------------
from decimal import Decimal

from django.conf import settings
from django.core.validators import MaxValueValidator, MinValueValidator
from django.db import models

from utils.constants import COURSE_STATUS_CHOICES, COURSE_IN_PROGRESS, SEMESTER_STATUS_CHOICES, SEMESTER_ACTIVE


class Semester(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="semesters")
    name = models.CharField(max_length=50)
    start_date = models.DateField()
    end_date = models.DateField()
    status = models.CharField(max_length=20, choices=SEMESTER_STATUS_CHOICES, default=SEMESTER_ACTIVE)

    def __str__(self):
        return self.name


class Course(models.Model):
    semester = models.ForeignKey(Semester, on_delete=models.CASCADE, related_name="courses")
    title = models.CharField(max_length=200)
    teacher = models.CharField(max_length=200, blank=True)
    credits = models.PositiveIntegerField(null=True, blank=True)
    passing_grade = models.DecimalField(max_digits=4, decimal_places=2, default=Decimal("7.0"))
    status = models.CharField(max_length=20, choices=COURSE_STATUS_CHOICES, default=COURSE_IN_PROGRESS)
    final_grade = models.DecimalField(max_digits=5, decimal_places=2, null=True, blank=True)
    notes = models.TextField(blank=True)

    def __str__(self):
        return self.title


class Assessment(models.Model):
    course = models.ForeignKey(Course, on_delete=models.CASCADE, related_name="assessments")
    title = models.CharField(max_length=200)
    score = models.DecimalField(max_digits=5, decimal_places=2, validators=[MinValueValidator(0)])
    max_score = models.DecimalField(max_digits=5, decimal_places=2, default=Decimal("10.0"))
    weight = models.DecimalField(max_digits=5, decimal_places=2, default=Decimal("1.0"), validators=[MinValueValidator(0)])
    date = models.DateField(null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title


class SemesterCheckin(models.Model):
    semester = models.ForeignKey(Semester, on_delete=models.CASCADE, related_name="checkins")
    created_at = models.DateTimeField(auto_now_add=True)
    overall_stress = models.PositiveSmallIntegerField(validators=[MinValueValidator(1), MaxValueValidator(5)])
    comment = models.TextField(blank=True)

    def __str__(self):
        return f"{self.semester.name} checkin"

### apps/semester/serializers.py
--------------------------------------------------------------------------------
from decimal import Decimal

from rest_framework import serializers

from semester.models import Assessment, Course, Semester, SemesterCheckin
from utils.academic_progress import (
    calculate_course_average,
    calculate_needed_to_pass,
    calculate_progress_percent,
)


class SemesterSerializer(serializers.ModelSerializer):
    class Meta:
        model = Semester
        fields = ("id", "name", "start_date", "end_date", "status")
        read_only_fields = ("id",)


class CourseSerializer(serializers.ModelSerializer):
    current_average = serializers.SerializerMethodField()
    progress_percent = serializers.SerializerMethodField()
    needed_to_pass = serializers.SerializerMethodField()

    class Meta:
        model = Course
        fields = (
            "id",
            "semester",
            "title",
            "teacher",
            "credits",
            "passing_grade",
            "status",
            "final_grade",
            "notes",
            "current_average",
            "progress_percent",
            "needed_to_pass",
        )
        read_only_fields = ("id", "status", "final_grade", "current_average", "progress_percent", "needed_to_pass")

    def get_current_average(self, obj):
        return calculate_course_average(obj)

    def get_progress_percent(self, obj):
        return calculate_progress_percent(obj)

    def get_needed_to_pass(self, obj):
        return calculate_needed_to_pass(obj)


class AssessmentSerializer(serializers.ModelSerializer):
    class Meta:
        model = Assessment
        fields = ("id", "course", "title", "score", "max_score", "weight", "date", "created_at")
        read_only_fields = ("id", "created_at")

    def validate(self, attrs):
        score = attrs.get("score")
        max_score = attrs.get("max_score")
        weight = attrs.get("weight")
        if score is not None and max_score is not None and score > max_score:
            raise serializers.ValidationError("score deve ser <= max_score")
        if weight is not None and weight < 0:
            raise serializers.ValidationError("weight deve ser >= 0")
        return attrs


class SemesterCheckinSerializer(serializers.ModelSerializer):
    class Meta:
        model = SemesterCheckin
        fields = ("id", "semester", "created_at", "overall_stress", "comment")
        read_only_fields = ("id", "created_at")

### apps/semester/tests.py
--------------------------------------------------------------------------------
from datetime import date
from decimal import Decimal

from django.contrib.auth import get_user_model
from rest_framework.test import APITestCase
from rest_framework_simplejwt.tokens import RefreshToken

from coach_ai.models import CoachLog
from semester.models import Assessment, Course, Semester
from utils.constants import COACH_REPROVACAO, COACH_SEMESTRE_CONCLUIDO, COURSE_FAILED, COURSE_PASSED

User = get_user_model()


class SemesterProgressTests(APITestCase):
    def setUp(self):
        self.user = User.objects.create_user(email="semester@example.com", name="Semestre", password="pass12345")
        refresh = RefreshToken.for_user(self.user)
        self.client.credentials(HTTP_AUTHORIZATION=f"Bearer {refresh.access_token}")
        self.semester = Semester.objects.create(
            user=self.user,
            name="2026.1",
            start_date=date.today(),
            end_date=date.today(),
        )
        self.course = Course.objects.create(semester=self.semester, title="Matematica")

    def test_course_progress_requires_assessment(self):
        response = self.client.get(f"/api/semester/courses/{self.course.id}/progress/")
        self.assertEqual(response.status_code, 403)
        self.assertIn("detail", response.data)

    def test_finish_semester_passed(self):
        Assessment.objects.create(course=self.course, title="Prova 1", score=Decimal("9"), max_score=Decimal("10"))
        response = self.client.post(f"/api/semester/finish/{self.semester.id}/")
        self.assertEqual(response.status_code, 200)
        self.course.refresh_from_db()
        self.assertEqual(self.course.status, COURSE_PASSED)
        self.assertTrue(CoachLog.objects.filter(user=self.user, trigger_type=COACH_SEMESTRE_CONCLUIDO).exists())

    def test_finish_semester_failed(self):
        failing_course = Course.objects.create(semester=self.semester, title="Fisica", passing_grade=Decimal("7"))
        Assessment.objects.create(course=failing_course, title="Prova 1", score=Decimal("3"), max_score=Decimal("10"))
        response = self.client.post(f"/api/semester/finish/{self.semester.id}/")
        self.assertEqual(response.status_code, 200)
        failing_course.refresh_from_db()
        self.assertEqual(failing_course.status, COURSE_FAILED)
        self.assertTrue(CoachLog.objects.filter(user=self.user, trigger_type=COACH_REPROVACAO).exists())

### apps/semester/urls.py
--------------------------------------------------------------------------------
from django.urls import path
from rest_framework.routers import DefaultRouter

from semester.views import AssessmentViewSet, CourseProgressView, CourseViewSet, FinishSemesterView, SemesterViewSet

router = DefaultRouter()
router.register(r"semesters", SemesterViewSet, basename="semesters")
router.register(r"courses", CourseViewSet, basename="courses")
router.register(r"assessments", AssessmentViewSet, basename="assessments")

urlpatterns = router.urls + [
    path("courses/<int:pk>/progress/", CourseProgressView.as_view(), name="course-progress"),
    path("finish/<int:semester_id>/", FinishSemesterView.as_view(), name="semester-finish"),
]

### apps/semester/views.py
--------------------------------------------------------------------------------
from datetime import timedelta

from django.shortcuts import get_object_or_404
from django.utils import timezone
from rest_framework import permissions, status, viewsets
from rest_framework.exceptions import PermissionDenied
from rest_framework.response import Response
from rest_framework.views import APIView

from coach_ai.models import CoachLog
from semester.models import Assessment, Course, Semester
from semester.serializers import AssessmentSerializer, CourseSerializer, SemesterSerializer
from utils.academic_progress import (
    calculate_course_average,
    calculate_needed_to_pass,
    calculate_progress_percent,
    update_course_status,
)
from utils.constants import (
    CHANNEL_EMAIL,
    CHANNEL_IN_APP,
    COACH_REPROVACAO,
    COACH_SEMESTRE_CONCLUIDO,
    COURSE_FAILED,
    SEMESTER_FINISHED,
)
from utils.gating import gate_course_progress, gate_finish_semester
from utils.messages import (
    MESSAGE_ACHIEVEMENT,
    MESSAGE_CARE,
    MESSAGE_INCENTIVE,
    MESSAGE_WARNING,
    send_message,
)


class SemesterViewSet(viewsets.ModelViewSet):
    serializer_class = SemesterSerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        return Semester.objects.filter(user=self.request.user).order_by("-start_date")

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)


class CourseViewSet(viewsets.ModelViewSet):
    serializer_class = CourseSerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        return Course.objects.filter(semester__user=self.request.user).order_by("title")

    def perform_create(self, serializer):
        semester = serializer.validated_data["semester"]
        if semester.user != self.request.user:
            raise PermissionDenied("Semestre nao pertence ao usuario")
        serializer.save()


class AssessmentViewSet(viewsets.ModelViewSet):
    serializer_class = AssessmentSerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        return Assessment.objects.filter(course__semester__user=self.request.user).order_by("-created_at")

    def perform_create(self, serializer):
        course = serializer.validated_data["course"]
        if course.semester.user != self.request.user:
            raise PermissionDenied("Curso nao pertence ao usuario")
        previous_progress = calculate_progress_percent(course)
        serializer.save()
        course.refresh_from_db()
        new_progress = calculate_progress_percent(course)
        update_course_status(course, semester_status=course.semester.status)
        course.final_grade = calculate_course_average(course)
        course.save(update_fields=["status", "final_grade"])

        if new_progress > previous_progress:
            send_message(
                self.request.user,
                MESSAGE_INCENTIVE,
                {
                    "event": "assessment_progress_up",
                    "course": course.title,
                    "progress": int(new_progress),
                },
                channels=[CHANNEL_IN_APP, CHANNEL_EMAIL],
            )
        elif new_progress < previous_progress:
            send_message(
                self.request.user,
                MESSAGE_CARE,
                {
                    "event": "assessment_progress_down",
                    "course": course.title,
                    "progress": int(new_progress),
                },
                channels=[CHANNEL_IN_APP, CHANNEL_EMAIL],
            )

        if new_progress >= 100 and previous_progress < 100:
            send_message(
                self.request.user,
                MESSAGE_ACHIEVEMENT,
                {
                    "event": "course_passed",
                    "course": course.title,
                    "progress": int(new_progress),
                },
                channels=[CHANNEL_IN_APP, CHANNEL_EMAIL],
            )

        week_ahead = timezone.localdate() + timedelta(days=7)
        upcoming = course.assessments.filter(date__gte=timezone.localdate(), date__lte=week_ahead).exists()
        if new_progress < 70 and upcoming:
            send_message(
                self.request.user,
                MESSAGE_WARNING,
                {
                    "event": "low_progress_upcoming",
                    "course": course.title,
                    "progress": int(new_progress),
                },
                channels=[CHANNEL_IN_APP, CHANNEL_EMAIL],
            )


class CourseProgressView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request, pk):
        course = get_object_or_404(Course, pk=pk, semester__user=request.user)
        allowed, message = gate_course_progress(course)
        if not allowed:
            return Response({"detail": message}, status=status.HTTP_403_FORBIDDEN)
        current_average = calculate_course_average(course)
        progress_percent = calculate_progress_percent(course)
        needed_to_pass = calculate_needed_to_pass(course)
        return Response(
            {
                "course_id": course.id,
                "current_average": current_average,
                "progress_percent": progress_percent,
                "needed_to_pass": needed_to_pass,
            }
        )


class FinishSemesterView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request, semester_id):
        semester = get_object_or_404(Semester, pk=semester_id, user=request.user)
        allowed, message = gate_finish_semester(semester)
        if not allowed:
            return Response({"detail": message}, status=status.HTTP_403_FORBIDDEN)

        any_failed = False
        for course in semester.courses.all():
            current_average = calculate_course_average(course)
            course.final_grade = current_average
            update_course_status(course, semester_status=SEMESTER_FINISHED)
            if course.status == COURSE_FAILED:
                any_failed = True
            course.save(update_fields=["final_grade", "status"])

        semester.status = SEMESTER_FINISHED
        semester.save()

        if any_failed:
            CoachLog.objects.create(
                user=request.user,
                trigger_type=COACH_REPROVACAO,
                suggestion_text=(
                    "Identificamos disciplinas reprovadas. Vamos montar um plano de continuidade e recuperar o ritmo."
                ),
            )
            send_message(
                request.user,
                MESSAGE_CARE,
                {
                    "event": "semester_with_fail",
                    "course": "",
                },
                channels=[CHANNEL_IN_APP, CHANNEL_EMAIL],
            )
            send_message(
                request.user,
                MESSAGE_INCENTIVE,
                {
                    "event": "semester_continue",
                    "course": "",
                },
                channels=[CHANNEL_IN_APP, CHANNEL_EMAIL],
            )
        else:
            CoachLog.objects.create(
                user=request.user,
                trigger_type=COACH_SEMESTRE_CONCLUIDO,
                suggestion_text=(
                    "Parabens! Voce concluiu o semestre sem reprovacoes. Continue com esse ritmo."
                ),
            )
            send_message(
                request.user,
                MESSAGE_ACHIEVEMENT,
                {
                    "event": "semester_all_passed",
                    "course": "",
                },
                channels=["IN_APP", "EMAIL"],
            )

        return Response({"detail": "Semestre finalizado."})

### apps/ui/__init__.py
--------------------------------------------------------------------------------


### apps/ui/apps.py
--------------------------------------------------------------------------------
from django.apps import AppConfig


class UiConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "ui"

### apps/ui/forms.py
--------------------------------------------------------------------------------
from django import forms
from django.contrib.auth.forms import AuthenticationForm
from django.utils.translation import gettext_lazy as _


class EmailAuthenticationForm(AuthenticationForm):
    username = forms.EmailField(
        label=_("Email"),
        widget=forms.EmailInput(attrs={"class": "form-control", "placeholder": "seu.email@universidade.edu"}),
    )
    password = forms.CharField(
        label=_("Senha"),
        widget=forms.PasswordInput(attrs={"class": "form-control", "placeholder": "Sua senha"}),
    )


# Bloco: Formulario de primeiro acesso
class FirstAccessForm(forms.Form):
    PLAN_FREE = "FREE"
    PLAN_PAID = "PAGO"
    PLAN_CHOICES = [
        (PLAN_FREE, _("Free")),
        (PLAN_PAID, _("Pago")),
    ]

    name = forms.CharField(label=_("Nome"), max_length=255, widget=forms.TextInput(attrs={"class": "form-control"}))
    email = forms.EmailField(label=_("Email"), widget=forms.EmailInput(attrs={"class": "form-control"}))
    phone = forms.CharField(
        label=_("Telefone (WhatsApp)"),
        max_length=30,
        required=False,
        widget=forms.TextInput(attrs={"class": "form-control"}),
    )
    plan = forms.ChoiceField(
        label=_("Plano"),
        choices=PLAN_CHOICES,
        initial=PLAN_FREE,
        widget=forms.Select(attrs={"class": "form-select"}),
    )
    password1 = forms.CharField(
        label=_("Senha"),
        widget=forms.PasswordInput(attrs={"class": "form-control"}),
        min_length=6,
    )
    password2 = forms.CharField(
        label=_("Confirmar senha"),
        widget=forms.PasswordInput(attrs={"class": "form-control"}),
        min_length=6,
    )
    allow_email = forms.BooleanField(
        label=_("Receber email"),
        required=False,
        initial=True,
        widget=forms.CheckboxInput(attrs={"class": "form-check-input"}),
    )
    allow_whatsapp = forms.BooleanField(
        label=_("Receber WhatsApp"),
        required=False,
        initial=True,
        widget=forms.CheckboxInput(attrs={"class": "form-check-input"}),
    )
    allow_sms = forms.BooleanField(
        label=_("Receber SMS"),
        required=False,
        initial=False,
        widget=forms.CheckboxInput(attrs={"class": "form-check-input"}),
    )

    def clean(self):
        data = super().clean()
        if data.get("password1") != data.get("password2"):
            self.add_error("password2", _("As senhas nao conferem."))
        return data

### apps/ui/forms_academic.py
--------------------------------------------------------------------------------
from django import forms
from django.core.exceptions import ValidationError
from django.utils.translation import gettext_lazy as _

from semester.models import Assessment, Course, Semester


class SemesterForm(forms.ModelForm):
    class Meta:
        model = Semester
        fields = ["name", "start_date", "end_date", "status"]
        labels = {
            "name": _("Nome do semestre"),
            "start_date": _("Data de inicio"),
            "end_date": _("Data de termino"),
            "status": _("Status"),
        }
        widgets = {
            "name": forms.TextInput(attrs={"class": "form-control"}),
            "start_date": forms.DateInput(attrs={"class": "form-control", "type": "date"}),
            "end_date": forms.DateInput(attrs={"class": "form-control", "type": "date"}),
            "status": forms.Select(attrs={"class": "form-select"}),
        }


class CourseForm(forms.ModelForm):
    class Meta:
        model = Course
        fields = ["title", "teacher", "credits", "passing_grade", "status", "final_grade", "notes"]
        labels = {
            "title": _("Nome da disciplina"),
            "teacher": _("Professor"),
            "credits": _("Creditos"),
            "passing_grade": _("Nota minima"),
            "status": _("Status"),
            "final_grade": _("Nota final"),
            "notes": _("Anotacoes"),
        }
        widgets = {
            "title": forms.TextInput(attrs={"class": "form-control"}),
            "teacher": forms.TextInput(attrs={"class": "form-control"}),
            "credits": forms.NumberInput(attrs={"class": "form-control", "min": 0}),
            "passing_grade": forms.NumberInput(attrs={"class": "form-control", "step": "0.01", "min": 0}),
            "status": forms.Select(attrs={"class": "form-select"}),
            "final_grade": forms.NumberInput(attrs={"class": "form-control", "step": "0.01", "min": 0}),
            "notes": forms.Textarea(attrs={"class": "form-control", "rows": 4}),
        }

    def clean_passing_grade(self):
        passing_grade = self.cleaned_data.get("passing_grade")
        if passing_grade is not None and passing_grade <= 0:
            raise ValidationError(_("A nota minima deve ser maior que zero."))
        return passing_grade


class AssessmentForm(forms.ModelForm):
    class Meta:
        model = Assessment
        fields = ["title", "score", "max_score", "weight", "date"]
        labels = {
            "title": _("Titulo"),
            "score": _("Nota obtida"),
            "max_score": _("Nota maxima"),
            "weight": _("Peso"),
            "date": _("Data"),
        }
        widgets = {
            "title": forms.TextInput(attrs={"class": "form-control"}),
            "score": forms.NumberInput(attrs={"class": "form-control", "step": "0.01", "min": 0}),
            "max_score": forms.NumberInput(attrs={"class": "form-control", "step": "0.01", "min": 0}),
            "weight": forms.NumberInput(attrs={"class": "form-control", "step": "0.01", "min": 0}),
            "date": forms.DateInput(attrs={"class": "form-control", "type": "date"}),
        }

    def clean(self):
        cleaned_data = super().clean()
        score = cleaned_data.get("score")
        max_score = cleaned_data.get("max_score")
        weight = cleaned_data.get("weight")
        if score is not None and max_score is not None and score > max_score:
            raise ValidationError(_("A nota obtida nao pode ser maior que a nota maxima."))
        if weight is not None and weight < 0:
            raise ValidationError(_("O peso deve ser maior ou igual a zero."))
        return cleaned_data

### apps/ui/forms_agenda.py
--------------------------------------------------------------------------------
from django import forms
from django.utils.translation import gettext_lazy as _

from agenda.models import CalendarEvent
from planner.models import Task


class CalendarEventForm(forms.ModelForm):
    class Meta:
        model = CalendarEvent
        fields = ["title", "event_type", "start_at", "end_at", "related_task", "notes"]
        labels = {
            "title": _("Titulo"),
            "event_type": _("Tipo"),
            "start_at": _("Inicio"),
            "end_at": _("Fim"),
            "related_task": _("Tarefa relacionada"),
            "notes": _("Observacoes"),
        }
        widgets = {
            "title": forms.TextInput(attrs={"class": "form-control"}),
            "event_type": forms.Select(attrs={"class": "form-select"}),
            "start_at": forms.DateTimeInput(
                attrs={"class": "form-control", "type": "datetime-local"},
                format="%Y-%m-%dT%H:%M",
            ),
            "end_at": forms.DateTimeInput(
                attrs={"class": "form-control", "type": "datetime-local"},
                format="%Y-%m-%dT%H:%M",
            ),
            "related_task": forms.Select(attrs={"class": "form-select"}),
            "notes": forms.Textarea(attrs={"class": "form-control", "rows": 4}),
        }

    def __init__(self, *args, **kwargs):
        user = kwargs.pop("user", None)
        super().__init__(*args, **kwargs)
        self.fields["start_at"].input_formats = ["%Y-%m-%dT%H:%M"]
        self.fields["end_at"].input_formats = ["%Y-%m-%dT%H:%M"]
        if user is not None:
            self.fields["related_task"].queryset = Task.objects.filter(user=user).order_by("due_date")
        self.fields["related_task"].required = False
        self.fields["related_task"].empty_label = _("Estudos")

### apps/ui/forms_reminders.py
--------------------------------------------------------------------------------
from django import forms
from django.core.exceptions import ValidationError
from django.utils.translation import gettext_lazy as _

from agenda.models import ReminderRule
from utils.constants import CHANNEL_EMAIL, CHANNEL_SMS, CHANNEL_WHATSAPP

CHANNEL_OPTIONS = [
    (CHANNEL_EMAIL, "Email"),
    (CHANNEL_WHATSAPP, "WhatsApp"),
    (CHANNEL_SMS, "SMS"),
]


class ReminderRuleForm(forms.ModelForm):
    channels = forms.MultipleChoiceField(
        choices=CHANNEL_OPTIONS,
        widget=forms.CheckboxSelectMultiple,
        label=_("Canais"),
        required=False,
    )

    class Meta:
        model = ReminderRule
        fields = ["target_type", "remind_before_minutes", "channels", "is_active"]
        labels = {
            "target_type": _("Tipo de alvo"),
            "remind_before_minutes": _("Minutos antes"),
            "is_active": _("Ativo"),
        }
        widgets = {
            "target_type": forms.Select(attrs={"class": "form-select"}),
            "remind_before_minutes": forms.NumberInput(attrs={"class": "form-control", "min": 1}),
            "is_active": forms.CheckboxInput(attrs={"class": "form-check-input"}),
        }

    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)
        if self.instance and self.instance.channels:
            self.fields["channels"].initial = self.instance.channels

    def clean_remind_before_minutes(self):
        minutes = self.cleaned_data.get("remind_before_minutes")
        if minutes is not None and minutes <= 0:
            raise ValidationError(_("Informe um valor maior que zero."))
        return minutes

    def save(self, commit=True):
        instance = super().save(commit=False)
        instance.channels = self.cleaned_data.get("channels", [])
        if commit:
            instance.save()
        return instance

### apps/ui/forms_tasks.py
--------------------------------------------------------------------------------
from django import forms
from django.utils.translation import gettext_lazy as _

from planner.models import Task


class TaskForm(forms.ModelForm):
    class Meta:
        model = Task
        fields = ["title", "description", "due_date", "stress_level", "status"]
        labels = {
            "title": _("Titulo"),
            "description": _("Descricao"),
            "due_date": _("Data de entrega"),
            "stress_level": _("Nivel de estresse(0 a 5)"),
            "status": _("Status"),
        }
        widgets = {
            "title": forms.TextInput(attrs={"class": "form-control"}),
            "description": forms.Textarea(attrs={"class": "form-control", "rows": 4}),
            "due_date": forms.DateInput(attrs={"class": "form-control", "type": "date"}),
            "stress_level": forms.NumberInput(attrs={"class": "form-control", "min": 1, "max": 5}),
            "status": forms.Select(attrs={"class": "form-select"}),
        }

### apps/ui/services_academic.py
--------------------------------------------------------------------------------
from utils.academic_progress import (
    calculate_course_average,
    calculate_needed_to_pass,
    calculate_progress_percent,
)


def build_course_progress(course):
    assessments_qs = course.assessments.all()
    has_assessments = assessments_qs.exists()
    current_average = calculate_course_average(course)
    progress_percent = calculate_progress_percent(course)
    needed_to_pass = calculate_needed_to_pass(course)
    return {
        "has_assessments": has_assessments,
        "current_average": current_average,
        "passing_grade": course.passing_grade,
        "progress_percent": progress_percent,
        "needed_to_pass": needed_to_pass,
    }

### apps/ui/urls.py
--------------------------------------------------------------------------------
from django.contrib.auth import views as auth_views
from django.urls import path

from ui.forms import EmailAuthenticationForm
from ui.views import dashboard_view, first_access_view, onboarding_view, semesters_view, tasks_view
from ui.views_academic import (
    assessment_create_view,
    assessment_delete_view,
    assessment_update_view,
    course_create_view,
    course_delete_view,
    course_detail_view,
    course_update_view,
    semester_create_view,
    semester_delete_view,
    semester_detail_view,
    semester_list_view,
    semester_update_view,
)
from ui.views_agenda import agenda_create_view, agenda_delete_view, agenda_list_view, agenda_update_view
from ui.views_messages import message_list_view
from ui.views_reminders import (
    reminder_create_view,
    reminder_delete_view,
    reminder_generate_view,
    reminder_list_view,
    reminder_update_view,
)
from ui.views_tasks import task_create_view, task_delete_view, task_detail_view, task_list_view, task_update_view

urlpatterns = [
    path(
        "login/",
        auth_views.LoginView.as_view(
            template_name="ui/login.html",
            authentication_form=EmailAuthenticationForm,
        ),
        name="ui-login",
    ),
    path("primeiro-acesso/", first_access_view, name="ui-first-access"),
    path("logout/", auth_views.LogoutView.as_view(next_page="/login/"), name="ui-logout"),
    path(
        "password-reset/",
        auth_views.PasswordResetView.as_view(
            template_name="ui/password_reset_form.html",
            email_template_name="registration/password_reset_email.html",
            subject_template_name="registration/password_reset_subject.txt",
            success_url="/password-reset/done/",
        ),
        name="password_reset",
    ),
    path(
        "password-reset/done/",
        auth_views.PasswordResetDoneView.as_view(
            template_name="ui/password_reset_done.html",
        ),
        name="password_reset_done",
    ),
    path(
        "reset/<uidb64>/<token>/",
        auth_views.PasswordResetConfirmView.as_view(
            template_name="ui/password_reset_confirm.html",
            success_url="/reset/done/",
        ),
        name="password_reset_confirm",
    ),
    path(
        "reset/done/",
        auth_views.PasswordResetCompleteView.as_view(
            template_name="ui/password_reset_complete.html",
        ),
        name="password_reset_complete",
    ),
    path("", dashboard_view, name="ui-dashboard"),
    path("onboarding/", onboarding_view, name="ui-onboarding"),
    path("semesters/", semesters_view, name="ui-semesters"),
    path("semestres/", semester_list_view, name="ui-semester-list"),
    path("semestres/novo/", semester_create_view, name="ui-semester-create"),
    path("semestres/<int:pk>/", semester_detail_view, name="ui-semester-detail"),
    path("semestres/<int:pk>/editar/", semester_update_view, name="ui-semester-edit"),
    path("semestres/<int:pk>/excluir/", semester_delete_view, name="ui-semester-delete"),
    path("semestres/<int:sem_id>/disciplinas/nova/", course_create_view, name="ui-course-create"),
    path("disciplinas/<int:pk>/", course_detail_view, name="ui-course-detail"),
    path("disciplinas/<int:pk>/editar/", course_update_view, name="ui-course-edit"),
    path("disciplinas/<int:pk>/excluir/", course_delete_view, name="ui-course-delete"),
    path("disciplinas/<int:course_id>/avaliacoes/nova/", assessment_create_view, name="ui-assessment-create"),
    path("avaliacoes/<int:pk>/editar/", assessment_update_view, name="ui-assessment-edit"),
    path("avaliacoes/<int:pk>/excluir/", assessment_delete_view, name="ui-assessment-delete"),
    path("tasks/", task_list_view, name="ui-tasks"),
    path("agenda/", agenda_list_view, name="ui-agenda-list"),
    path("messages/", message_list_view, name="ui-messages"),
    path("tarefas/", task_list_view, name="ui-task-list"),
    path("tarefas/nova/", task_create_view, name="ui-task-create"),
    path("tarefas/<int:pk>/", task_detail_view, name="ui-task-detail"),
    path("tarefas/<int:pk>/editar/", task_update_view, name="ui-task-edit"),
    path("tarefas/<int:pk>/excluir/", task_delete_view, name="ui-task-delete"),
    path("agenda/novo/", agenda_create_view, name="ui-agenda-create"),
    path("agenda/<int:pk>/editar/", agenda_update_view, name="ui-agenda-edit"),
    path("agenda/<int:pk>/excluir/", agenda_delete_view, name="ui-agenda-delete"),
    path("lembretes/", reminder_list_view, name="ui-reminder-list"),
    path("lembretes/gerar/", reminder_generate_view, name="ui-reminder-generate"),
    path("lembretes/novo/", reminder_create_view, name="ui-reminder-create"),
    path("lembretes/<int:pk>/editar/", reminder_update_view, name="ui-reminder-edit"),
    path("lembretes/<int:pk>/excluir/", reminder_delete_view, name="ui-reminder-delete"),
    path("mensagens/", message_list_view, name="ui-message-list"),
]

### apps/ui/views.py
--------------------------------------------------------------------------------
from collections import Counter
from datetime import timedelta

from django.contrib import messages
from django.contrib.auth.decorators import login_required
from django.db.models import Q
from django.shortcuts import redirect, render
from django.utils import timezone
from django.utils.translation import gettext_lazy as _

from accounts.models import User, UserProfile
from agenda.models import CalendarEvent, ReminderRule
from billing.models import Plan, UserSubscription
from mood.models import MoodEntry
from notifications.models import NotificationQueue
from onboarding.services import refresh_user_progress
from planner.models import Task
from pomodoro.models import PomodoroSession
from semester.models import Course, Semester, SemesterCheckin
from utils.academic_progress import (
    calculate_course_average,
    calculate_needed_to_pass,
    calculate_progress_percent,
    update_course_status,
)
from utils.constants import (
    EVENT_TYPE_CHOICES,
    CHANNEL_IN_APP,
    SEMESTER_ACTIVE,
    SEMESTER_FINISHED,
    TASK_DOING,
    TASK_DONE,
    TASK_TODO,
    PLAN_LITE,
    PLAN_PRO,
)
from utils.gating import STEPS, compute_status
from ui.forms import FirstAccessForm

STEP_LABELS = {
    "STEP_1_PROFILE": _("Perfil"),
    "STEP_2_SEMESTER": _("Semestre"),
    "STEP_3_COURSES": _("Disciplinas"),
    "STEP_4_ASSESSMENTS": _("Avaliacoes"),
    "STEP_5_REMINDERS": _("Lembretes"),
    "STEP_6_DASHBOARD": _("Dashboard"),
}


def _build_steps(progress):
    current_step, missing_steps, required_actions = compute_status(progress)
    steps = []
    for step, _field, message in STEPS:
        label = STEP_LABELS.get(step, step)
        is_missing = step in missing_steps
        steps.append(
            {
                "code": step,
                "label": label,
                "missing": is_missing,
                "message": message if is_missing else _("Concluido"),
            }
        )
    return {
        "current_step": current_step,
        "missing_steps": missing_steps,
        "required_actions": required_actions,
        "steps": steps,
        "is_complete": len(missing_steps) == 0,
    }


# Bloco: Primeiro acesso / Criar conta
def first_access_view(request):
    if request.method == "POST":
        form = FirstAccessForm(request.POST)
        if form.is_valid():
            email = form.cleaned_data["email"].lower()
            if User.objects.filter(email=email).exists():
                messages.error(request, _("Ja existe um usuario com este email."))
                return render(request, "ui/first_access.html", {"form": form})

            user = User.objects.create_user(
                email=email,
                name=form.cleaned_data["name"],
                phone_number=form.cleaned_data.get("phone", ""),
                password=form.cleaned_data["password1"],
            )

            profile, _ = UserProfile.objects.get_or_create(user=user)
            profile.phone = form.cleaned_data.get("phone", "")
            profile.plan = form.cleaned_data["plan"]
            profile.allow_email = form.cleaned_data.get("allow_email", True)
            profile.allow_whatsapp = form.cleaned_data.get("allow_whatsapp", True)
            profile.allow_sms = form.cleaned_data.get("allow_sms", False)
            profile.consent_at = timezone.now()
            profile.save()

            plan_code = PLAN_PRO if profile.plan == UserProfile.PLAN_PAID else PLAN_LITE
            plan = Plan.objects.filter(code=plan_code, is_active=True).first()
            if plan:
                UserSubscription.objects.get_or_create(user=user, defaults={"plan": plan})

            messages.success(request, _("Conta criada com sucesso. Faca login para continuar."))
            return redirect("ui-login")
    else:
        form = FirstAccessForm()
    return render(request, "ui/first_access.html", {"form": form})


@login_required(login_url="/login/")
def dashboard_view(request):
    user = request.user
    progress = refresh_user_progress(user)
    onboarding_status = _build_steps(progress)

    session_key = "ui_dashboard_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if "q" in request.GET:
        search_query = request.GET.get("q", "").strip()
        request.session[session_key] = {"q": search_query}
    else:
        search_query = request.session.get(session_key, {}).get("q", "")

    now = timezone.now()
    week_ago = now - timedelta(days=7)

    mood_entries = MoodEntry.objects.filter(user=user, created_at__gte=week_ago)
    mood_counts = Counter(mood_entries.values_list("mood", flat=True))
    most_common_mood = None
    if mood_counts:
        most_common_mood = mood_counts.most_common(1)[0][0]

    focus_minutes = (
        PomodoroSession.objects.filter(user=user, started_at__gte=week_ago)
        .values_list("focus_minutes", flat=True)
    )
    total_focus_minutes = sum(focus_minutes)

    stress_values = SemesterCheckin.objects.filter(semester__user=user, created_at__gte=week_ago).values_list(
        "overall_stress", flat=True
    )
    stress_avg = round(sum(stress_values) / len(stress_values), 2) if stress_values else None

    today = timezone.localdate()
    next_week = today + timedelta(days=7)
    upcoming_tasks = Task.objects.filter(user=user, due_date__gte=today, due_date__lte=next_week).order_by("due_date")
    upcoming_events = CalendarEvent.objects.filter(
        user=user, start_at__date__gte=today, start_at__date__lte=next_week
    ).order_by("start_at")
    if search_query:
        upcoming_tasks = upcoming_tasks.filter(Q(title__icontains=search_query) | Q(description__icontains=search_query))
        upcoming_events = upcoming_events.filter(title__icontains=search_query)

    tasks = Task.objects.filter(user=user)
    courses = Course.objects.filter(semester__user=user).select_related("semester").order_by("title")
    course_progress = []
    for course in courses:
        course_progress.append(
            {
                "title": course.title,
                "semester": course.semester.name,
                "current_average": calculate_course_average(course),
                "passing_grade": course.passing_grade,
                "progress_percent": int(calculate_progress_percent(course)),
            }
        )
    dashboard_data = {
        "tasks": {
            "todo": tasks.filter(status=TASK_TODO).count(),
            "doing": tasks.filter(status=TASK_DOING).count(),
            "done": tasks.filter(status=TASK_DONE).count(),
        },
        "mood_weekly_total": mood_entries.count(),
        "mood_most_common": most_common_mood,
        "focus_minutes_week": total_focus_minutes,
        "stress_avg_week": stress_avg,
        "upcoming_tasks": upcoming_tasks[:5],
        "upcoming_events": upcoming_events[:5],
        "upcoming_count": upcoming_tasks.count() + upcoming_events.count(),
        "course_progress": course_progress[:5],
    }

    return render(
        request,
        "ui/dashboard.html",
        {
            "onboarding_status": onboarding_status,
            "dashboard_data": dashboard_data,
            "search_query": search_query,
        },
    )


@login_required(login_url="/login/")
def onboarding_view(request):
    user = request.user
    progress = refresh_user_progress(user)
    onboarding_status = _build_steps(progress)
    return render(
        request,
        "ui/onboarding.html",
        {
            "current_step": onboarding_status["current_step"],
            "missing_steps": onboarding_status["missing_steps"],
            "required_actions": onboarding_status["required_actions"],
            "steps": onboarding_status["steps"],
        },
    )


@login_required(login_url="/login/")
def semesters_view(request):
    user = request.user
    session_key = "ui_semesters_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if any(key in request.GET for key in ("status", "course", "teacher")):
        status_filter = request.GET.get("status", "")
        course_query = request.GET.get("course", "").strip()
        teacher_query = request.GET.get("teacher", "").strip()
        request.session[session_key] = {
            "status": status_filter,
            "course": course_query,
            "teacher": teacher_query,
        }
    else:
        saved = request.session.get(session_key, {})
        status_filter = saved.get("status", "")
        course_query = saved.get("course", "")
        teacher_query = saved.get("teacher", "")
    semesters = Semester.objects.filter(user=user)
    if status_filter in {SEMESTER_ACTIVE, SEMESTER_FINISHED}:
        semesters = semesters.filter(status=status_filter)
    semesters = semesters.order_by("-start_date")
    semester_cards = []
    for semester in semesters.prefetch_related("courses__assessments"):
        courses_data = []
        for course in semester.courses.all():
            if course_query and course_query.lower() not in course.title.lower():
                continue
            if teacher_query and teacher_query.lower() not in (course.teacher or "").lower():
                continue
            current_average = calculate_course_average(course)
            progress_percent = calculate_progress_percent(course)
            progress_value = float(progress_percent)
            progress_display = f"{progress_value:.2f}"
            needed_to_pass = calculate_needed_to_pass(course)
            previous_status = course.status
            update_course_status(course, semester_status=semester.status)
            if course.status != previous_status:
                course.save(update_fields=["status"])
            courses_data.append(
                {
                    "title": course.title,
                    "teacher": course.teacher,
                    "status": course.status,
                    "passing_grade": course.passing_grade,
                    "current_average": current_average,
                    "progress_percent": progress_display,
                    "progress_percent_css": progress_display,
                    "needed_to_pass": needed_to_pass,
                }
            )
        if (course_query or teacher_query) and not courses_data:
            continue
        semester_cards.append(
            {
                "name": semester.name,
                "start_date": semester.start_date,
                "end_date": semester.end_date,
                "status": semester.status,
                "courses": courses_data,
            }
        )

    return render(
        request,
        "ui/semesters.html",
        {
            "semesters": semester_cards,
            "status_filter": status_filter,
            "course_query": course_query,
            "teacher_query": teacher_query,
        },
    )


@login_required(login_url="/login/")
def tasks_view(request):
    user = request.user
    session_key = "ui_tasks_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if any(key in request.GET for key in ("status", "due", "q", "stress")):
        status_filter = request.GET.get("status", "")
        due_filter = request.GET.get("due", "")
        search_query = request.GET.get("q", "").strip()
        stress_filter = request.GET.get("stress", "")
        request.session[session_key] = {
            "status": status_filter,
            "due": due_filter,
            "q": search_query,
            "stress": stress_filter,
        }
    else:
        saved = request.session.get(session_key, {})
        status_filter = saved.get("status", "")
        due_filter = saved.get("due", "")
        search_query = saved.get("q", "")
        stress_filter = saved.get("stress", "")
    tasks = Task.objects.filter(user=user)
    if status_filter in {TASK_TODO, TASK_DOING, TASK_DONE}:
        tasks = tasks.filter(status=status_filter)
    today = timezone.localdate()
    if due_filter == "overdue":
        tasks = tasks.filter(due_date__lt=today)
    elif due_filter == "today":
        tasks = tasks.filter(due_date=today)
    elif due_filter == "week":
        tasks = tasks.filter(due_date__gte=today, due_date__lte=today + timedelta(days=7))
    elif due_filter == "month":
        tasks = tasks.filter(due_date__gte=today, due_date__lte=today + timedelta(days=30))
    if search_query:
        tasks = tasks.filter(Q(title__icontains=search_query) | Q(description__icontains=search_query))
    if stress_filter in {"1", "2", "3", "4", "5"}:
        tasks = tasks.filter(stress_level=int(stress_filter))
    tasks = tasks.order_by("due_date")
    return render(
        request,
        "ui/tasks.html",
        {
            "tasks": tasks,
            "status_filter": status_filter,
            "due_filter": due_filter,
            "search_query": search_query,
            "stress_filter": stress_filter,
        },
    )


@login_required(login_url="/login/")
def agenda_view(request):
    user = request.user
    today = timezone.localdate()
    session_key = "ui_agenda_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if any(key in request.GET for key in ("range", "q", "type")):
        range_days = request.GET.get("range", "30")
        if range_days not in {"7", "15", "30", "60", "90"}:
            range_days = "30"
        search_query = request.GET.get("q", "").strip()
        type_filter = request.GET.get("type", "")
        request.session[session_key] = {
            "range": range_days,
            "q": search_query,
            "type": type_filter,
        }
    else:
        saved = request.session.get(session_key, {})
        range_days = saved.get("range", "30")
        search_query = saved.get("q", "")
        type_filter = saved.get("type", "")
    next_month = today + timedelta(days=int(range_days))
    events = CalendarEvent.objects.filter(
        user=user, start_at__date__gte=today, start_at__date__lte=next_month
    ).order_by("start_at")
    if search_query:
        events = events.filter(title__icontains=search_query)
    event_type_values = [value for value, _label in EVENT_TYPE_CHOICES]
    if type_filter in event_type_values:
        events = events.filter(event_type=type_filter)
    reminder_rules = ReminderRule.objects.filter(user=user, is_active=True)
    return render(
        request,
        "ui/agenda.html",
        {
            "events": events,
            "reminder_rules": reminder_rules,
            "range_days": range_days,
            "search_query": search_query,
            "type_filter": type_filter,
            "event_type_choices": EVENT_TYPE_CHOICES,
        },
    )


@login_required(login_url="/login/")
def messages_view(request):
    user = request.user
    notifications = NotificationQueue.objects.filter(user=user, channel=CHANNEL_IN_APP).order_by("-scheduled_for")
    return render(
        request,
        "ui/messages.html",
        {
            "notifications": notifications,
        },
    )

### apps/ui/views_academic.py
--------------------------------------------------------------------------------
from django.contrib import messages
from django.contrib.auth.decorators import login_required
from django.shortcuts import get_object_or_404, redirect, render
from django.utils.translation import gettext_lazy as _

from semester.models import Assessment, Course, Semester
from ui.forms_academic import AssessmentForm, CourseForm, SemesterForm
from ui.services_academic import build_course_progress


@login_required(login_url="/login/")
def semester_list_view(request):
    semesters = Semester.objects.filter(user=request.user).order_by("-start_date")
    return render(request, "ui/semester/semester_list.html", {"semesters": semesters})


@login_required(login_url="/login/")
def semester_create_view(request):
    if request.method == "POST":
        form = SemesterForm(request.POST)
        if form.is_valid():
            semester = form.save(commit=False)
            semester.user = request.user
            semester.save()
            messages.success(request, _("Semestre criado com sucesso."))
            return redirect("ui-semester-detail", pk=semester.pk)
    else:
        form = SemesterForm()
    return render(request, "ui/semester/semester_form.html", {"form": form, "mode": "create"})


@login_required(login_url="/login/")
def semester_detail_view(request, pk: int):
    semester = get_object_or_404(Semester, pk=pk, user=request.user)
    courses = semester.courses.all().order_by("title")
    return render(
        request,
        "ui/semester/semester_detail.html",
        {"semester": semester, "courses": courses},
    )


@login_required(login_url="/login/")
def semester_update_view(request, pk: int):
    semester = get_object_or_404(Semester, pk=pk, user=request.user)
    if request.method == "POST":
        form = SemesterForm(request.POST, instance=semester)
        if form.is_valid():
            form.save()
            messages.success(request, _("Semestre atualizado com sucesso."))
            return redirect("ui-semester-detail", pk=semester.pk)
    else:
        form = SemesterForm(instance=semester)
    return render(
        request,
        "ui/semester/semester_form.html",
        {"form": form, "semester": semester, "mode": "edit"},
    )


@login_required(login_url="/login/")
def semester_delete_view(request, pk: int):
    semester = get_object_or_404(Semester, pk=pk, user=request.user)
    if request.method == "POST":
        semester.delete()
        messages.success(request, _("Semestre excluido com sucesso."))
        return redirect("ui-semester-list")
    return render(
        request,
        "ui/semester/semester_confirm_delete.html",
        {"semester": semester},
    )


@login_required(login_url="/login/")
def course_create_view(request, sem_id: int):
    semester = get_object_or_404(Semester, pk=sem_id, user=request.user)
    if request.method == "POST":
        form = CourseForm(request.POST)
        if form.is_valid():
            course = form.save(commit=False)
            course.semester = semester
            course.save()
            messages.success(request, _("Disciplina criada com sucesso."))
            return redirect("ui-course-detail", pk=course.pk)
    else:
        form = CourseForm()
    return render(
        request,
        "ui/course/course_form.html",
        {"form": form, "semester": semester, "mode": "create"},
    )


@login_required(login_url="/login/")
def course_detail_view(request, pk: int):
    course = get_object_or_404(Course, pk=pk, semester__user=request.user)
    assessments = course.assessments.all().order_by("-date", "-created_at")
    progress = build_course_progress(course)
    return render(
        request,
        "ui/course/course_detail.html",
        {"course": course, "assessments": assessments, "progress": progress},
    )


@login_required(login_url="/login/")
def course_update_view(request, pk: int):
    course = get_object_or_404(Course, pk=pk, semester__user=request.user)
    if request.method == "POST":
        form = CourseForm(request.POST, instance=course)
        if form.is_valid():
            form.save()
            messages.success(request, _("Disciplina atualizada com sucesso."))
            return redirect("ui-course-detail", pk=course.pk)
    else:
        form = CourseForm(instance=course)
    return render(
        request,
        "ui/course/course_form.html",
        {"form": form, "course": course, "semester": course.semester, "mode": "edit"},
    )


@login_required(login_url="/login/")
def course_delete_view(request, pk: int):
    course = get_object_or_404(Course, pk=pk, semester__user=request.user)
    if request.method == "POST":
        semester_id = course.semester_id
        course.delete()
        messages.success(request, _("Disciplina excluida com sucesso."))
        return redirect("ui-semester-detail", pk=semester_id)
    return render(
        request,
        "ui/course/course_confirm_delete.html",
        {"course": course},
    )


@login_required(login_url="/login/")
def assessment_create_view(request, course_id: int):
    course = get_object_or_404(Course, pk=course_id, semester__user=request.user)
    if request.method == "POST":
        form = AssessmentForm(request.POST)
        if form.is_valid():
            assessment = form.save(commit=False)
            assessment.course = course
            assessment.save()
            messages.success(request, _("Avaliacao criada com sucesso."))
            return redirect("ui-course-detail", pk=course.pk)
    else:
        form = AssessmentForm()
    return render(
        request,
        "ui/assessment/assessment_form.html",
        {"form": form, "course": course, "mode": "create"},
    )


@login_required(login_url="/login/")
def assessment_update_view(request, pk: int):
    assessment = get_object_or_404(Assessment, pk=pk, course__semester__user=request.user)
    if request.method == "POST":
        form = AssessmentForm(request.POST, instance=assessment)
        if form.is_valid():
            form.save()
            messages.success(request, _("Avaliacao atualizada com sucesso."))
            return redirect("ui-course-detail", pk=assessment.course_id)
    else:
        form = AssessmentForm(instance=assessment)
    return render(
        request,
        "ui/assessment/assessment_form.html",
        {"form": form, "course": assessment.course, "assessment": assessment, "mode": "edit"},
    )


@login_required(login_url="/login/")
def assessment_delete_view(request, pk: int):
    assessment = get_object_or_404(Assessment, pk=pk, course__semester__user=request.user)
    if request.method == "POST":
        course_id = assessment.course_id
        assessment.delete()
        messages.success(request, _("Avaliacao excluida com sucesso."))
        return redirect("ui-course-detail", pk=course_id)
    return render(
        request,
        "ui/assessment/assessment_confirm_delete.html",
        {"assessment": assessment, "course": assessment.course},
    )

### apps/ui/views_agenda.py
--------------------------------------------------------------------------------
from django.contrib import messages
from django.contrib.auth.decorators import login_required
from django.shortcuts import get_object_or_404, redirect, render
from django.utils import timezone
from django.utils.translation import gettext_lazy as _

from agenda.models import CalendarEvent
from notifications.services.reminder_queue import create_notifications_for_event
from ui.forms_agenda import CalendarEventForm


@login_required(login_url="/login/")
def agenda_list_view(request):
    events = CalendarEvent.objects.filter(user=request.user).order_by("start_at")
    return render(
        request,
        "ui/agenda/agenda_list.html",
        {
            "events": events,
            "now": timezone.now(),
        },
    )


@login_required(login_url="/login/")
def agenda_create_view(request):
    if request.method == "POST":
        form = CalendarEventForm(request.POST, user=request.user)
        if form.is_valid():
            event = form.save(commit=False)
            event.user = request.user
            event.save()
            # Bloco: Criacao de lembretes para evento
            create_notifications_for_event(request.user, event)
            messages.success(request, _("Evento criado com sucesso."))
            return redirect("ui-agenda-list")
    else:
        form = CalendarEventForm(user=request.user)
    return render(request, "ui/agenda/agenda_form.html", {"form": form, "mode": "create"})


@login_required(login_url="/login/")
def agenda_update_view(request, pk: int):
    event = get_object_or_404(CalendarEvent, pk=pk, user=request.user)
    if request.method == "POST":
        form = CalendarEventForm(request.POST, instance=event, user=request.user)
        if form.is_valid():
            event = form.save()
            # Bloco: Atualizacao de lembretes para evento
            create_notifications_for_event(request.user, event)
            messages.success(request, _("Evento atualizado com sucesso."))
            return redirect("ui-agenda-list")
    else:
        form = CalendarEventForm(instance=event, user=request.user)
    return render(request, "ui/agenda/agenda_form.html", {"form": form, "mode": "edit", "event": event})


@login_required(login_url="/login/")
def agenda_delete_view(request, pk: int):
    event = get_object_or_404(CalendarEvent, pk=pk, user=request.user)
    if request.method == "POST":
        event.delete()
        messages.success(request, _("Evento excluido com sucesso."))
        return redirect("ui-agenda-list")
    return render(request, "ui/agenda/agenda_confirm_delete.html", {"event": event})

### apps/ui/views_messages.py
--------------------------------------------------------------------------------
from django.contrib.auth.decorators import login_required
from django.shortcuts import render
from django.utils.translation import gettext_lazy as _

from notifications.models import NotificationQueue
from utils.constants import CHANNEL_CHOICES, NOTIFICATION_STATUS_CHOICES


@login_required(login_url="/login/")
def message_list_view(request):
    status_filter = request.GET.get("status", "")
    channel_filter = request.GET.get("channel", "")

    notifications = NotificationQueue.objects.filter(user=request.user)
    if status_filter:
        notifications = notifications.filter(status=status_filter)
    if channel_filter:
        notifications = notifications.filter(channel=channel_filter)

    notifications = notifications.order_by("-scheduled_for", "-created_at")

    return render(
        request,
        "ui/messages/message_list.html",
        {
            "notifications": notifications,
            "status_filter": status_filter,
            "channel_filter": channel_filter,
            "status_choices": NOTIFICATION_STATUS_CHOICES,
            "channel_choices": CHANNEL_CHOICES,
        },
    )

### apps/ui/views_reminders.py
--------------------------------------------------------------------------------
from django.contrib import messages
from django.contrib.auth.decorators import login_required
from django.shortcuts import get_object_or_404, redirect, render
from django.utils.translation import gettext_lazy as _

from agenda.models import ReminderRule
from notifications.services.reminder_queue import create_notifications_for_user
from ui.forms_reminders import ReminderRuleForm


@login_required(login_url="/login/")
def reminder_list_view(request):
    reminders = ReminderRule.objects.filter(user=request.user).order_by("-is_active", "remind_before_minutes")
    return render(request, "ui/reminders/reminder_list.html", {"reminders": reminders})


# Bloco: Gerar lembretes via interface web
@login_required(login_url="/login/")
def reminder_generate_view(request):
    if request.method != "POST":
        return redirect("ui-reminder-list")

    created = create_notifications_for_user(request.user)
    if created:
        messages.success(request, _("Lembretes gerados com sucesso."))
    else:
        messages.info(request, _("Nenhum lembrete novo foi gerado."))
    return redirect("ui-reminder-list")


@login_required(login_url="/login/")
def reminder_create_view(request):
    if request.method == "POST":
        form = ReminderRuleForm(request.POST)
        if form.is_valid():
            reminder = form.save(commit=False)
            reminder.user = request.user
            reminder.save()
            messages.success(request, _("Regra de lembrete criada com sucesso."))
            return redirect("ui-reminder-list")
    else:
        form = ReminderRuleForm()
    return render(request, "ui/reminders/reminder_form.html", {"form": form, "mode": "create"})


@login_required(login_url="/login/")
def reminder_update_view(request, pk: int):
    reminder = get_object_or_404(ReminderRule, pk=pk, user=request.user)
    if request.method == "POST":
        form = ReminderRuleForm(request.POST, instance=reminder)
        if form.is_valid():
            form.save()
            messages.success(request, _("Regra de lembrete atualizada com sucesso."))
            return redirect("ui-reminder-list")
    else:
        form = ReminderRuleForm(instance=reminder)
    return render(
        request,
        "ui/reminders/reminder_form.html",
        {"form": form, "mode": "edit", "reminder": reminder},
    )


@login_required(login_url="/login/")
def reminder_delete_view(request, pk: int):
    reminder = get_object_or_404(ReminderRule, pk=pk, user=request.user)
    if request.method == "POST":
        reminder.delete()
        messages.success(request, _("Regra de lembrete excluida com sucesso."))
        return redirect("ui-reminder-list")
    return render(request, "ui/reminders/reminder_confirm_delete.html", {"reminder": reminder})

### apps/ui/views_tasks.py
--------------------------------------------------------------------------------
from django.contrib import messages
from django.contrib.auth.decorators import login_required
from django.db.models import Q
from django.shortcuts import get_object_or_404, redirect, render
from django.utils.translation import gettext_lazy as _

from notifications.services.reminder_queue import create_notifications_for_task
from planner.models import Task
from ui.forms_tasks import TaskForm
from utils.constants import TASK_DONE, TASK_DOING, TASK_TODO


@login_required(login_url="/login/")
def task_list_view(request):
    tasks = Task.objects.filter(user=request.user)
    status_filter = request.GET.get("status", "")
    query = request.GET.get("q", "").strip()

    if status_filter in {TASK_TODO, TASK_DOING, TASK_DONE}:
        tasks = tasks.filter(status=status_filter)
    if query:
        tasks = tasks.filter(Q(title__icontains=query) | Q(description__icontains=query))

    tasks = tasks.order_by("due_date")

    return render(
        request,
        "ui/tasks/task_list.html",
        {
            "tasks": tasks,
            "status_filter": status_filter,
            "query": query,
        },
    )


@login_required(login_url="/login/")
def task_create_view(request):
    if request.method == "POST":
        form = TaskForm(request.POST)
        if form.is_valid():
            task = form.save(commit=False)
            task.user = request.user
            task.save()
            # Bloco: Criacao de lembretes para tarefa
            create_notifications_for_task(request.user, task)
            messages.success(request, _("Tarefa criada com sucesso."))
            return redirect("ui-task-detail", pk=task.pk)
    else:
        form = TaskForm()
    return render(request, "ui/tasks/task_form.html", {"form": form, "mode": "create"})


@login_required(login_url="/login/")
def task_detail_view(request, pk: int):
    task = get_object_or_404(Task, pk=pk, user=request.user)
    return render(request, "ui/tasks/task_detail.html", {"task": task})


@login_required(login_url="/login/")
def task_update_view(request, pk: int):
    task = get_object_or_404(Task, pk=pk, user=request.user)
    if request.method == "POST":
        form = TaskForm(request.POST, instance=task)
        if form.is_valid():
            task = form.save()
            # Bloco: Atualizacao de lembretes para tarefa
            create_notifications_for_task(request.user, task)
            messages.success(request, _("Tarefa atualizada com sucesso."))
            return redirect("ui-task-detail", pk=task.pk)
    else:
        form = TaskForm(instance=task)
    return render(request, "ui/tasks/task_form.html", {"form": form, "mode": "edit", "task": task})


@login_required(login_url="/login/")
def task_delete_view(request, pk: int):
    task = get_object_or_404(Task, pk=pk, user=request.user)
    if request.method == "POST":
        task.delete()
        messages.success(request, _("Tarefa excluida com sucesso."))
        return redirect("ui-task-list")
    return render(request, "ui/tasks/task_confirm_delete.html", {"task": task})

### config/__init__.py
--------------------------------------------------------------------------------


### config/asgi.py
--------------------------------------------------------------------------------
"""
ASGI config for config project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')

application = get_asgi_application()

### config/settings.py
--------------------------------------------------------------------------------
"""
Django settings for campus_calm project.
"""

import os
import sys
from pathlib import Path

from django.utils.translation import gettext_lazy as _

BASE_DIR = Path(__file__).resolve().parent.parent

# Ensure /apps is on the path for INSTALLED_APPS like "accounts"
sys.path.insert(0, str(BASE_DIR / "apps"))

SECRET_KEY = os.getenv("DJANGO_SECRET_KEY", "django-insecure-dev-key")
DEBUG = os.getenv("DJANGO_DEBUG", "True").lower() == "true"
_allowed_hosts_env = [host for host in os.getenv("DJANGO_ALLOWED_HOSTS", "").split(",") if host]
if _allowed_hosts_env:
    ALLOWED_HOSTS = _allowed_hosts_env
elif DEBUG:
    ALLOWED_HOSTS = ["localhost", "127.0.0.1", "[::1]", ".ngrok-free.app", ".ngrok-free.dev", ".ngrok.io"]
else:
    ALLOWED_HOSTS = []

INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "corsheaders",
    "rest_framework",
    "rest_framework_simplejwt",
    "drf_spectacular",
    "accounts",
    "billing.apps.BillingConfig",
    "mood",
    "pomodoro",
    "planner",
    "agenda",
    "semester",
    "content",
    "coach_ai",
    "notifications",
    "access_requests",
    "onboarding.apps.OnboardingConfig",
    "analytics",
    "ui.apps.UiConfig",
]

MIDDLEWARE = [
    "corsheaders.middleware.CorsMiddleware",
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.locale.LocaleMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
]

ROOT_URLCONF = "config.urls"

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [BASE_DIR / "templates"],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
            ],
        },
    }
]

WSGI_APPLICATION = "config.wsgi.application"

DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3",
        "NAME": BASE_DIR / "db.sqlite3",
    }
}

AUTH_PASSWORD_VALIDATORS = [
    {"NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator"},
    {"NAME": "django.contrib.auth.password_validation.MinimumLengthValidator"},
    {"NAME": "django.contrib.auth.password_validation.CommonPasswordValidator"},
    {"NAME": "django.contrib.auth.password_validation.NumericPasswordValidator"},
]

LANGUAGE_CODE = "pt-br"
TIME_ZONE = "America/Sao_Paulo"
USE_I18N = True
USE_TZ = True
LANGUAGES = [
    ("en", _("English")),
    ("pt-br", _("Portugus (Brasil)")),
    ("pt-pt", _("Portugus (Portugal)")),
]
LOCALE_PATHS = [BASE_DIR / "locale"]

STATIC_URL = "/static/"
STATICFILES_DIRS = [BASE_DIR / "static"]

MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"
AUTH_USER_MODEL = "accounts.User"

REST_FRAMEWORK = {
    "DEFAULT_AUTHENTICATION_CLASSES": (
        "rest_framework_simplejwt.authentication.JWTAuthentication",
    ),
    "DEFAULT_PERMISSION_CLASSES": ("rest_framework.permissions.IsAuthenticated",),
    "DEFAULT_SCHEMA_CLASS": "drf_spectacular.openapi.AutoSchema",
}

SPECTACULAR_SETTINGS = {
    "TITLE": "Campus Calm API",
    "DESCRIPTION": "API do MVP Campus Calm",
    "VERSION": "0.1.0",
}

CORS_ALLOW_ALL_ORIGINS = True

EMAIL_BACKEND = "django.core.mail.backends.console.EmailBackend"
DEFAULT_FROM_EMAIL = os.getenv("DEFAULT_FROM_EMAIL", "no-reply@campuscalm.local")

LOGIN_URL = "/login/"
LOGIN_REDIRECT_URL = "/"
LOGOUT_REDIRECT_URL = "/login/"

# Bloco: WhatsApp Cloud API
WHATSAPP_CLOUD_TOKEN = os.getenv("WHATSAPP_CLOUD_TOKEN", "")
WHATSAPP_PHONE_NUMBER_ID = os.getenv("WHATSAPP_PHONE_NUMBER_ID", "")
WHATSAPP_VERIFY_TOKEN = os.getenv("WHATSAPP_VERIFY_TOKEN", "")
SITE_BASE_URL = os.getenv("SITE_BASE_URL", "")

if DEBUG:
    CSRF_TRUSTED_ORIGINS = [
        "https://*.ngrok-free.app",
        "https://*.ngrok-free.dev",
        "https://*.ngrok.io",
    ]

### config/settings_migrations.py
--------------------------------------------------------------------------------
"""Settings file for generating migrations without third-party dependencies."""

import os
import sys
from pathlib import Path

BASE_DIR = Path(__file__).resolve().parent.parent
sys.path.insert(0, str(BASE_DIR / "apps"))

SECRET_KEY = "migration-only"
DEBUG = True
ALLOWED_HOSTS = []

INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "accounts",
    "billing.apps.BillingConfig",
    "mood",
    "pomodoro",
    "planner",
    "agenda",
    "semester",
    "content",
    "coach_ai",
    "notifications",
    "access_requests",
    "onboarding.apps.OnboardingConfig",
    "analytics",
    "ui.apps.UiConfig",
]

MIDDLEWARE = [
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
]

ROOT_URLCONF = "config.urls"

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [BASE_DIR / "templates"],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
            ],
        },
    }
]

DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3",
        "NAME": BASE_DIR / "db.sqlite3",
    }
}

LANGUAGE_CODE = "pt-br"
TIME_ZONE = "America/Sao_Paulo"
USE_I18N = True
USE_TZ = True

STATIC_URL = "/static/"
MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"
AUTH_USER_MODEL = "accounts.User"

### config/urls.py
--------------------------------------------------------------------------------
from django.conf import settings
from django.conf.urls.static import static
from django.contrib import admin
from django.urls import include, path
from drf_spectacular.views import SpectacularAPIView, SpectacularSwaggerView

from config.views import health_check

urlpatterns = [
    path("admin/", admin.site.urls),
    path("health/", health_check, name="health-check"),
    path("i18n/", include("django.conf.urls.i18n")),
    path("", include("ui.urls")),
    path("api/schema/", SpectacularAPIView.as_view(), name="schema"),
    path("api/docs/", SpectacularSwaggerView.as_view(url_name="schema"), name="docs"),
    path("api/auth/", include("accounts.urls")),
    path("api/billing/", include("billing.urls")),
    path("api/mood/", include("mood.urls")),
    path("api/pomodoro/", include("pomodoro.urls")),
    path("api/planner/", include("planner.urls")),
    path("api/agenda/", include("agenda.urls")),
    path("api/semester/", include("semester.urls")),
    path("api/content/", include("content.urls")),
    path("api/notifications/", include("notifications.urls")),
    path("api/access/", include("access_requests.urls")),
    path("api/onboarding/", include("onboarding.urls")),
    path("api/analytics/", include("analytics.urls")),
]

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)

### config/views.py
--------------------------------------------------------------------------------
from django.http import JsonResponse
from django.utils import timezone


def health_check(_request):
    return JsonResponse({"status": "ok", "timestamp": timezone.now().isoformat()})

### config/wsgi.py
--------------------------------------------------------------------------------
"""
WSGI config for config project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')

application = get_wsgi_application()

### docs/TESTE_NOTIFICACOES.md
--------------------------------------------------------------------------------
# Teste de Notificacoes (MVP)

Checklist para validar email e WhatsApp em ambiente de teste:

1. Acessar `/login/` e clicar em **Primeiro acesso / Criar conta**.
2. Criar conta com telefone e permitir WhatsApp.
3. Fazer login.
4. Criar uma tarefa com data para hoje/amanha.
5. Criar um evento na agenda para +2 minutos.
6. Criar uma regra de lembrete (minutos antes) com canal **EMAIL** e **WHATSAPP**.
7. Em **Lembretes**, clicar em **Gerar lembretes**.
8. Verificar recebimento por email e WhatsApp.
9. Responder **2** e confirmar novo lembrete em 10 minutos.
10. Responder **1** e confirmar status no historico.
11. Responder **3** e confirmar cancelamento no historico.

Observacao: o webhook deve estar configurado no Meta WhatsApp Cloud com o endpoint:
`/api/notifications/whatsapp/webhook/`.

### docs/full_dump.txt
--------------------------------------------------------------------------------
Campus Calm - Full Project Dump
===============================


--- FILE: .env.example ---
DJANGO_SECRET_KEY=change-me
DJANGO_DEBUG=True
DJANGO_ALLOWED_HOSTS=localhost,127.0.0.1
DEFAULT_FROM_EMAIL=no-reply@campuscalm.local
TRIAGE_MODEL_NAME=mock-v1
TRIAGE_USE_LLM=false

--- FILE: README.md ---
# Campus Calm (MVP)

MVP para universitarios acompanharem o semestre com bem-estar, organizacao e foco. O projeto usa Django + Django REST Framework, autenticacao JWT e banco SQLite em dev.

## Requisitos
- Python 3.12+
- Pip

## Setup rapido
```bash
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt

python manage.py migrate
python manage.py createsuperuser
python manage.py runserver
```

## Variaveis de ambiente
Copie `.env.example` e ajuste conforme necessario. A variavel `TRIAGE_USE_LLM` prepara a triagem para LLM futuro (mock no MVP).

## Endpoints principais
- Auth: `/api/auth/register/`, `/api/auth/login/`, `/api/auth/refresh/`, `/api/auth/me/`
- Billing: `/api/billing/plan/`, `/api/billing/set-plan/` (admin)
- Onboarding: `/api/onboarding/status/`
- Mood: `/api/mood/entries/`, `/api/mood/summary/weekly/`
- Pomodoro: `/api/pomodoro/start/`, `/api/pomodoro/stop/{id}/`, `/api/pomodoro/summary/weekly/`
- Planner: `/api/planner/tasks/`
- Agenda: `/api/agenda/events/`, `/api/agenda/week/`, `/api/agenda/generate-reminders/`
- Semester: `/api/semester/semesters/`, `/api/semester/courses/`, `/api/semester/assessments/`, `/api/semester/courses/{id}/progress/`, `/api/semester/finish/{semester_id}/`
- Content: `/api/content/guided/`, `/api/content/guided/{id}/`
- Notifications: `/api/notifications/test-email/`, `/api/notifications/pending/`
- Access Requests: `/api/access/requests/`, `/api/access/requests/{id}/approve/`, `/api/access/requests/{id}/reject/`, `/api/access/triage/{id}/log/`
- Analytics: `/api/analytics/dashboard/`, `/api/analytics/semester/{semester_id}/`

## Documentacao automatica
- Schema: `/api/schema/`
- Swagger UI: `/api/docs/`

## Exemplos com curl
### Registrar
```bash
curl -X POST http://localhost:8000/api/auth/register/ \
  -H "Content-Type: application/json" \
  -d '{"email":"aluno@exemplo.com","name":"Aluno","password":"senha123"}'
```

### Login
```bash
curl -X POST http://localhost:8000/api/auth/login/ \
  -H "Content-Type: application/json" \
  -d '{"email":"aluno@exemplo.com","password":"senha123"}'
```

### Criar check-in de humor
```bash
curl -X POST http://localhost:8000/api/mood/entries/ \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{"mood":"OK","notes":"Dia produtivo"}'
```

### Criar tarefa
```bash
curl -X POST http://localhost:8000/api/planner/tasks/ \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{"title":"Trabalho final","due_date":"2026-03-10","stress_level":3,"status":"TODO"}'
```

### Criar regra de lembrete e gerar notificacoes
```bash
curl -X POST http://localhost:8000/api/agenda/reminder-rules/ \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{"target_type":"TASK","remind_before_minutes":60,"channels":["EMAIL"],"is_active":true}'

curl -X POST http://localhost:8000/api/agenda/generate-reminders/ \
  -H "Authorization: Bearer <ACCESS_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{}'
```

### Solicitar acesso (triagem automatica)
```bash
curl -X POST http://localhost:8000/api/access/requests/ \
  -H "Content-Type: application/json" \
  -d '{"requester_email":"coord@faculdade.com","requester_type":"INSTITUTION","estimated_users":120}'
```

## Health-check
```bash
curl http://localhost:8000/health/
```

## Script de demo (curl)
```bash
bash scripts/run_curl_demo.sh
```

## Seed de dados (mais completo)
```bash
python manage.py seed_demo_data --email nari.naluu@gmail.com
```

## Notificacoes
- Email: backend console em dev.
- WhatsApp/SMS: mock no MVP.

Processar fila manualmente:
```bash
python manage.py process_notification_queue
```

## Observacoes de seguranca
- O sistema nao e um dispositivo medico.
- Em humor muito baixo recorrente, o sistema recomenda apoio profissional (ex: CVV 188).

## Tests
```bash
python manage.py test
```

--- FILE: apps/access_requests/__init__.py ---


--- FILE: apps/access_requests/admin.py ---
from django.contrib import admin

from access_requests.models import AccessRequest, AITriageLog


@admin.register(AccessRequest)
class AccessRequestAdmin(admin.ModelAdmin):
    list_display = ("requester_email", "requester_type", "status", "recommended_plan", "decided_plan")
    list_filter = ("status", "requester_type")
    search_fields = ("requester_email", "requester_name")


@admin.register(AITriageLog)
class AITriageLogAdmin(admin.ModelAdmin):
    list_display = ("access_request", "model_name", "created_at")

--- FILE: apps/access_requests/apps.py ---
from django.apps import AppConfig


class AccessRequestsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'access_requests'

--- FILE: apps/access_requests/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='AccessRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('requester_email', models.EmailField(max_length=254)),
                ('requester_name', models.CharField(blank=True, max_length=255)),
                ('requester_type', models.CharField(choices=[('INDIVIDUAL', 'Individual'), ('INSTITUTION', 'Institution')], max_length=20)),
                ('institution_name', models.CharField(blank=True, max_length=255)),
                ('estimated_users', models.PositiveIntegerField(blank=True, null=True)),
                ('wants_features', models.JSONField(default=list)),
                ('message', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('APPROVED', 'Approved'), ('REJECTED', 'Rejected')], default='PENDING', max_length=20)),
                ('recommended_plan', models.CharField(blank=True, choices=[('LITE', 'Lite'), ('PRO', 'Pro')], max_length=10)),
                ('decided_plan', models.CharField(blank=True, choices=[('LITE', 'Lite'), ('PRO', 'Pro')], max_length=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
        ),
        migrations.CreateModel(
            name='AITriageLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('model_name', models.CharField(max_length=100)),
                ('input_payload', models.JSONField()),
                ('output_payload', models.JSONField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('access_request', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='triage_logs', to='access_requests.accessrequest')),
            ],
        ),
    ]

--- FILE: apps/access_requests/migrations/0002_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('access_requests', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='accessrequest',
            name='created_user',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL),
        ),
    ]

--- FILE: apps/access_requests/migrations/__init__.py ---


--- FILE: apps/access_requests/models.py ---
from django.conf import settings
from django.db import models

from utils.constants import ACCESS_STATUS_CHOICES, ACCESS_PENDING, PLAN_CHOICES, REQUESTER_TYPE_CHOICES


class AccessRequest(models.Model):
    requester_email = models.EmailField()
    requester_name = models.CharField(max_length=255, blank=True)
    requester_type = models.CharField(max_length=20, choices=REQUESTER_TYPE_CHOICES)
    institution_name = models.CharField(max_length=255, blank=True)
    estimated_users = models.PositiveIntegerField(null=True, blank=True)
    wants_features = models.JSONField(default=list)
    message = models.TextField(blank=True)
    status = models.CharField(max_length=20, choices=ACCESS_STATUS_CHOICES, default=ACCESS_PENDING)
    recommended_plan = models.CharField(max_length=10, choices=PLAN_CHOICES, blank=True)
    decided_plan = models.CharField(max_length=10, choices=PLAN_CHOICES, blank=True)
    created_user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.SET_NULL, null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        return self.requester_email


class AITriageLog(models.Model):
    access_request = models.ForeignKey(AccessRequest, on_delete=models.CASCADE, related_name="triage_logs")
    model_name = models.CharField(max_length=100)
    input_payload = models.JSONField()
    output_payload = models.JSONField()
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.access_request.id} - {self.model_name}"

--- FILE: apps/access_requests/serializers.py ---
from rest_framework import serializers

from access_requests.models import AccessRequest, AITriageLog
from utils.constants import ACCESS_APPROVED, ACCESS_REJECTED


class AccessRequestCreateSerializer(serializers.ModelSerializer):
    class Meta:
        model = AccessRequest
        fields = (
            "id",
            "requester_email",
            "requester_name",
            "requester_type",
            "institution_name",
            "estimated_users",
            "wants_features",
            "message",
            "status",
            "recommended_plan",
            "created_at",
        )
        read_only_fields = ("id", "status", "recommended_plan", "created_at")


class AccessRequestSerializer(serializers.ModelSerializer):
    class Meta:
        model = AccessRequest
        fields = "__all__"


class AITriageLogSerializer(serializers.ModelSerializer):
    class Meta:
        model = AITriageLog
        fields = ("id", "model_name", "input_payload", "output_payload", "created_at")
        read_only_fields = fields


class AccessDecisionSerializer(serializers.Serializer):
    decided_plan = serializers.CharField(required=False)

    def validate_decided_plan(self, value):
        if value and value not in {"LITE", "PRO"}:
            raise serializers.ValidationError("Plano invalido")
        return value

--- FILE: apps/access_requests/tests.py ---
from rest_framework.test import APITestCase

from utils.constants import FEATURE_EMAIL_NOTIFICATIONS, PLAN_PRO


class AccessRequestTriageTests(APITestCase):
    def test_triage_recommends_pro(self):
        payload = {
            "requester_email": "inst@example.com",
            "requester_type": "INDIVIDUAL",
            "wants_features": [FEATURE_EMAIL_NOTIFICATIONS],
        }
        response = self.client.post("/api/access/requests/", payload, format="json")
        self.assertEqual(response.status_code, 201)
        self.assertEqual(response.data["recommended_plan"], PLAN_PRO)

--- FILE: apps/access_requests/urls.py ---
from django.urls import path

from access_requests.views import (
    AccessApproveView,
    AccessRejectView,
    AccessRequestDetailView,
    AccessRequestListCreateView,
    AccessTriageLogView,
)

urlpatterns = [
    path("requests/", AccessRequestListCreateView.as_view(), name="access-request-list-create"),
    path("requests/<int:pk>/", AccessRequestDetailView.as_view(), name="access-request-detail"),
    path("requests/<int:pk>/approve/", AccessApproveView.as_view(), name="access-request-approve"),
    path("requests/<int:pk>/reject/", AccessRejectView.as_view(), name="access-request-reject"),
    path("triage/<int:pk>/log/", AccessTriageLogView.as_view(), name="access-triage-log"),
]

--- FILE: apps/access_requests/views.py ---
from django.shortcuts import get_object_or_404
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from access_requests.models import AccessRequest, AITriageLog
from access_requests.serializers import (
    AccessDecisionSerializer,
    AccessRequestCreateSerializer,
    AccessRequestSerializer,
    AITriageLogSerializer,
)
from utils.constants import ACCESS_APPROVED, ACCESS_REJECTED
from utils.triage import TRIAGE_MODEL_NAME, run_triage


class AccessRequestListCreateView(APIView):
    def get_permissions(self):
        if self.request.method == "POST":
            return [permissions.AllowAny()]
        return [permissions.IsAdminUser()]

    def get(self, request):
        requests = AccessRequest.objects.all().order_by("-created_at")
        return Response(AccessRequestSerializer(requests, many=True).data)

    def post(self, request):
        serializer = AccessRequestCreateSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        access_request = serializer.save()
        triage_result = run_triage(access_request)
        recommended_plan = triage_result["recommended_plan"]
        access_request.recommended_plan = recommended_plan
        access_request.save(update_fields=["recommended_plan"])
        input_payload = serializer.validated_data
        output_payload = triage_result["output_payload"]
        AITriageLog.objects.create(
            access_request=access_request,
            model_name=TRIAGE_MODEL_NAME,
            input_payload=input_payload,
            output_payload=output_payload,
        )
        return Response(AccessRequestCreateSerializer(access_request).data, status=status.HTTP_201_CREATED)


class AccessRequestDetailView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def get(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        return Response(AccessRequestSerializer(access_request).data)


class AccessApproveView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def post(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        serializer = AccessDecisionSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        access_request.status = ACCESS_APPROVED
        access_request.decided_plan = serializer.validated_data.get("decided_plan") or access_request.recommended_plan
        access_request.save(update_fields=["status", "decided_plan"])
        return Response(AccessRequestSerializer(access_request).data)


class AccessRejectView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def post(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        access_request.status = ACCESS_REJECTED
        access_request.save(update_fields=["status"])
        return Response(AccessRequestSerializer(access_request).data)


class AccessTriageLogView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def get(self, request, pk):
        access_request = get_object_or_404(AccessRequest, pk=pk)
        log = access_request.triage_logs.order_by("-created_at").first()
        if not log:
            return Response({"detail": "Sem log de triagem."}, status=status.HTTP_404_NOT_FOUND)
        return Response(AITriageLogSerializer(log).data)

--- FILE: apps/accounts/__init__.py ---


--- FILE: apps/accounts/admin.py ---
from django.contrib import admin
from django.contrib.auth.admin import UserAdmin as DjangoUserAdmin

from accounts.models import User


@admin.register(User)
class UserAdmin(DjangoUserAdmin):
    model = User
    ordering = ("email",)
    list_display = ("email", "name", "is_staff", "is_active", "created_at")
    search_fields = ("email", "name")
    fieldsets = (
        (None, {"fields": ("email", "password")}),
        ("Personal info", {"fields": ("name", "phone_number")}),
        ("Permissions", {"fields": ("is_active", "is_staff", "is_superuser", "groups", "user_permissions")}),
        ("Important dates", {"fields": ("last_login",)}),
    )
    add_fieldsets = (
        (
            None,
            {
                "classes": ("wide",),
                "fields": ("email", "name", "password1", "password2", "is_staff", "is_superuser"),
            },
        ),
    )

--- FILE: apps/accounts/apps.py ---
from django.apps import AppConfig


class AccountsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'accounts'

--- FILE: apps/accounts/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.db import migrations, models
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('auth', '0012_alter_user_first_name_max_length'),
    ]

    operations = [
        migrations.CreateModel(
            name='User',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('password', models.CharField(max_length=128, verbose_name='password')),
                ('last_login', models.DateTimeField(blank=True, null=True, verbose_name='last login')),
                ('is_superuser', models.BooleanField(default=False, help_text='Designates that this user has all permissions without explicitly assigning them.', verbose_name='superuser status')),
                ('email', models.EmailField(max_length=254, unique=True)),
                ('name', models.CharField(max_length=255)),
                ('phone_number', models.CharField(blank=True, max_length=30)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('is_active', models.BooleanField(default=True)),
                ('is_staff', models.BooleanField(default=False)),
                ('groups', models.ManyToManyField(blank=True, help_text='The groups this user belongs to. A user will get all permissions granted to each of their groups.', related_name='user_set', related_query_name='user', to='auth.group', verbose_name='groups')),
                ('user_permissions', models.ManyToManyField(blank=True, help_text='Specific permissions for this user.', related_name='user_set', related_query_name='user', to='auth.permission', verbose_name='user permissions')),
            ],
            options={
                'abstract': False,
            },
        ),
    ]

--- FILE: apps/accounts/migrations/__init__.py ---


--- FILE: apps/accounts/models.py ---
from django.contrib.auth.models import AbstractBaseUser, BaseUserManager, PermissionsMixin
from django.db import models
from django.utils import timezone


class UserManager(BaseUserManager):
    def create_user(self, email, password=None, **extra_fields):
        if not email:
            raise ValueError("Email is required")
        email = self.normalize_email(email)
        user = self.model(email=email, **extra_fields)
        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_superuser(self, email, password=None, **extra_fields):
        extra_fields.setdefault("is_staff", True)
        extra_fields.setdefault("is_superuser", True)
        extra_fields.setdefault("is_active", True)
        if not extra_fields.get("is_staff"):
            raise ValueError("Superuser must have is_staff=True")
        if not extra_fields.get("is_superuser"):
            raise ValueError("Superuser must have is_superuser=True")
        return self.create_user(email, password, **extra_fields)


class User(AbstractBaseUser, PermissionsMixin):
    email = models.EmailField(unique=True)
    name = models.CharField(max_length=255)
    phone_number = models.CharField(max_length=30, blank=True)
    created_at = models.DateTimeField(default=timezone.now)

    is_active = models.BooleanField(default=True)
    is_staff = models.BooleanField(default=False)

    objects = UserManager()

    EMAIL_FIELD = "email"
    USERNAME_FIELD = "email"
    REQUIRED_FIELDS = ["name"]

    def __str__(self):
        return self.email

--- FILE: apps/accounts/serializers.py ---
from django.contrib.auth import get_user_model
from rest_framework import serializers

User = get_user_model()


class UserSerializer(serializers.ModelSerializer):
    class Meta:
        model = User
        fields = ("id", "email", "name", "phone_number", "created_at")
        read_only_fields = ("id", "created_at")


class RegisterSerializer(serializers.ModelSerializer):
    password = serializers.CharField(write_only=True, min_length=6)

    class Meta:
        model = User
        fields = ("email", "name", "phone_number", "password")

    def create(self, validated_data):
        password = validated_data.pop("password")
        user = User.objects.create_user(password=password, **validated_data)
        return user

--- FILE: apps/accounts/tests.py ---
from django.urls import reverse
from rest_framework.test import APITestCase


class AuthTests(APITestCase):
    def test_register_and_login(self):
        register_url = "/api/auth/register/"
        payload = {
            "email": "test@example.com",
            "name": "Teste",
            "password": "strongpass123",
        }
        response = self.client.post(register_url, payload, format="json")
        self.assertEqual(response.status_code, 201)
        self.assertIn("access", response.data)

        login_url = "/api/auth/login/"
        login_response = self.client.post(login_url, {"email": payload["email"], "password": payload["password"]})
        self.assertEqual(login_response.status_code, 200)
        self.assertIn("access", login_response.data)

--- FILE: apps/accounts/urls.py ---
from django.urls import path
from rest_framework_simplejwt.views import TokenObtainPairView, TokenRefreshView

from accounts.views import MeView, RegisterView

urlpatterns = [
    path("register/", RegisterView.as_view(), name="auth-register"),
    path("login/", TokenObtainPairView.as_view(), name="auth-login"),
    path("refresh/", TokenRefreshView.as_view(), name="auth-refresh"),
    path("me/", MeView.as_view(), name="auth-me"),
]

--- FILE: apps/accounts/views.py ---
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView
from rest_framework_simplejwt.tokens import RefreshToken

from accounts.serializers import RegisterSerializer, UserSerializer
from billing.models import Plan, UserSubscription
from utils.constants import PLAN_LITE


class RegisterView(APIView):
    permission_classes = [permissions.AllowAny]

    def post(self, request):
        serializer = RegisterSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        user = serializer.save()
        plan = Plan.objects.filter(code=PLAN_LITE, is_active=True).first()
        if plan:
            UserSubscription.objects.get_or_create(user=user, defaults={"plan": plan})
        refresh = RefreshToken.for_user(user)
        return Response(
            {
                "user": UserSerializer(user).data,
                "refresh": str(refresh),
                "access": str(refresh.access_token),
            },
            status=status.HTTP_201_CREATED,
        )


class MeView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        return Response(UserSerializer(request.user).data)

--- FILE: apps/agenda/__init__.py ---


--- FILE: apps/agenda/admin.py ---
from django.contrib import admin

from agenda.models import CalendarEvent, ReminderRule


@admin.register(CalendarEvent)
class CalendarEventAdmin(admin.ModelAdmin):
    list_display = ("title", "user", "event_type", "start_at")
    list_filter = ("event_type",)
    search_fields = ("title", "user__email")


@admin.register(ReminderRule)
class ReminderRuleAdmin(admin.ModelAdmin):
    list_display = ("user", "target_type", "remind_before_minutes", "is_active")
    list_filter = ("target_type", "is_active")

--- FILE: apps/agenda/apps.py ---
from django.apps import AppConfig


class AgendaConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'agenda'

--- FILE: apps/agenda/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('planner', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='ReminderRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('target_type', models.CharField(choices=[('TASK', 'Task'), ('EVENT', 'Event')], max_length=10)),
                ('remind_before_minutes', models.PositiveIntegerField()),
                ('channels', models.JSONField(default=list)),
                ('is_active', models.BooleanField(default=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reminder_rules', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='CalendarEvent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('event_type', models.CharField(choices=[('PROVA', 'Prova'), ('ENTREGA', 'Entrega'), ('APRESENTACAO', 'Apresentacao'), ('AULA_IMPORTANTE', 'Aula importante'), ('OUTRO', 'Outro')], max_length=20)),
                ('start_at', models.DateTimeField()),
                ('end_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('related_task', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='events', to='planner.task')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='events', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/agenda/migrations/__init__.py ---


--- FILE: apps/agenda/models.py ---
from django.conf import settings
from django.db import models

from planner.models import Task
from utils.constants import EVENT_TYPE_CHOICES, REMINDER_TARGET_CHOICES


class CalendarEvent(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="events")
    title = models.CharField(max_length=200)
    event_type = models.CharField(max_length=20, choices=EVENT_TYPE_CHOICES)
    start_at = models.DateTimeField()
    end_at = models.DateTimeField(null=True, blank=True)
    related_task = models.ForeignKey(Task, on_delete=models.SET_NULL, null=True, blank=True, related_name="events")
    notes = models.TextField(blank=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title


class ReminderRule(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="reminder_rules")
    target_type = models.CharField(max_length=10, choices=REMINDER_TARGET_CHOICES)
    remind_before_minutes = models.PositiveIntegerField()
    channels = models.JSONField(default=list)
    is_active = models.BooleanField(default=True)

    def __str__(self):
        return f"{self.user.email} - {self.target_type}"

--- FILE: apps/agenda/serializers.py ---
from rest_framework import serializers

from agenda.models import CalendarEvent, ReminderRule


class CalendarEventSerializer(serializers.ModelSerializer):
    class Meta:
        model = CalendarEvent
        fields = (
            "id",
            "title",
            "event_type",
            "start_at",
            "end_at",
            "related_task",
            "notes",
            "created_at",
        )
        read_only_fields = ("id", "created_at")


class ReminderRuleSerializer(serializers.ModelSerializer):
    class Meta:
        model = ReminderRule
        fields = ("id", "target_type", "remind_before_minutes", "channels", "is_active")
        read_only_fields = ("id",)

--- FILE: apps/agenda/tests.py ---
from datetime import date

from django.contrib.auth import get_user_model
from rest_framework.test import APITestCase
from rest_framework_simplejwt.tokens import RefreshToken

from billing.models import Plan, UserSubscription
from utils.constants import FEATURE_IN_APP_REMINDERS, FEATURE_PLANNER_BASIC, PLAN_LITE

User = get_user_model()


class ReminderGenerationTests(APITestCase):
    def setUp(self):
        self.user = User.objects.create_user(email="agenda@example.com", name="Agenda", password="pass12345")
        plan, _ = Plan.objects.get_or_create(
            code=PLAN_LITE,
            defaults={
                "name": "Lite",
                "features": [FEATURE_PLANNER_BASIC, FEATURE_IN_APP_REMINDERS],
                "is_active": True,
            },
        )
        UserSubscription.objects.create(user=self.user, plan=plan)
        refresh = RefreshToken.for_user(self.user)
        self.client.credentials(HTTP_AUTHORIZATION=f"Bearer {refresh.access_token}")

    def test_task_create_and_generate_reminders(self):
        task_payload = {
            "title": "Trabalho",
            "description": "Entrega final",
            "due_date": date.today().isoformat(),
            "stress_level": 3,
            "status": "TODO",
        }
        task_response = self.client.post("/api/planner/tasks/", task_payload, format="json")
        self.assertEqual(task_response.status_code, 201)

        rule_payload = {
            "target_type": "TASK",
            "remind_before_minutes": 60,
            "channels": ["EMAIL"],
            "is_active": True,
        }
        rule_response = self.client.post("/api/agenda/reminder-rules/", rule_payload, format="json")
        self.assertEqual(rule_response.status_code, 201)

        generate_response = self.client.post("/api/agenda/generate-reminders/", {}, format="json")
        self.assertEqual(generate_response.status_code, 200)
        self.assertIn("created", generate_response.data)

--- FILE: apps/agenda/urls.py ---
from django.urls import path
from rest_framework.routers import DefaultRouter

from agenda.views import CalendarEventViewSet, GenerateRemindersView, AgendaWeekView, ReminderRuleViewSet

router = DefaultRouter()
router.register(r"events", CalendarEventViewSet, basename="events")
router.register(r"reminder-rules", ReminderRuleViewSet, basename="reminder-rules")

urlpatterns = router.urls + [
    path("week/", AgendaWeekView.as_view(), name="agenda-week"),
    path("generate-reminders/", GenerateRemindersView.as_view(), name="agenda-generate-reminders"),
]

--- FILE: apps/agenda/views.py ---
from datetime import datetime, time, timedelta

from django.utils import timezone
from rest_framework import permissions, status, viewsets
from rest_framework.response import Response
from rest_framework.views import APIView

from agenda.models import CalendarEvent, ReminderRule
from agenda.serializers import CalendarEventSerializer, ReminderRuleSerializer
from notifications.models import NotificationQueue
from planner.models import Task
from utils.constants import (
    CHANNEL_EMAIL,
    FEATURE_AGENDA_BASIC,
    FEATURE_IN_APP_REMINDERS,
    NOTIF_PENDING,
    REMINDER_TARGET_EVENT,
    REMINDER_TARGET_TASK,
)
from utils.features import require_feature
from utils.gating import gate_generate_reminders


class CalendarEventViewSet(viewsets.ModelViewSet):
    serializer_class = CalendarEventSerializer
    permission_classes = [permissions.IsAuthenticated]

    def initial(self, request, *args, **kwargs):
        require_feature(request.user, FEATURE_AGENDA_BASIC)
        return super().initial(request, *args, **kwargs)

    def get_queryset(self):
        return CalendarEvent.objects.filter(user=self.request.user).order_by("start_at")

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)


class ReminderRuleViewSet(viewsets.ModelViewSet):
    serializer_class = ReminderRuleSerializer
    permission_classes = [permissions.IsAuthenticated]

    def initial(self, request, *args, **kwargs):
        require_feature(request.user, FEATURE_IN_APP_REMINDERS)
        return super().initial(request, *args, **kwargs)

    def get_queryset(self):
        return ReminderRule.objects.filter(user=self.request.user)

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)


class AgendaWeekView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_AGENDA_BASIC)
        now = timezone.now()
        start_of_week = now - timedelta(days=now.weekday())
        end_of_week = start_of_week + timedelta(days=6)
        events = CalendarEvent.objects.filter(
            user=request.user,
            start_at__date__gte=start_of_week.date(),
            start_at__date__lte=end_of_week.date(),
        ).order_by("start_at")
        return Response(CalendarEventSerializer(events, many=True).data)


class GenerateRemindersView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request):
        require_feature(request.user, FEATURE_IN_APP_REMINDERS)
        allowed, message = gate_generate_reminders(request.user)
        if not allowed:
            return Response({"detail": message}, status=status.HTTP_403_FORBIDDEN)

        now = timezone.now()
        created = 0
        rules = ReminderRule.objects.filter(user=request.user, is_active=True)
        for rule in rules:
            channels = rule.channels or [CHANNEL_EMAIL]
            if rule.target_type == REMINDER_TARGET_EVENT:
                events = CalendarEvent.objects.filter(user=request.user, start_at__gte=now)
                for event in events:
                    scheduled_for = event.start_at - timedelta(minutes=rule.remind_before_minutes)
                    if scheduled_for < now:
                        scheduled_for = now
                    for channel in channels:
                        title = f"Lembrete: {event.title}"
                        exists = NotificationQueue.objects.filter(
                            user=request.user,
                            channel=channel,
                            title=title,
                            scheduled_for=scheduled_for,
                        ).exists()
                        if not exists:
                            NotificationQueue.objects.create(
                                user=request.user,
                                channel=channel,
                                title=title,
                                message=f"Evento {event.title} em {event.start_at}.",
                                scheduled_for=scheduled_for,
                                status=NOTIF_PENDING,
                            )
                            created += 1
            if rule.target_type == REMINDER_TARGET_TASK:
                tasks = Task.objects.filter(user=request.user, due_date__gte=timezone.localdate())
                for task in tasks:
                    due_datetime = datetime.combine(task.due_date, time(9, 0), tzinfo=timezone.get_current_timezone())
                    scheduled_for = due_datetime - timedelta(minutes=rule.remind_before_minutes)
                    if scheduled_for < now:
                        scheduled_for = now
                    for channel in channels:
                        title = f"Lembrete: {task.title}"
                        exists = NotificationQueue.objects.filter(
                            user=request.user,
                            channel=channel,
                            title=title,
                            scheduled_for=scheduled_for,
                        ).exists()
                        if not exists:
                            NotificationQueue.objects.create(
                                user=request.user,
                                channel=channel,
                                title=title,
                                message=f"Tarefa {task.title} vence em {task.due_date}.",
                                scheduled_for=scheduled_for,
                                status=NOTIF_PENDING,
                            )
                            created += 1
        return Response({"created": created})

--- FILE: apps/analytics/__init__.py ---


--- FILE: apps/analytics/admin.py ---
from django.contrib import admin

# No models to register for MVP.

--- FILE: apps/analytics/apps.py ---
from django.apps import AppConfig


class AnalyticsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'analytics'

--- FILE: apps/analytics/management/__init__.py ---


--- FILE: apps/analytics/management/commands/__init__.py ---


--- FILE: apps/analytics/management/commands/seed_demo_data.py ---
from datetime import date, timedelta

from django.core.management.base import BaseCommand
from django.utils import timezone

from agenda.models import CalendarEvent, ReminderRule
from billing.models import Plan, UserSubscription
from content.models import GuidedContent
from mood.models import MoodEntry
from planner.models import Task
from semester.models import Assessment, Course, Semester
from utils.constants import (
    CONTENT_ANTI_PROCRASTINACAO,
    CONTENT_FOCO,
    CONTENT_PRE_PROVA,
    EVENT_ENTREGA,
    EVENT_PROVA,
    MOOD_BAD,
    MOOD_GOOD,
    MOOD_OK,
    MOOD_VERY_GOOD,
    PLAN_LITE,
)
from django.contrib.auth import get_user_model


class Command(BaseCommand):
    help = "Cria dados de exemplo para o MVP"

    def add_arguments(self, parser):
        parser.add_argument("--email", help="Email do usuario para popular dados")

    def handle(self, *args, **options):
        User = get_user_model()
        email = options.get("email")
        if email:
            user = User.objects.filter(email=email).first()
            if not user:
                self.stdout.write(self.style.ERROR("Usuario nao encontrado."))
                return
        else:
            user = User.objects.first()
            if not user:
                self.stdout.write(self.style.ERROR("Nenhum usuario encontrado."))
                return

        plan = Plan.objects.filter(code=PLAN_LITE).first()
        if plan:
            UserSubscription.objects.get_or_create(user=user, defaults={"plan": plan})

        MoodEntry.objects.get_or_create(user=user, mood=MOOD_OK, defaults={"notes": "Inicio do semestre"})
        MoodEntry.objects.get_or_create(user=user, mood=MOOD_GOOD, defaults={"notes": "Boa semana"})
        MoodEntry.objects.get_or_create(user=user, mood=MOOD_BAD, defaults={"notes": "Cansaco"})
        MoodEntry.objects.get_or_create(user=user, mood=MOOD_VERY_GOOD, defaults={"notes": "Semana excelente"})

        Task.objects.get_or_create(
            user=user,
            title="Trabalho final",
            defaults={
                "description": "Entrega da disciplina X",
                "due_date": date.today() + timedelta(days=10),
                "stress_level": 3,
                "status": "TODO",
            },
        )
        Task.objects.get_or_create(
            user=user,
            title="Leitura cap. 3",
            defaults={
                "description": "Revisao para prova",
                "due_date": date.today() + timedelta(days=5),
                "stress_level": 2,
                "status": "DOING",
            },
        )
        Task.objects.get_or_create(
            user=user,
            title="Lista de exercicios",
            defaults={
                "description": "Praticar conteudos de logica",
                "due_date": date.today() + timedelta(days=3),
                "stress_level": 2,
                "status": "TODO",
            },
        )

        semester, _ = Semester.objects.get_or_create(
            user=user,
            name="2026.1",
            defaults={
                "start_date": date.today() - timedelta(days=20),
                "end_date": date.today() + timedelta(days=120),
            },
        )

        course_math, _ = Course.objects.get_or_create(
            semester=semester,
            title="Matematica Discreta",
            defaults={"teacher": "Prof. Silva", "credits": 4},
        )
        course_alg, _ = Course.objects.get_or_create(
            semester=semester,
            title="Algoritmos I",
            defaults={"teacher": "Prof. Souza", "credits": 4},
        )
        course_db, _ = Course.objects.get_or_create(
            semester=semester,
            title="Banco de Dados",
            defaults={"teacher": "Profa. Carla", "credits": 4},
        )

        Assessment.objects.get_or_create(
            course=course_math,
            title="Prova 1",
            defaults={"score": 7.5, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=7)},
        )
        Assessment.objects.get_or_create(
            course=course_math,
            title="Trabalho 1",
            defaults={"score": 8.0, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=14)},
        )
        Assessment.objects.get_or_create(
            course=course_alg,
            title="Trabalho 1",
            defaults={"score": 8.0, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=12)},
        )
        Assessment.objects.get_or_create(
            course=course_db,
            title="Prova 1",
            defaults={"score": 6.5, "max_score": 10, "weight": 1, "date": date.today() + timedelta(days=9)},
        )

        CalendarEvent.objects.get_or_create(
            user=user,
            title="Entrega Trabalho Final",
            defaults={"event_type": EVENT_ENTREGA, "start_at": timezone.now() + timedelta(days=9)},
        )
        CalendarEvent.objects.get_or_create(
            user=user,
            title="Prova Matematica",
            defaults={"event_type": EVENT_PROVA, "start_at": timezone.now() + timedelta(days=7)},
        )
        CalendarEvent.objects.get_or_create(
            user=user,
            title="Prova Banco de Dados",
            defaults={"event_type": EVENT_PROVA, "start_at": timezone.now() + timedelta(days=9)},
        )

        ReminderRule.objects.get_or_create(
            user=user,
            target_type="TASK",
            defaults={"remind_before_minutes": 1440, "channels": ["EMAIL"], "is_active": True},
        )

        GuidedContent.objects.get_or_create(
            title="Respiracao pre-prova",
            defaults={
                "category": CONTENT_PRE_PROVA,
                "duration_minutes": 8,
                "body_text": "Exercicio guiado de respiracao para antes da prova.",
                "is_premium": False,
            },
        )
        GuidedContent.objects.get_or_create(
            title="Anti-procrastinacao em 10 minutos",
            defaults={
                "category": CONTENT_ANTI_PROCRASTINACAO,
                "duration_minutes": 10,
                "body_text": "Passos curtos para iniciar tarefas e manter o ritmo.",
                "is_premium": False,
            },
        )
        GuidedContent.objects.get_or_create(
            title="Foco profundo 25min",
            defaults={
                "category": CONTENT_FOCO,
                "duration_minutes": 25,
                "body_text": "Sessao guiada de foco com pausas conscientes.",
                "is_premium": True,
            },
        )

        self.stdout.write(self.style.SUCCESS("seed_demo_data: ok"))

--- FILE: apps/analytics/migrations/__init__.py ---


--- FILE: apps/analytics/models.py ---
from django.db import models

# Intencionalmente vazio para o MVP.

--- FILE: apps/analytics/tests.py ---


--- FILE: apps/analytics/urls.py ---
from django.urls import path

from analytics.views import DashboardView, SemesterAnalyticsView

urlpatterns = [
    path("dashboard/", DashboardView.as_view(), name="analytics-dashboard"),
    path("semester/<int:semester_id>/", SemesterAnalyticsView.as_view(), name="analytics-semester"),
]

--- FILE: apps/analytics/views.py ---
from django.shortcuts import get_object_or_404
from django.utils import timezone
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from agenda.models import CalendarEvent
from mood.models import MoodEntry
from planner.models import Task
from semester.models import Semester
from utils.constants import FEATURE_DASHBOARD_BASIC, FEATURE_REPORTS_ADVANCED, SEMESTER_ACTIVE
from utils.features import has_feature, require_feature


class DashboardView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_DASHBOARD_BASIC)
        now = timezone.now()
        tasks = Task.objects.filter(user=request.user)
        events = CalendarEvent.objects.filter(user=request.user, start_at__gte=now)
        moods = MoodEntry.objects.filter(user=request.user)
        active_semester = Semester.objects.filter(user=request.user, status=SEMESTER_ACTIVE).first()
        return Response(
            {
                "tasks": {
                    "todo": tasks.filter(status="TODO").count(),
                    "doing": tasks.filter(status="DOING").count(),
                    "done": tasks.filter(status="DONE").count(),
                },
                "upcoming_events": events.count(),
                "mood_entries": moods.count(),
                "active_semester": active_semester.name if active_semester else None,
            }
        )


class SemesterAnalyticsView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request, semester_id):
        if not has_feature(request.user, FEATURE_REPORTS_ADVANCED):
            return Response({"detail": "Plano atual nao permite analytics avancado."}, status=status.HTTP_403_FORBIDDEN)
        semester = get_object_or_404(Semester, pk=semester_id, user=request.user)
        courses = semester.courses.all()
        return Response(
            {
                "semester": semester.name,
                "courses": [
                    {
                        "title": course.title,
                        "status": course.status,
                        "final_grade": course.final_grade,
                    }
                    for course in courses
                ],
            }
        )

--- FILE: apps/billing/__init__.py ---


--- FILE: apps/billing/admin.py ---
from django.contrib import admin

from billing.models import Plan, UserSubscription


@admin.register(Plan)
class PlanAdmin(admin.ModelAdmin):
    list_display = ("code", "name", "is_active")
    list_filter = ("is_active",)


@admin.register(UserSubscription)
class UserSubscriptionAdmin(admin.ModelAdmin):
    list_display = ("user", "plan", "is_active", "started_at")
    list_filter = ("is_active", "plan")

--- FILE: apps/billing/apps.py ---
from django.apps import AppConfig
from django.db.models.signals import post_migrate


class BillingConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'billing'

    def ready(self):
        from billing.signals import seed_plans

        post_migrate.connect(seed_plans, sender=self)

--- FILE: apps/billing/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Plan',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(choices=[('LITE', 'Lite'), ('PRO', 'Pro')], max_length=10, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True)),
                ('features', models.JSONField(default=list)),
                ('is_active', models.BooleanField(default=True)),
            ],
        ),
        migrations.CreateModel(
            name='UserSubscription',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('is_active', models.BooleanField(default=True)),
                ('plan', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='billing.plan')),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='subscription', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/billing/migrations/__init__.py ---


--- FILE: apps/billing/models.py ---
from django.conf import settings
from django.db import models

from utils.constants import PLAN_CHOICES, PLAN_LITE


class Plan(models.Model):
    code = models.CharField(max_length=10, choices=PLAN_CHOICES, unique=True)
    name = models.CharField(max_length=100)
    description = models.TextField(blank=True)
    features = models.JSONField(default=list)
    is_active = models.BooleanField(default=True)

    def __str__(self):
        return f"{self.code}"

    @staticmethod
    def default_lite_features():
        return [
            "MOOD_BASIC",
            "POMODORO_BASIC",
            "PLANNER_BASIC",
            "AGENDA_BASIC",
            "IN_APP_REMINDERS",
            "DASHBOARD_BASIC",
            "CONTENT_LIMITED",
        ]

    @staticmethod
    def default_pro_features():
        return Plan.default_lite_features() + [
            "EMAIL_NOTIFICATIONS",
            "REPORTS_ADVANCED",
            "SEMESTER_SUMMARY",
            "COACH_ADVANCED",
            "CONTENT_FULL",
        ]


class UserSubscription(models.Model):
    user = models.OneToOneField(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="subscription")
    plan = models.ForeignKey(Plan, on_delete=models.PROTECT)
    started_at = models.DateTimeField(auto_now_add=True)
    is_active = models.BooleanField(default=True)

    def __str__(self):
        return f"{self.user.email} -> {self.plan.code if self.plan else PLAN_LITE}"

--- FILE: apps/billing/serializers.py ---
from rest_framework import serializers

from billing.models import Plan, UserSubscription


class PlanSerializer(serializers.ModelSerializer):
    class Meta:
        model = Plan
        fields = ("code", "name", "description", "features")


class UserSubscriptionSerializer(serializers.ModelSerializer):
    plan = PlanSerializer()

    class Meta:
        model = UserSubscription
        fields = ("plan", "started_at", "is_active")


class SetPlanSerializer(serializers.Serializer):
    user_id = serializers.IntegerField()
    plan_code = serializers.CharField()

--- FILE: apps/billing/signals.py ---
from django.db import transaction

from billing.models import Plan
from utils.constants import (
    FEATURE_AGENDA_BASIC,
    FEATURE_COACH_ADVANCED,
    FEATURE_CONTENT_FULL,
    FEATURE_CONTENT_LIMITED,
    FEATURE_DASHBOARD_BASIC,
    FEATURE_EMAIL_NOTIFICATIONS,
    FEATURE_IN_APP_REMINDERS,
    FEATURE_MOOD_BASIC,
    FEATURE_PLANNER_BASIC,
    FEATURE_POMODORO_BASIC,
    FEATURE_REPORTS_ADVANCED,
    FEATURE_SEMESTER_SUMMARY,
    PLAN_LITE,
    PLAN_PRO,
)


def seed_plans(sender, **kwargs):
    with transaction.atomic():
        Plan.objects.get_or_create(
            code=PLAN_LITE,
            defaults={
                "name": "Lite",
                "description": "Plano basico para organizacao e bem-estar.",
                "features": [
                    FEATURE_MOOD_BASIC,
                    FEATURE_POMODORO_BASIC,
                    FEATURE_PLANNER_BASIC,
                    FEATURE_AGENDA_BASIC,
                    FEATURE_IN_APP_REMINDERS,
                    FEATURE_DASHBOARD_BASIC,
                    FEATURE_CONTENT_LIMITED,
                ],
                "is_active": True,
            },
        )
        Plan.objects.get_or_create(
            code=PLAN_PRO,
            defaults={
                "name": "Pro",
                "description": "Plano completo com notificacoes e relatorios.",
                "features": [
                    FEATURE_MOOD_BASIC,
                    FEATURE_POMODORO_BASIC,
                    FEATURE_PLANNER_BASIC,
                    FEATURE_AGENDA_BASIC,
                    FEATURE_IN_APP_REMINDERS,
                    FEATURE_DASHBOARD_BASIC,
                    FEATURE_CONTENT_LIMITED,
                    FEATURE_EMAIL_NOTIFICATIONS,
                    FEATURE_REPORTS_ADVANCED,
                    FEATURE_SEMESTER_SUMMARY,
                    FEATURE_COACH_ADVANCED,
                    FEATURE_CONTENT_FULL,
                ],
                "is_active": True,
            },
        )

--- FILE: apps/billing/tests.py ---


--- FILE: apps/billing/urls.py ---
from django.urls import path

from billing.views import CurrentPlanView, SetPlanView

urlpatterns = [
    path("plan/", CurrentPlanView.as_view(), name="billing-plan"),
    path("set-plan/", SetPlanView.as_view(), name="billing-set-plan"),
]

--- FILE: apps/billing/views.py ---
from django.contrib.auth import get_user_model
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from billing.models import Plan, UserSubscription
from billing.serializers import PlanSerializer, SetPlanSerializer, UserSubscriptionSerializer
from utils.constants import PLAN_LITE

User = get_user_model()


class CurrentPlanView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        subscription = UserSubscription.objects.filter(user=request.user, is_active=True).select_related("plan").first()
        if subscription:
            return Response(UserSubscriptionSerializer(subscription).data)
        plan = Plan.objects.filter(code=PLAN_LITE, is_active=True).first()
        if not plan:
            return Response({"detail": "Plano nao configurado."}, status=status.HTTP_404_NOT_FOUND)
        return Response({"plan": PlanSerializer(plan).data, "started_at": None, "is_active": False})


class SetPlanView(APIView):
    permission_classes = [permissions.IsAdminUser]

    def post(self, request):
        serializer = SetPlanSerializer(data=request.data)
        serializer.is_valid(raise_exception=True)
        user = User.objects.get(id=serializer.validated_data["user_id"])
        plan = Plan.objects.get(code=serializer.validated_data["plan_code"])
        subscription, _ = UserSubscription.objects.get_or_create(user=user, defaults={"plan": plan})
        subscription.plan = plan
        subscription.is_active = True
        subscription.save()
        return Response(UserSubscriptionSerializer(subscription).data)

--- FILE: apps/coach_ai/__init__.py ---


--- FILE: apps/coach_ai/admin.py ---
from django.contrib import admin

from coach_ai.models import CoachLog


@admin.register(CoachLog)
class CoachLogAdmin(admin.ModelAdmin):
    list_display = ("user", "trigger_type", "created_at")
    list_filter = ("trigger_type",)

--- FILE: apps/coach_ai/apps.py ---
from django.apps import AppConfig


class CoachAiConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'coach_ai'

--- FILE: apps/coach_ai/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='CoachLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('trigger_type', models.CharField(choices=[('PRAZO_PROXIMO', 'Prazo proximo'), ('ATRASO', 'Atraso'), ('HUMOR_BAIXO', 'Humor baixo'), ('SEMESTRE_CONCLUIDO', 'Semestre concluido'), ('REPROVACAO', 'Reprovacao')], max_length=30)),
                ('suggestion_text', models.TextField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='coach_logs', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/coach_ai/migrations/__init__.py ---


--- FILE: apps/coach_ai/models.py ---
from django.conf import settings
from django.db import models

from utils.constants import COACH_TRIGGER_CHOICES


class CoachLog(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="coach_logs")
    trigger_type = models.CharField(max_length=30, choices=COACH_TRIGGER_CHOICES)
    suggestion_text = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.user.email} - {self.trigger_type}"

--- FILE: apps/coach_ai/tests.py ---


--- FILE: apps/coach_ai/views.py ---


--- FILE: apps/content/__init__.py ---


--- FILE: apps/content/admin.py ---
from django.contrib import admin

from content.models import GuidedContent


@admin.register(GuidedContent)
class GuidedContentAdmin(admin.ModelAdmin):
    list_display = ("title", "category", "duration_minutes", "is_premium")
    list_filter = ("category", "is_premium")

--- FILE: apps/content/apps.py ---
from django.apps import AppConfig


class ContentConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'content'

--- FILE: apps/content/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='GuidedContent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('category', models.CharField(choices=[('PRE_PROVA', 'Pre-prova'), ('ANTI_PROCRASTINACAO', 'Anti-procrastinacao'), ('FOCO', 'Foco')], max_length=50)),
                ('duration_minutes', models.PositiveIntegerField()),
                ('body_text', models.TextField()),
                ('is_premium', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
        ),
    ]

--- FILE: apps/content/migrations/__init__.py ---


--- FILE: apps/content/models.py ---
from django.db import models

from utils.constants import CONTENT_CATEGORY_CHOICES


class GuidedContent(models.Model):
    title = models.CharField(max_length=200)
    category = models.CharField(max_length=50, choices=CONTENT_CATEGORY_CHOICES)
    duration_minutes = models.PositiveIntegerField()
    body_text = models.TextField()
    is_premium = models.BooleanField(default=False)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title

--- FILE: apps/content/serializers.py ---
from rest_framework import serializers

from content.models import GuidedContent


class GuidedContentSerializer(serializers.ModelSerializer):
    class Meta:
        model = GuidedContent
        fields = ("id", "title", "category", "duration_minutes", "body_text", "is_premium", "created_at")
        read_only_fields = ("id", "created_at")

--- FILE: apps/content/tests.py ---


--- FILE: apps/content/urls.py ---
from django.urls import path

from content.views import GuidedContentDetailView, GuidedContentListView

urlpatterns = [
    path("guided/", GuidedContentListView.as_view(), name="guided-content"),
    path("guided/<int:pk>/", GuidedContentDetailView.as_view(), name="guided-content-detail"),
]

--- FILE: apps/content/views.py ---
from django.shortcuts import get_object_or_404
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from content.models import GuidedContent
from content.serializers import GuidedContentSerializer
from utils.constants import FEATURE_CONTENT_FULL, FEATURE_CONTENT_LIMITED
from utils.features import has_feature


class GuidedContentListView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        if not has_feature(request.user, FEATURE_CONTENT_FULL) and not has_feature(request.user, FEATURE_CONTENT_LIMITED):
            return Response({"detail": "Plano atual nao permite conteudos."}, status=status.HTTP_403_FORBIDDEN)
        queryset = GuidedContent.objects.all().order_by("-created_at")
        if not has_feature(request.user, FEATURE_CONTENT_FULL):
            queryset = queryset.filter(is_premium=False)
        return Response(GuidedContentSerializer(queryset, many=True).data)


class GuidedContentDetailView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request, pk):
        content = get_object_or_404(GuidedContent, pk=pk)
        if content.is_premium and not has_feature(request.user, FEATURE_CONTENT_FULL):
            return Response({"detail": "Plano atual nao permite este conteudo."}, status=status.HTTP_403_FORBIDDEN)
        return Response(GuidedContentSerializer(content).data)

--- FILE: apps/mood/__init__.py ---


--- FILE: apps/mood/admin.py ---
from django.contrib import admin

from mood.models import MoodEntry


@admin.register(MoodEntry)
class MoodEntryAdmin(admin.ModelAdmin):
    list_display = ("user", "mood", "created_at")
    list_filter = ("mood",)
    search_fields = ("user__email",)

--- FILE: apps/mood/apps.py ---
from django.apps import AppConfig


class MoodConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'mood'

--- FILE: apps/mood/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='MoodEntry',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('mood', models.CharField(choices=[('VERY_BAD', 'Very bad'), ('BAD', 'Bad'), ('OK', 'Ok'), ('GOOD', 'Good'), ('VERY_GOOD', 'Very good')], max_length=20)),
                ('notes', models.TextField(blank=True)),
                ('tags', models.JSONField(default=list)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='mood_entries', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/mood/migrations/__init__.py ---


--- FILE: apps/mood/models.py ---
from django.conf import settings
from django.db import models

from utils.constants import MOOD_CHOICES


class MoodEntry(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="mood_entries")
    mood = models.CharField(max_length=20, choices=MOOD_CHOICES)
    notes = models.TextField(blank=True)
    tags = models.JSONField(default=list)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.user.email} - {self.mood}"

--- FILE: apps/mood/serializers.py ---
from rest_framework import serializers

from mood.models import MoodEntry


class MoodEntrySerializer(serializers.ModelSerializer):
    class Meta:
        model = MoodEntry
        fields = ("id", "mood", "notes", "tags", "created_at")
        read_only_fields = ("id", "created_at")

--- FILE: apps/mood/tests.py ---
from django.contrib.auth import get_user_model
from rest_framework.test import APITestCase
from rest_framework_simplejwt.tokens import RefreshToken

from billing.models import Plan, UserSubscription
from utils.constants import FEATURE_MOOD_BASIC, PLAN_LITE

User = get_user_model()


class MoodEntryTests(APITestCase):
    def setUp(self):
        self.user = User.objects.create_user(email="mood@example.com", name="Mood", password="pass12345")
        plan, _ = Plan.objects.get_or_create(
            code=PLAN_LITE, defaults={"name": "Lite", "features": [FEATURE_MOOD_BASIC], "is_active": True}
        )
        UserSubscription.objects.create(user=self.user, plan=plan)
        refresh = RefreshToken.for_user(self.user)
        self.client.credentials(HTTP_AUTHORIZATION=f"Bearer {refresh.access_token}")

    def test_create_mood_entry(self):
        response = self.client.post("/api/mood/entries/", {"mood": "OK", "notes": "Tudo bem"}, format="json")
        self.assertEqual(response.status_code, 201)

--- FILE: apps/mood/urls.py ---
from django.urls import path

from mood.views import MoodEntryListCreateView, MoodWeeklySummaryView

urlpatterns = [
    path("entries/", MoodEntryListCreateView.as_view(), name="mood-entries"),
    path("summary/weekly/", MoodWeeklySummaryView.as_view(), name="mood-summary-weekly"),
]

--- FILE: apps/mood/views.py ---
from datetime import timedelta

from django.utils import timezone
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView
from rest_framework.generics import ListCreateAPIView

from mood.models import MoodEntry
from mood.serializers import MoodEntrySerializer
from utils.constants import FEATURE_MOOD_BASIC, MOOD_VERY_BAD
from utils.features import require_feature


class MoodEntryListCreateView(ListCreateAPIView):
    serializer_class = MoodEntrySerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        require_feature(self.request.user, FEATURE_MOOD_BASIC)
        return MoodEntry.objects.filter(user=self.request.user).order_by("-created_at")

    def perform_create(self, serializer):
        require_feature(self.request.user, FEATURE_MOOD_BASIC)
        serializer.save(user=self.request.user)

    def create(self, request, *args, **kwargs):
        response = super().create(request, *args, **kwargs)
        week_ago = timezone.now() - timedelta(days=7)
        very_bad_count = MoodEntry.objects.filter(
            user=request.user, mood=MOOD_VERY_BAD, created_at__gte=week_ago
        ).count()
        if very_bad_count >= 3:
            response.data["wellness_notice"] = (
                "Percebemos humor muito baixo recorrente. Procure apoio profissional."
                " No Brasil, o CVV atende 188 (24h)."
            )
        return response


class MoodWeeklySummaryView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_MOOD_BASIC)
        week_ago = timezone.now() - timedelta(days=7)
        entries = MoodEntry.objects.filter(user=request.user, created_at__gte=week_ago)
        summary = {}
        for mood, _label in MoodEntry._meta.get_field("mood").choices:
            summary[mood] = entries.filter(mood=mood).count()
        return Response({"summary": summary})

--- FILE: apps/notifications/__init__.py ---


--- FILE: apps/notifications/admin.py ---
from django.contrib import admin

from notifications.models import NotificationQueue


@admin.register(NotificationQueue)
class NotificationQueueAdmin(admin.ModelAdmin):
    list_display = ("user", "channel", "status", "scheduled_for")
    list_filter = ("channel", "status")

--- FILE: apps/notifications/apps.py ---
from django.apps import AppConfig


class NotificationsConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'notifications'

--- FILE: apps/notifications/management/__init__.py ---


--- FILE: apps/notifications/management/commands/__init__.py ---


--- FILE: apps/notifications/management/commands/process_notification_queue.py ---
from django.core.management.base import BaseCommand
from django.core.mail import send_mail
from django.utils import timezone

from notifications.models import NotificationQueue
from utils.constants import CHANNEL_EMAIL, CHANNEL_SMS, CHANNEL_WHATSAPP, NOTIF_FAILED, NOTIF_PENDING, NOTIF_SENT


class Command(BaseCommand):
    help = "Processa a fila de notificacoes pendentes."

    def handle(self, *args, **options):
        now = timezone.now()
        pending = NotificationQueue.objects.filter(status=NOTIF_PENDING, scheduled_for__lte=now)
        for notification in pending:
            try:
                if notification.channel == CHANNEL_EMAIL:
                    send_mail(notification.title, notification.message, None, [notification.user.email])
                elif notification.channel in {CHANNEL_WHATSAPP, CHANNEL_SMS}:
                    # Mock para MVP.
                    pass
                notification.status = NOTIF_SENT
                notification.save()
                self.stdout.write(self.style.SUCCESS(f"Enviado: {notification.id}"))
            except Exception:
                notification.status = NOTIF_FAILED
                notification.save()
                self.stdout.write(self.style.ERROR(f"Falhou: {notification.id}"))

--- FILE: apps/notifications/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='NotificationQueue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('channel', models.CharField(choices=[('EMAIL', 'Email'), ('WHATSAPP', 'WhatsApp'), ('SMS', 'SMS')], max_length=20)),
                ('title', models.CharField(max_length=200)),
                ('message', models.TextField()),
                ('scheduled_for', models.DateTimeField()),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('SENT', 'Sent'), ('FAILED', 'Failed')], default='PENDING', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='notifications', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/notifications/migrations/__init__.py ---


--- FILE: apps/notifications/models.py ---
from django.conf import settings
from django.db import models

from utils.constants import CHANNEL_CHOICES, NOTIFICATION_STATUS_CHOICES, NOTIF_PENDING


class NotificationQueue(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="notifications")
    channel = models.CharField(max_length=20, choices=CHANNEL_CHOICES)
    title = models.CharField(max_length=200)
    message = models.TextField()
    scheduled_for = models.DateTimeField()
    status = models.CharField(max_length=20, choices=NOTIFICATION_STATUS_CHOICES, default=NOTIF_PENDING)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"{self.user.email} - {self.channel}"

--- FILE: apps/notifications/serializers.py ---
from rest_framework import serializers

from notifications.models import NotificationQueue


class NotificationQueueSerializer(serializers.ModelSerializer):
    class Meta:
        model = NotificationQueue
        fields = (
            "id",
            "channel",
            "title",
            "message",
            "scheduled_for",
            "status",
            "created_at",
        )
        read_only_fields = ("id", "created_at")

--- FILE: apps/notifications/tests.py ---


--- FILE: apps/notifications/urls.py ---
from django.urls import path

from notifications.views import PendingNotificationsView, TestEmailView

urlpatterns = [
    path("test-email/", TestEmailView.as_view(), name="notifications-test-email"),
    path("pending/", PendingNotificationsView.as_view(), name="notifications-pending"),
]

--- FILE: apps/notifications/views.py ---
from django.core.mail import send_mail
from django.utils import timezone
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from notifications.models import NotificationQueue
from notifications.serializers import NotificationQueueSerializer
from utils.constants import CHANNEL_EMAIL, NOTIF_PENDING
from utils.features import has_feature
from utils.constants import FEATURE_EMAIL_NOTIFICATIONS


class TestEmailView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request):
        if not has_feature(request.user, FEATURE_EMAIL_NOTIFICATIONS):
            return Response({"detail": "Plano atual nao permite email."}, status=status.HTTP_403_FORBIDDEN)
        subject = "Campus Calm - Teste de Email"
        message = "Este e um email de teste do Campus Calm."
        send_mail(subject, message, None, [request.user.email])
        return Response({"detail": "Email enviado para console."})


class PendingNotificationsView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        now = timezone.now()
        pending = NotificationQueue.objects.filter(
            user=request.user, status=NOTIF_PENDING, scheduled_for__lte=now
        ).order_by("scheduled_for")
        return Response(NotificationQueueSerializer(pending, many=True).data)

--- FILE: apps/onboarding/__init__.py ---


--- FILE: apps/onboarding/admin.py ---
from django.contrib import admin

from onboarding.models import UserSetupProgress


@admin.register(UserSetupProgress)
class UserSetupProgressAdmin(admin.ModelAdmin):
    list_display = ("user", "has_profile", "has_active_semester", "has_at_least_one_course", "has_at_least_one_assessment", "has_reminder_rule")

--- FILE: apps/onboarding/apps.py ---
from django.apps import AppConfig


class OnboardingConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'onboarding'

    def ready(self):
        from onboarding import signals  # noqa: F401

--- FILE: apps/onboarding/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='UserSetupProgress',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('has_profile', models.BooleanField(default=False)),
                ('has_active_semester', models.BooleanField(default=False)),
                ('has_at_least_one_course', models.BooleanField(default=False)),
                ('has_at_least_one_assessment', models.BooleanField(default=False)),
                ('has_reminder_rule', models.BooleanField(default=False)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='setup_progress', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/onboarding/migrations/__init__.py ---


--- FILE: apps/onboarding/models.py ---
from django.conf import settings
from django.db import models


class UserSetupProgress(models.Model):
    user = models.OneToOneField(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="setup_progress")
    has_profile = models.BooleanField(default=False)
    has_active_semester = models.BooleanField(default=False)
    has_at_least_one_course = models.BooleanField(default=False)
    has_at_least_one_assessment = models.BooleanField(default=False)
    has_reminder_rule = models.BooleanField(default=False)
    updated_at = models.DateTimeField(auto_now=True)

    def __str__(self):
        return self.user.email

--- FILE: apps/onboarding/services.py ---
from semester.models import Assessment, Course, Semester
from agenda.models import ReminderRule
from onboarding.models import UserSetupProgress
from utils.constants import SEMESTER_ACTIVE


def refresh_user_progress(user):
    progress, _ = UserSetupProgress.objects.get_or_create(user=user)
    progress.has_profile = bool(user.name)
    progress.has_active_semester = Semester.objects.filter(user=user, status=SEMESTER_ACTIVE).exists()
    progress.has_at_least_one_course = Course.objects.filter(semester__user=user).exists()
    progress.has_at_least_one_assessment = Assessment.objects.filter(course__semester__user=user).exists()
    progress.has_reminder_rule = ReminderRule.objects.filter(user=user, is_active=True).exists()
    progress.save()
    return progress

--- FILE: apps/onboarding/signals.py ---
from django.db.models.signals import post_delete, post_save
from django.dispatch import receiver

from accounts.models import User
from agenda.models import ReminderRule
from onboarding.services import refresh_user_progress
from semester.models import Assessment, Course, Semester


@receiver(post_save, sender=User)
def user_saved(sender, instance, **kwargs):
    refresh_user_progress(instance)


@receiver(post_save, sender=Semester)
@receiver(post_delete, sender=Semester)
def semester_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.user)


@receiver(post_save, sender=Course)
@receiver(post_delete, sender=Course)
def course_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.semester.user)


@receiver(post_save, sender=Assessment)
@receiver(post_delete, sender=Assessment)
def assessment_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.course.semester.user)


@receiver(post_save, sender=ReminderRule)
@receiver(post_delete, sender=ReminderRule)
def reminder_changed(sender, instance, **kwargs):
    refresh_user_progress(instance.user)

--- FILE: apps/onboarding/tests.py ---


--- FILE: apps/onboarding/urls.py ---
from django.urls import path

from onboarding.views import OnboardingStatusView

urlpatterns = [
    path("status/", OnboardingStatusView.as_view(), name="onboarding-status"),
]

--- FILE: apps/onboarding/views.py ---
from rest_framework import permissions
from rest_framework.response import Response
from rest_framework.views import APIView

from onboarding.services import refresh_user_progress
from utils.gating import compute_status


class OnboardingStatusView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        progress = refresh_user_progress(request.user)
        current_step, missing_steps, required_actions = compute_status(progress)
        return Response(
            {
                "current_step": current_step,
                "missing_steps": missing_steps,
                "required_actions": required_actions,
            }
        )

--- FILE: apps/planner/__init__.py ---


--- FILE: apps/planner/admin.py ---
from django.contrib import admin

from planner.models import Task


@admin.register(Task)
class TaskAdmin(admin.ModelAdmin):
    list_display = ("title", "user", "due_date", "status")
    list_filter = ("status",)
    search_fields = ("title", "user__email")

--- FILE: apps/planner/apps.py ---
from django.apps import AppConfig


class PlannerConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'planner'

--- FILE: apps/planner/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Task',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField(blank=True)),
                ('due_date', models.DateField()),
                ('stress_level', models.PositiveSmallIntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('status', models.CharField(choices=[('TODO', 'Todo'), ('DOING', 'Doing'), ('DONE', 'Done')], default='TODO', max_length=10)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/planner/migrations/__init__.py ---


--- FILE: apps/planner/models.py ---
from django.conf import settings
from django.core.validators import MaxValueValidator, MinValueValidator
from django.db import models

from utils.constants import TASK_STATUS_CHOICES, TASK_TODO


class Task(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="tasks")
    title = models.CharField(max_length=200)
    description = models.TextField(blank=True)
    due_date = models.DateField()
    stress_level = models.PositiveSmallIntegerField(validators=[MinValueValidator(1), MaxValueValidator(5)])
    status = models.CharField(max_length=10, choices=TASK_STATUS_CHOICES, default=TASK_TODO)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title

--- FILE: apps/planner/serializers.py ---
from rest_framework import serializers

from planner.models import Task


class TaskSerializer(serializers.ModelSerializer):
    class Meta:
        model = Task
        fields = (
            "id",
            "title",
            "description",
            "due_date",
            "stress_level",
            "status",
            "created_at",
        )
        read_only_fields = ("id", "created_at")

--- FILE: apps/planner/tests.py ---


--- FILE: apps/planner/urls.py ---
from rest_framework.routers import DefaultRouter

from planner.views import TaskViewSet

router = DefaultRouter()
router.register(r"tasks", TaskViewSet, basename="tasks")

urlpatterns = router.urls

--- FILE: apps/planner/views.py ---
from rest_framework import permissions, viewsets

from planner.models import Task
from planner.serializers import TaskSerializer
from utils.constants import FEATURE_PLANNER_BASIC
from utils.features import require_feature


class TaskViewSet(viewsets.ModelViewSet):
    serializer_class = TaskSerializer
    permission_classes = [permissions.IsAuthenticated]

    def initial(self, request, *args, **kwargs):
        require_feature(request.user, FEATURE_PLANNER_BASIC)
        return super().initial(request, *args, **kwargs)

    def get_queryset(self):
        return Task.objects.filter(user=self.request.user).order_by("-created_at")

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)

--- FILE: apps/pomodoro/__init__.py ---


--- FILE: apps/pomodoro/admin.py ---
from django.contrib import admin

from pomodoro.models import PomodoroSession


@admin.register(PomodoroSession)
class PomodoroSessionAdmin(admin.ModelAdmin):
    list_display = ("user", "status", "started_at", "ended_at")
    list_filter = ("status",)

--- FILE: apps/pomodoro/apps.py ---
from django.apps import AppConfig


class PomodoroConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'pomodoro'

--- FILE: apps/pomodoro/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion
import django.utils.timezone


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='PomodoroSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('focus_minutes', models.PositiveIntegerField(default=25)),
                ('break_minutes', models.PositiveIntegerField(default=5)),
                ('started_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('ended_at', models.DateTimeField(blank=True, null=True)),
                ('status', models.CharField(choices=[('COMPLETED', 'Completed'), ('STOPPED', 'Stopped')], default='STOPPED', max_length=20)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='pomodoro_sessions', to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]

--- FILE: apps/pomodoro/migrations/__init__.py ---


--- FILE: apps/pomodoro/models.py ---
from django.conf import settings
from django.db import models
from django.utils import timezone

from utils.constants import POMODORO_STATUS_CHOICES, POMODORO_STOPPED


class PomodoroSession(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="pomodoro_sessions")
    focus_minutes = models.PositiveIntegerField(default=25)
    break_minutes = models.PositiveIntegerField(default=5)
    started_at = models.DateTimeField(default=timezone.now)
    ended_at = models.DateTimeField(null=True, blank=True)
    status = models.CharField(max_length=20, choices=POMODORO_STATUS_CHOICES, default=POMODORO_STOPPED)

    def __str__(self):
        return f"{self.user.email} - {self.status}"

--- FILE: apps/pomodoro/serializers.py ---
from rest_framework import serializers

from pomodoro.models import PomodoroSession


class PomodoroSessionSerializer(serializers.ModelSerializer):
    class Meta:
        model = PomodoroSession
        fields = (
            "id",
            "focus_minutes",
            "break_minutes",
            "started_at",
            "ended_at",
            "status",
        )
        read_only_fields = ("id", "started_at", "ended_at", "status")

--- FILE: apps/pomodoro/tests.py ---


--- FILE: apps/pomodoro/urls.py ---
from django.urls import path

from pomodoro.views import PomodoroStartView, PomodoroStopView, PomodoroWeeklySummaryView

urlpatterns = [
    path("start/", PomodoroStartView.as_view(), name="pomodoro-start"),
    path("stop/<int:pk>/", PomodoroStopView.as_view(), name="pomodoro-stop"),
    path("summary/weekly/", PomodoroWeeklySummaryView.as_view(), name="pomodoro-summary-weekly"),
]

--- FILE: apps/pomodoro/views.py ---
from datetime import timedelta

from django.utils import timezone
from rest_framework import permissions, status
from rest_framework.response import Response
from rest_framework.views import APIView

from pomodoro.models import PomodoroSession
from pomodoro.serializers import PomodoroSessionSerializer
from utils.constants import FEATURE_POMODORO_BASIC, POMODORO_COMPLETED, POMODORO_STOPPED
from utils.features import require_feature


class PomodoroStartView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request):
        require_feature(request.user, FEATURE_POMODORO_BASIC)
        focus_minutes = int(request.data.get("focus_minutes", 25))
        break_minutes = int(request.data.get("break_minutes", 5))
        session = PomodoroSession.objects.create(
            user=request.user,
            focus_minutes=focus_minutes,
            break_minutes=break_minutes,
        )
        return Response(PomodoroSessionSerializer(session).data, status=status.HTTP_201_CREATED)


class PomodoroStopView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request, pk):
        require_feature(request.user, FEATURE_POMODORO_BASIC)
        session = PomodoroSession.objects.get(pk=pk, user=request.user)
        completed_value = request.data.get("completed", False)
        completed = str(completed_value).lower() in {"1", "true", "yes", "on"}
        session.ended_at = timezone.now()
        session.status = POMODORO_COMPLETED if completed else POMODORO_STOPPED
        session.save()
        return Response(PomodoroSessionSerializer(session).data)


class PomodoroWeeklySummaryView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request):
        require_feature(request.user, FEATURE_POMODORO_BASIC)
        week_ago = timezone.now() - timedelta(days=7)
        sessions = PomodoroSession.objects.filter(user=request.user, started_at__gte=week_ago)
        total_sessions = sessions.count()
        total_focus_minutes = sum(session.focus_minutes for session in sessions)
        return Response(
            {
                "total_sessions": total_sessions,
                "total_focus_minutes": total_focus_minutes,
            }
        )

--- FILE: apps/semester/__init__.py ---


--- FILE: apps/semester/admin.py ---
from django.contrib import admin

from semester.models import Assessment, Course, Semester, SemesterCheckin


@admin.register(Semester)
class SemesterAdmin(admin.ModelAdmin):
    list_display = ("name", "user", "status", "start_date", "end_date")
    list_filter = ("status",)


@admin.register(Course)
class CourseAdmin(admin.ModelAdmin):
    list_display = ("title", "semester", "status", "passing_grade", "final_grade")
    list_filter = ("status",)


@admin.register(Assessment)
class AssessmentAdmin(admin.ModelAdmin):
    list_display = ("title", "course", "score", "max_score", "weight")


@admin.register(SemesterCheckin)
class SemesterCheckinAdmin(admin.ModelAdmin):
    list_display = ("semester", "overall_stress", "created_at")

--- FILE: apps/semester/apps.py ---
from django.apps import AppConfig


class SemesterConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'semester'

--- FILE: apps/semester/migrations/0001_initial.py ---
# Generated by Django 4.2.11 on 2026-01-28 13:35

from decimal import Decimal
from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Semester',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50)),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('status', models.CharField(choices=[('ACTIVE', 'Active'), ('FINISHED', 'Finished')], default='ACTIVE', max_length=20)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='semesters', to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='SemesterCheckin',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('overall_stress', models.PositiveSmallIntegerField(validators=[django.core.validators.MinValueValidator(1), django.core.validators.MaxValueValidator(5)])),
                ('comment', models.TextField(blank=True)),
                ('semester', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='checkins', to='semester.semester')),
            ],
        ),
        migrations.CreateModel(
            name='Course',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('teacher', models.CharField(blank=True, max_length=200)),
                ('credits', models.PositiveIntegerField(blank=True, null=True)),
                ('passing_grade', models.DecimalField(decimal_places=2, default=Decimal('7.0'), max_digits=4)),
                ('status', models.CharField(choices=[('IN_PROGRESS', 'In progress'), ('PASSED', 'Passed'), ('FAILED', 'Failed')], default='IN_PROGRESS', max_length=20)),
                ('final_grade', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('notes', models.TextField(blank=True)),
                ('semester', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='courses', to='semester.semester')),
            ],
        ),
        migrations.CreateModel(
            name='Assessment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200)),
                ('score', models.DecimalField(decimal_places=2, max_digits=5, validators=[django.core.validators.MinValueValidator(0)])),
                ('max_score', models.DecimalField(decimal_places=2, default=Decimal('10.0'), max_digits=5)),
                ('weight', models.DecimalField(decimal_places=2, default=Decimal('1.0'), max_digits=5, validators=[django.core.validators.MinValueValidator(0)])),
                ('date', models.DateField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('course', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='assessments', to='semester.course')),
            ],
        ),
    ]

--- FILE: apps/semester/migrations/__init__.py ---


--- FILE: apps/semester/models.py ---
from decimal import Decimal

from django.conf import settings
from django.core.validators import MaxValueValidator, MinValueValidator
from django.db import models

from utils.constants import COURSE_STATUS_CHOICES, COURSE_IN_PROGRESS, SEMESTER_STATUS_CHOICES, SEMESTER_ACTIVE


class Semester(models.Model):
    user = models.ForeignKey(settings.AUTH_USER_MODEL, on_delete=models.CASCADE, related_name="semesters")
    name = models.CharField(max_length=50)
    start_date = models.DateField()
    end_date = models.DateField()
    status = models.CharField(max_length=20, choices=SEMESTER_STATUS_CHOICES, default=SEMESTER_ACTIVE)

    def __str__(self):
        return self.name


class Course(models.Model):
    semester = models.ForeignKey(Semester, on_delete=models.CASCADE, related_name="courses")
    title = models.CharField(max_length=200)
    teacher = models.CharField(max_length=200, blank=True)
    credits = models.PositiveIntegerField(null=True, blank=True)
    passing_grade = models.DecimalField(max_digits=4, decimal_places=2, default=Decimal("7.0"))
    status = models.CharField(max_length=20, choices=COURSE_STATUS_CHOICES, default=COURSE_IN_PROGRESS)
    final_grade = models.DecimalField(max_digits=5, decimal_places=2, null=True, blank=True)
    notes = models.TextField(blank=True)

    def __str__(self):
        return self.title


class Assessment(models.Model):
    course = models.ForeignKey(Course, on_delete=models.CASCADE, related_name="assessments")
    title = models.CharField(max_length=200)
    score = models.DecimalField(max_digits=5, decimal_places=2, validators=[MinValueValidator(0)])
    max_score = models.DecimalField(max_digits=5, decimal_places=2, default=Decimal("10.0"))
    weight = models.DecimalField(max_digits=5, decimal_places=2, default=Decimal("1.0"), validators=[MinValueValidator(0)])
    date = models.DateField(null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.title


class SemesterCheckin(models.Model):
    semester = models.ForeignKey(Semester, on_delete=models.CASCADE, related_name="checkins")
    created_at = models.DateTimeField(auto_now_add=True)
    overall_stress = models.PositiveSmallIntegerField(validators=[MinValueValidator(1), MaxValueValidator(5)])
    comment = models.TextField(blank=True)

    def __str__(self):
        return f"{self.semester.name} checkin"

--- FILE: apps/semester/serializers.py ---
from decimal import Decimal, ROUND_HALF_UP

from rest_framework import serializers

from semester.models import Assessment, Course, Semester, SemesterCheckin


def compute_course_average(course):
    assessments = course.assessments.all()
    total_weight = sum((a.weight for a in assessments), Decimal("0"))
    if total_weight == 0:
        return Decimal("0")
    total_score = sum((a.score * a.weight for a in assessments), Decimal("0"))
    return (total_score / total_weight).quantize(Decimal("0.01"), rounding=ROUND_HALF_UP)


def compute_course_progress(course):
    current_average = compute_course_average(course)
    passing_grade = course.passing_grade or Decimal("0")
    if passing_grade == 0:
        progress_percent = Decimal("0")
    else:
        progress_percent = min(Decimal("100"), (current_average / passing_grade) * Decimal("100"))
    needed_to_pass = max(Decimal("0"), passing_grade - current_average)
    return current_average, progress_percent, needed_to_pass


class SemesterSerializer(serializers.ModelSerializer):
    class Meta:
        model = Semester
        fields = ("id", "name", "start_date", "end_date", "status")
        read_only_fields = ("id",)


class CourseSerializer(serializers.ModelSerializer):
    current_average = serializers.SerializerMethodField()
    progress_percent = serializers.SerializerMethodField()
    needed_to_pass = serializers.SerializerMethodField()

    class Meta:
        model = Course
        fields = (
            "id",
            "semester",
            "title",
            "teacher",
            "credits",
            "passing_grade",
            "status",
            "final_grade",
            "notes",
            "current_average",
            "progress_percent",
            "needed_to_pass",
        )
        read_only_fields = ("id", "status", "final_grade", "current_average", "progress_percent", "needed_to_pass")

    def get_current_average(self, obj):
        return compute_course_progress(obj)[0]

    def get_progress_percent(self, obj):
        return compute_course_progress(obj)[1]

    def get_needed_to_pass(self, obj):
        return compute_course_progress(obj)[2]


class AssessmentSerializer(serializers.ModelSerializer):
    class Meta:
        model = Assessment
        fields = ("id", "course", "title", "score", "max_score", "weight", "date", "created_at")
        read_only_fields = ("id", "created_at")

    def validate(self, attrs):
        score = attrs.get("score")
        max_score = attrs.get("max_score")
        weight = attrs.get("weight")
        if score is not None and max_score is not None and score > max_score:
            raise serializers.ValidationError("score deve ser <= max_score")
        if weight is not None and weight < 0:
            raise serializers.ValidationError("weight deve ser >= 0")
        return attrs


class SemesterCheckinSerializer(serializers.ModelSerializer):
    class Meta:
        model = SemesterCheckin
        fields = ("id", "semester", "created_at", "overall_stress", "comment")
        read_only_fields = ("id", "created_at")

--- FILE: apps/semester/tests.py ---
from datetime import date
from decimal import Decimal

from django.contrib.auth import get_user_model
from rest_framework.test import APITestCase
from rest_framework_simplejwt.tokens import RefreshToken

from coach_ai.models import CoachLog
from semester.models import Assessment, Course, Semester
from utils.constants import COACH_REPROVACAO, COACH_SEMESTRE_CONCLUIDO, COURSE_FAILED, COURSE_PASSED

User = get_user_model()


class SemesterProgressTests(APITestCase):
    def setUp(self):
        self.user = User.objects.create_user(email="semester@example.com", name="Semestre", password="pass12345")
        refresh = RefreshToken.for_user(self.user)
        self.client.credentials(HTTP_AUTHORIZATION=f"Bearer {refresh.access_token}")
        self.semester = Semester.objects.create(
            user=self.user,
            name="2026.1",
            start_date=date.today(),
            end_date=date.today(),
        )
        self.course = Course.objects.create(semester=self.semester, title="Matematica")

    def test_course_progress_requires_assessment(self):
        response = self.client.get(f"/api/semester/courses/{self.course.id}/progress/")
        self.assertEqual(response.status_code, 403)
        self.assertIn("detail", response.data)

    def test_finish_semester_passed(self):
        Assessment.objects.create(course=self.course, title="Prova 1", score=Decimal("9"), max_score=Decimal("10"))
        response = self.client.post(f"/api/semester/finish/{self.semester.id}/")
        self.assertEqual(response.status_code, 200)
        self.course.refresh_from_db()
        self.assertEqual(self.course.status, COURSE_PASSED)
        self.assertTrue(CoachLog.objects.filter(user=self.user, trigger_type=COACH_SEMESTRE_CONCLUIDO).exists())

    def test_finish_semester_failed(self):
        failing_course = Course.objects.create(semester=self.semester, title="Fisica", passing_grade=Decimal("7"))
        Assessment.objects.create(course=failing_course, title="Prova 1", score=Decimal("3"), max_score=Decimal("10"))
        response = self.client.post(f"/api/semester/finish/{self.semester.id}/")
        self.assertEqual(response.status_code, 200)
        failing_course.refresh_from_db()
        self.assertEqual(failing_course.status, COURSE_FAILED)
        self.assertTrue(CoachLog.objects.filter(user=self.user, trigger_type=COACH_REPROVACAO).exists())

--- FILE: apps/semester/urls.py ---
from django.urls import path
from rest_framework.routers import DefaultRouter

from semester.views import AssessmentViewSet, CourseProgressView, CourseViewSet, FinishSemesterView, SemesterViewSet

router = DefaultRouter()
router.register(r"semesters", SemesterViewSet, basename="semesters")
router.register(r"courses", CourseViewSet, basename="courses")
router.register(r"assessments", AssessmentViewSet, basename="assessments")

urlpatterns = router.urls + [
    path("courses/<int:pk>/progress/", CourseProgressView.as_view(), name="course-progress"),
    path("finish/<int:semester_id>/", FinishSemesterView.as_view(), name="semester-finish"),
]

--- FILE: apps/semester/views.py ---
from decimal import Decimal

from django.shortcuts import get_object_or_404
from rest_framework import permissions, status, viewsets
from rest_framework.exceptions import PermissionDenied
from rest_framework.response import Response
from rest_framework.views import APIView

from coach_ai.models import CoachLog
from semester.models import Assessment, Course, Semester
from semester.serializers import AssessmentSerializer, CourseSerializer, SemesterSerializer, compute_course_progress
from utils.constants import COACH_REPROVACAO, COACH_SEMESTRE_CONCLUIDO, COURSE_FAILED, COURSE_PASSED, SEMESTER_FINISHED
from utils.gating import gate_course_progress, gate_finish_semester


class SemesterViewSet(viewsets.ModelViewSet):
    serializer_class = SemesterSerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        return Semester.objects.filter(user=self.request.user).order_by("-start_date")

    def perform_create(self, serializer):
        serializer.save(user=self.request.user)


class CourseViewSet(viewsets.ModelViewSet):
    serializer_class = CourseSerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        return Course.objects.filter(semester__user=self.request.user).order_by("title")

    def perform_create(self, serializer):
        semester = serializer.validated_data["semester"]
        if semester.user != self.request.user:
            raise PermissionDenied("Semestre nao pertence ao usuario")
        serializer.save()


class AssessmentViewSet(viewsets.ModelViewSet):
    serializer_class = AssessmentSerializer
    permission_classes = [permissions.IsAuthenticated]

    def get_queryset(self):
        return Assessment.objects.filter(course__semester__user=self.request.user).order_by("-created_at")

    def perform_create(self, serializer):
        course = serializer.validated_data["course"]
        if course.semester.user != self.request.user:
            raise PermissionDenied("Curso nao pertence ao usuario")
        serializer.save()


class CourseProgressView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def get(self, request, pk):
        course = get_object_or_404(Course, pk=pk, semester__user=request.user)
        allowed, message = gate_course_progress(course)
        if not allowed:
            return Response({"detail": message}, status=status.HTTP_403_FORBIDDEN)
        current_average, progress_percent, needed_to_pass = compute_course_progress(course)
        return Response(
            {
                "course_id": course.id,
                "current_average": current_average,
                "progress_percent": progress_percent,
                "needed_to_pass": needed_to_pass,
            }
        )


class FinishSemesterView(APIView):
    permission_classes = [permissions.IsAuthenticated]

    def post(self, request, semester_id):
        semester = get_object_or_404(Semester, pk=semester_id, user=request.user)
        allowed, message = gate_finish_semester(semester)
        if not allowed:
            return Response({"detail": message}, status=status.HTTP_403_FORBIDDEN)

        any_failed = False
        for course in semester.courses.all():
            current_average, _progress, _needed = compute_course_progress(course)
            course.final_grade = current_average
            if current_average >= (course.passing_grade or Decimal("0")):
                course.status = COURSE_PASSED
            else:
                course.status = COURSE_FAILED
                any_failed = True
            course.save()

        semester.status = SEMESTER_FINISHED
        semester.save()

        if any_failed:
            CoachLog.objects.create(
                user=request.user,
                trigger_type=COACH_REPROVACAO,
                suggestion_text=(
                    "Identificamos disciplinas reprovadas. Vamos montar um plano de continuidade e recuperar o ritmo."
                ),
            )
        else:
            CoachLog.objects.create(
                user=request.user,
                trigger_type=COACH_SEMESTRE_CONCLUIDO,
                suggestion_text=(
                    "Parabens! Voce concluiu o semestre sem reprovacoes. Continue com esse ritmo."
                ),
            )

        return Response({"detail": "Semestre finalizado."})

--- FILE: apps/ui/__init__.py ---


--- FILE: apps/ui/apps.py ---
from django.apps import AppConfig


class UiConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "ui"

--- FILE: apps/ui/forms.py ---
from django import forms
from django.contrib.auth.forms import AuthenticationForm


class EmailAuthenticationForm(AuthenticationForm):
    username = forms.EmailField(
        label="Email",
        widget=forms.EmailInput(attrs={"class": "form-control", "placeholder": "seu.email@universidade.edu"}),
    )
    password = forms.CharField(
        label="Senha",
        widget=forms.PasswordInput(attrs={"class": "form-control", "placeholder": "Sua senha"}),
    )

--- FILE: apps/ui/urls.py ---
from django.contrib.auth import views as auth_views
from django.urls import path

from ui.forms import EmailAuthenticationForm
from ui.views import agenda_view, dashboard_view, onboarding_view, semesters_view, tasks_view

urlpatterns = [
    path(
        "login/",
        auth_views.LoginView.as_view(
            template_name="ui/login.html",
            authentication_form=EmailAuthenticationForm,
        ),
        name="ui-login",
    ),
    path("logout/", auth_views.LogoutView.as_view(next_page="/login/"), name="ui-logout"),
    path(
        "password-reset/",
        auth_views.PasswordResetView.as_view(
            template_name="ui/password_reset_form.html",
            email_template_name="registration/password_reset_email.html",
            subject_template_name="registration/password_reset_subject.txt",
            success_url="/password-reset/done/",
        ),
        name="password_reset",
    ),
    path(
        "password-reset/done/",
        auth_views.PasswordResetDoneView.as_view(
            template_name="ui/password_reset_done.html",
        ),
        name="password_reset_done",
    ),
    path(
        "reset/<uidb64>/<token>/",
        auth_views.PasswordResetConfirmView.as_view(
            template_name="ui/password_reset_confirm.html",
            success_url="/reset/done/",
        ),
        name="password_reset_confirm",
    ),
    path(
        "reset/done/",
        auth_views.PasswordResetCompleteView.as_view(
            template_name="ui/password_reset_complete.html",
        ),
        name="password_reset_complete",
    ),
    path("", dashboard_view, name="ui-dashboard"),
    path("onboarding/", onboarding_view, name="ui-onboarding"),
    path("semesters/", semesters_view, name="ui-semesters"),
    path("tasks/", tasks_view, name="ui-tasks"),
    path("agenda/", agenda_view, name="ui-agenda"),
]

--- FILE: apps/ui/views.py ---
from collections import Counter
from datetime import timedelta

from django.contrib.auth.decorators import login_required
from django.db.models import Q
from django.shortcuts import redirect, render
from django.utils import timezone

from agenda.models import CalendarEvent, ReminderRule
from mood.models import MoodEntry
from onboarding.services import refresh_user_progress
from planner.models import Task
from pomodoro.models import PomodoroSession
from semester.models import Semester, SemesterCheckin
from semester.serializers import compute_course_progress
from utils.constants import (
    EVENT_TYPE_CHOICES,
    SEMESTER_ACTIVE,
    SEMESTER_FINISHED,
    TASK_DOING,
    TASK_DONE,
    TASK_TODO,
)
from utils.gating import STEPS, compute_status

STEP_LABELS = {
    "STEP_1_PROFILE": "Perfil",
    "STEP_2_SEMESTER": "Semestre",
    "STEP_3_COURSES": "Disciplinas",
    "STEP_4_ASSESSMENTS": "Avaliacoes",
    "STEP_5_REMINDERS": "Lembretes",
    "STEP_6_DASHBOARD": "Dashboard",
}


def _build_steps(progress):
    current_step, missing_steps, required_actions = compute_status(progress)
    steps = []
    for step, _field, message in STEPS:
        label = STEP_LABELS.get(step, step)
        is_missing = step in missing_steps
        steps.append(
            {
                "code": step,
                "label": label,
                "missing": is_missing,
                "message": message if is_missing else "Concluido",
            }
        )
    return {
        "current_step": current_step,
        "missing_steps": missing_steps,
        "required_actions": required_actions,
        "steps": steps,
        "is_complete": len(missing_steps) == 0,
    }


@login_required(login_url="/login/")
def dashboard_view(request):
    user = request.user
    progress = refresh_user_progress(user)
    onboarding_status = _build_steps(progress)

    session_key = "ui_dashboard_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if "q" in request.GET:
        search_query = request.GET.get("q", "").strip()
        request.session[session_key] = {"q": search_query}
    else:
        search_query = request.session.get(session_key, {}).get("q", "")

    now = timezone.now()
    week_ago = now - timedelta(days=7)

    mood_entries = MoodEntry.objects.filter(user=user, created_at__gte=week_ago)
    mood_counts = Counter(mood_entries.values_list("mood", flat=True))
    most_common_mood = None
    if mood_counts:
        most_common_mood = mood_counts.most_common(1)[0][0]

    focus_minutes = (
        PomodoroSession.objects.filter(user=user, started_at__gte=week_ago)
        .values_list("focus_minutes", flat=True)
    )
    total_focus_minutes = sum(focus_minutes)

    stress_values = SemesterCheckin.objects.filter(semester__user=user, created_at__gte=week_ago).values_list(
        "overall_stress", flat=True
    )
    stress_avg = round(sum(stress_values) / len(stress_values), 2) if stress_values else None

    today = timezone.localdate()
    next_week = today + timedelta(days=7)
    upcoming_tasks = Task.objects.filter(user=user, due_date__gte=today, due_date__lte=next_week).order_by("due_date")
    upcoming_events = CalendarEvent.objects.filter(
        user=user, start_at__date__gte=today, start_at__date__lte=next_week
    ).order_by("start_at")
    if search_query:
        upcoming_tasks = upcoming_tasks.filter(Q(title__icontains=search_query) | Q(description__icontains=search_query))
        upcoming_events = upcoming_events.filter(title__icontains=search_query)

    tasks = Task.objects.filter(user=user)
    dashboard_data = {
        "tasks": {
            "todo": tasks.filter(status=TASK_TODO).count(),
            "doing": tasks.filter(status=TASK_DOING).count(),
            "done": tasks.filter(status=TASK_DONE).count(),
        },
        "mood_weekly_total": mood_entries.count(),
        "mood_most_common": most_common_mood,
        "focus_minutes_week": total_focus_minutes,
        "stress_avg_week": stress_avg,
        "upcoming_tasks": upcoming_tasks[:5],
        "upcoming_events": upcoming_events[:5],
        "upcoming_count": upcoming_tasks.count() + upcoming_events.count(),
    }

    return render(
        request,
        "ui/dashboard.html",
        {
            "onboarding_status": onboarding_status,
            "dashboard_data": dashboard_data,
            "search_query": search_query,
        },
    )


@login_required(login_url="/login/")
def onboarding_view(request):
    user = request.user
    progress = refresh_user_progress(user)
    onboarding_status = _build_steps(progress)
    return render(
        request,
        "ui/onboarding.html",
        {
            "current_step": onboarding_status["current_step"],
            "missing_steps": onboarding_status["missing_steps"],
            "required_actions": onboarding_status["required_actions"],
            "steps": onboarding_status["steps"],
        },
    )


@login_required(login_url="/login/")
def semesters_view(request):
    user = request.user
    session_key = "ui_semesters_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if any(key in request.GET for key in ("status", "course", "teacher")):
        status_filter = request.GET.get("status", "")
        course_query = request.GET.get("course", "").strip()
        teacher_query = request.GET.get("teacher", "").strip()
        request.session[session_key] = {
            "status": status_filter,
            "course": course_query,
            "teacher": teacher_query,
        }
    else:
        saved = request.session.get(session_key, {})
        status_filter = saved.get("status", "")
        course_query = saved.get("course", "")
        teacher_query = saved.get("teacher", "")
    semesters = Semester.objects.filter(user=user)
    if status_filter in {SEMESTER_ACTIVE, SEMESTER_FINISHED}:
        semesters = semesters.filter(status=status_filter)
    semesters = semesters.order_by("-start_date")
    semester_cards = []
    for semester in semesters.prefetch_related("courses__assessments"):
        courses_data = []
        for course in semester.courses.all():
            if course_query and course_query.lower() not in course.title.lower():
                continue
            if teacher_query and teacher_query.lower() not in (course.teacher or "").lower():
                continue
            current_average, progress_percent, needed_to_pass = compute_course_progress(course)
            courses_data.append(
                {
                    "title": course.title,
                    "teacher": course.teacher,
                    "status": course.status,
                    "passing_grade": course.passing_grade,
                    "current_average": current_average,
                    "progress_percent": progress_percent,
                    "needed_to_pass": needed_to_pass,
                }
            )
        if (course_query or teacher_query) and not courses_data:
            continue
        semester_cards.append(
            {
                "name": semester.name,
                "start_date": semester.start_date,
                "end_date": semester.end_date,
                "status": semester.status,
                "courses": courses_data,
            }
        )

    return render(
        request,
        "ui/semesters.html",
        {
            "semesters": semester_cards,
            "status_filter": status_filter,
            "course_query": course_query,
            "teacher_query": teacher_query,
        },
    )


@login_required(login_url="/login/")
def tasks_view(request):
    user = request.user
    session_key = "ui_tasks_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if any(key in request.GET for key in ("status", "due", "q", "stress")):
        status_filter = request.GET.get("status", "")
        due_filter = request.GET.get("due", "")
        search_query = request.GET.get("q", "").strip()
        stress_filter = request.GET.get("stress", "")
        request.session[session_key] = {
            "status": status_filter,
            "due": due_filter,
            "q": search_query,
            "stress": stress_filter,
        }
    else:
        saved = request.session.get(session_key, {})
        status_filter = saved.get("status", "")
        due_filter = saved.get("due", "")
        search_query = saved.get("q", "")
        stress_filter = saved.get("stress", "")
    tasks = Task.objects.filter(user=user)
    if status_filter in {TASK_TODO, TASK_DOING, TASK_DONE}:
        tasks = tasks.filter(status=status_filter)
    today = timezone.localdate()
    if due_filter == "overdue":
        tasks = tasks.filter(due_date__lt=today)
    elif due_filter == "today":
        tasks = tasks.filter(due_date=today)
    elif due_filter == "week":
        tasks = tasks.filter(due_date__gte=today, due_date__lte=today + timedelta(days=7))
    elif due_filter == "month":
        tasks = tasks.filter(due_date__gte=today, due_date__lte=today + timedelta(days=30))
    if search_query:
        tasks = tasks.filter(Q(title__icontains=search_query) | Q(description__icontains=search_query))
    if stress_filter in {"1", "2", "3", "4", "5"}:
        tasks = tasks.filter(stress_level=int(stress_filter))
    tasks = tasks.order_by("due_date")
    return render(
        request,
        "ui/tasks.html",
        {
            "tasks": tasks,
            "status_filter": status_filter,
            "due_filter": due_filter,
            "search_query": search_query,
            "stress_filter": stress_filter,
        },
    )


@login_required(login_url="/login/")
def agenda_view(request):
    user = request.user
    today = timezone.localdate()
    session_key = "ui_agenda_filters"
    if request.GET.get("clear") == "1":
        request.session.pop(session_key, None)
        return redirect(request.path)
    if any(key in request.GET for key in ("range", "q", "type")):
        range_days = request.GET.get("range", "30")
        if range_days not in {"7", "15", "30", "60", "90"}:
            range_days = "30"
        search_query = request.GET.get("q", "").strip()
        type_filter = request.GET.get("type", "")
        request.session[session_key] = {
            "range": range_days,
            "q": search_query,
            "type": type_filter,
        }
    else:
        saved = request.session.get(session_key, {})
        range_days = saved.get("range", "30")
        search_query = saved.get("q", "")
        type_filter = saved.get("type", "")
    next_month = today + timedelta(days=int(range_days))
    events = CalendarEvent.objects.filter(
        user=user, start_at__date__gte=today, start_at__date__lte=next_month
    ).order_by("start_at")
    if search_query:
        events = events.filter(title__icontains=search_query)
    event_type_values = [value for value, _label in EVENT_TYPE_CHOICES]
    if type_filter in event_type_values:
        events = events.filter(event_type=type_filter)
    reminder_rules = ReminderRule.objects.filter(user=user, is_active=True)
    return render(
        request,
        "ui/agenda.html",
        {
            "events": events,
            "reminder_rules": reminder_rules,
            "range_days": range_days,
            "search_query": search_query,
            "type_filter": type_filter,
            "event_type_choices": EVENT_TYPE_CHOICES,
        },
    )

--- FILE: config/__init__.py ---


--- FILE: config/asgi.py ---
"""
ASGI config for config project.

It exposes the ASGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')

application = get_asgi_application()

--- FILE: config/settings.py ---
"""
Django settings for campus_calm project.
"""

import os
import sys
from pathlib import Path

BASE_DIR = Path(__file__).resolve().parent.parent

# Ensure /apps is on the path for INSTALLED_APPS like "accounts"
sys.path.insert(0, str(BASE_DIR / "apps"))

SECRET_KEY = os.getenv("DJANGO_SECRET_KEY", "django-insecure-dev-key")
DEBUG = os.getenv("DJANGO_DEBUG", "True").lower() == "true"
ALLOWED_HOSTS = [host for host in os.getenv("DJANGO_ALLOWED_HOSTS", "").split(",") if host]

INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "corsheaders",
    "rest_framework",
    "rest_framework_simplejwt",
    "drf_spectacular",
    "accounts",
    "billing.apps.BillingConfig",
    "mood",
    "pomodoro",
    "planner",
    "agenda",
    "semester",
    "content",
    "coach_ai",
    "notifications",
    "access_requests",
    "onboarding.apps.OnboardingConfig",
    "analytics",
    "ui.apps.UiConfig",
]

MIDDLEWARE = [
    "corsheaders.middleware.CorsMiddleware",
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
]

ROOT_URLCONF = "config.urls"

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [BASE_DIR / "templates"],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
            ],
        },
    }
]

WSGI_APPLICATION = "config.wsgi.application"

DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3",
        "NAME": BASE_DIR / "db.sqlite3",
    }
}

AUTH_PASSWORD_VALIDATORS = [
    {"NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator"},
    {"NAME": "django.contrib.auth.password_validation.MinimumLengthValidator"},
    {"NAME": "django.contrib.auth.password_validation.CommonPasswordValidator"},
    {"NAME": "django.contrib.auth.password_validation.NumericPasswordValidator"},
]

LANGUAGE_CODE = "pt-br"
TIME_ZONE = "America/Sao_Paulo"
USE_I18N = True
USE_TZ = True

STATIC_URL = "/static/"
STATICFILES_DIRS = [BASE_DIR / "static"]

MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"
AUTH_USER_MODEL = "accounts.User"

REST_FRAMEWORK = {
    "DEFAULT_AUTHENTICATION_CLASSES": (
        "rest_framework_simplejwt.authentication.JWTAuthentication",
    ),
    "DEFAULT_PERMISSION_CLASSES": ("rest_framework.permissions.IsAuthenticated",),
    "DEFAULT_SCHEMA_CLASS": "drf_spectacular.openapi.AutoSchema",
}

SPECTACULAR_SETTINGS = {
    "TITLE": "Campus Calm API",
    "DESCRIPTION": "API do MVP Campus Calm",
    "VERSION": "0.1.0",
}

CORS_ALLOW_ALL_ORIGINS = True

EMAIL_BACKEND = "django.core.mail.backends.console.EmailBackend"
DEFAULT_FROM_EMAIL = os.getenv("DEFAULT_FROM_EMAIL", "no-reply@campuscalm.local")

LOGIN_URL = "/login/"
LOGIN_REDIRECT_URL = "/"
LOGOUT_REDIRECT_URL = "/login/"

--- FILE: config/settings_migrations.py ---
"""Settings file for generating migrations without third-party dependencies."""

import os
import sys
from pathlib import Path

BASE_DIR = Path(__file__).resolve().parent.parent
sys.path.insert(0, str(BASE_DIR / "apps"))

SECRET_KEY = "migration-only"
DEBUG = True
ALLOWED_HOSTS = []

INSTALLED_APPS = [
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "accounts",
    "billing.apps.BillingConfig",
    "mood",
    "pomodoro",
    "planner",
    "agenda",
    "semester",
    "content",
    "coach_ai",
    "notifications",
    "access_requests",
    "onboarding.apps.OnboardingConfig",
    "analytics",
    "ui.apps.UiConfig",
]

MIDDLEWARE = [
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
]

ROOT_URLCONF = "config.urls"

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [BASE_DIR / "templates"],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
            ],
        },
    }
]

DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3",
        "NAME": BASE_DIR / "db.sqlite3",
    }
}

LANGUAGE_CODE = "pt-br"
TIME_ZONE = "America/Sao_Paulo"
USE_I18N = True
USE_TZ = True

STATIC_URL = "/static/"
MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"
AUTH_USER_MODEL = "accounts.User"

--- FILE: config/urls.py ---
from django.conf import settings
from django.conf.urls.static import static
from django.contrib import admin
from django.urls import include, path
from drf_spectacular.views import SpectacularAPIView, SpectacularSwaggerView

from config.views import health_check

urlpatterns = [
    path("admin/", admin.site.urls),
    path("health/", health_check, name="health-check"),
    path("", include("ui.urls")),
    path("api/schema/", SpectacularAPIView.as_view(), name="schema"),
    path("api/docs/", SpectacularSwaggerView.as_view(url_name="schema"), name="docs"),
    path("api/auth/", include("accounts.urls")),
    path("api/billing/", include("billing.urls")),
    path("api/mood/", include("mood.urls")),
    path("api/pomodoro/", include("pomodoro.urls")),
    path("api/planner/", include("planner.urls")),
    path("api/agenda/", include("agenda.urls")),
    path("api/semester/", include("semester.urls")),
    path("api/content/", include("content.urls")),
    path("api/notifications/", include("notifications.urls")),
    path("api/access/", include("access_requests.urls")),
    path("api/onboarding/", include("onboarding.urls")),
    path("api/analytics/", include("analytics.urls")),
]

if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)

--- FILE: config/views.py ---
from django.http import JsonResponse
from django.utils import timezone


def health_check(_request):
    return JsonResponse({"status": "ok", "timestamp": timezone.now().isoformat()})

--- FILE: config/wsgi.py ---
"""
WSGI config for config project.

It exposes the WSGI callable as a module-level variable named ``application``.

For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')

application = get_wsgi_application()

--- FILE: manage.py ---
#!/usr/bin/env python3
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'config.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()

--- FILE: requirements.txt ---
Django>=5.0
djangorestframework>=3.15
djangorestframework-simplejwt>=5.3
django-cors-headers>=4.3
drf-spectacular>=0.27

--- FILE: scripts/run_curl_demo.sh ---
#!/usr/bin/env bash
set -euo pipefail

API_HOST="${API_HOST:-http://localhost:8000}"
EMAIL="${API_EMAIL:-nari.naluu@gmail.com}"
PASSWORD="${API_PASSWORD:-Pucca&garu@20}"

login_response=$(curl -s -X POST "${API_HOST}/api/auth/login/" \
  -H "Content-Type: application/json" \
  -d "{\"email\":\"${EMAIL}\",\"password\":\"${PASSWORD}\"}")

access=$(printf '%s' "$login_response" | python3 - <<'PY'
import json, sys
try:
    data = json.load(sys.stdin)
    print(data.get("access", ""))
except Exception:
    print("", end="")
PY
)

if [ -z "$access" ]; then
  echo "Falha no login. Resposta:" >&2
  echo "$login_response" >&2
  exit 1
fi

bearer="Authorization: Bearer $access"

echo "== /api/auth/me/"
curl -s -H "$bearer" "${API_HOST}/api/auth/me/" | python3 -m json.tool

echo "== /api/mood/entries/"
curl -s -H "$bearer" "${API_HOST}/api/mood/entries/" | python3 -m json.tool

echo "== /api/planner/tasks/"
curl -s -H "$bearer" "${API_HOST}/api/planner/tasks/" | python3 -m json.tool

echo "== /api/agenda/week/"
curl -s -H "$bearer" "${API_HOST}/api/agenda/week/" | python3 -m json.tool

echo "== /api/semester/courses/"
course_list=$(curl -s -H "$bearer" "${API_HOST}/api/semester/courses/")
course_id=$(printf '%s' "$course_list" | python3 - <<'PY'
import json, sys
try:
    data = json.load(sys.stdin)
    if data:
        print(data[0].get("id", ""))
except Exception:
    print("")
PY
)

echo "$course_list" | python3 -m json.tool

if [ -n "$course_id" ]; then
  echo "== /api/semester/courses/${course_id}/progress/"
  curl -s -H "$bearer" "${API_HOST}/api/semester/courses/${course_id}/progress/" | python3 -m json.tool
fi

echo "== /api/content/guided/"
curl -s -H "$bearer" "${API_HOST}/api/content/guided/" | python3 -m json.tool

echo "== /api/onboarding/status/"
curl -s -H "$bearer" "${API_HOST}/api/onboarding/status/" | python3 -m json.tool

echo "== /api/analytics/dashboard/"
curl -s -H "$bearer" "${API_HOST}/api/analytics/dashboard/" | python3 -m json.tool

--- FILE: static/css/app.css ---
:root {
  --sidebar-width: 220px;
  --sidebar-bg: #ffffff;
  --primary-soft: #e8f0fb;
  --brand: #1d4ed8;
}

body {
  font-family: "Sora", system-ui, sans-serif;
}

.sidebar {
  width: var(--sidebar-width);
  min-height: 100vh;
  position: fixed;
  left: 0;
  top: 0;
  padding-top: 12px;
  box-shadow: 0 0 12px rgba(15, 23, 42, 0.04);
}

.content {
  margin-left: var(--sidebar-width);
  min-height: 100vh;
}

.nav-link {
  color: #334155;
  padding: 0.5rem 0.75rem;
  margin-bottom: 4px;
}

.nav-link:hover {
  background: var(--primary-soft);
  border-radius: 6px;
}

.nav-link.active {
  background: #dbe7f8;
  border-radius: 6px;
  font-weight: 600;
}

.card {
  border-radius: 10px;
}

.bg-auth {
  min-height: 100vh;
  background: radial-gradient(circle at top left, #e2e8f0, #f8fafc 60%);
  position: relative;
  overflow: hidden;
}

.auth-shell {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  position: relative;
  z-index: 1;
}

.auth-card {
  background: #ffffff;
  border-radius: 16px;
  width: min(420px, 100%);
  overflow: hidden;
  border: 1px solid #e2e8f0;
}

.auth-header {
  padding: 28px 28px 16px;
  background: linear-gradient(135deg, #1d4ed8, #3b82f6);
  color: #fff;
}

.auth-logo {
  font-weight: 700;
  font-size: 1.25rem;
  letter-spacing: 0.2px;
}

.auth-subtitle {
  font-size: 0.85rem;
  opacity: 0.9;
}

.auth-body {
  padding: 24px 28px 28px;
}

.bg-auth::before,
.bg-auth::after {
  content: "";
  position: absolute;
  width: 320px;
  height: 320px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, rgba(59, 130, 246, 0.25), transparent 60%);
  filter: blur(2px);
}

.bg-auth::before {
  top: -80px;
  right: -120px;
}

.bg-auth::after {
  bottom: -100px;
  left: -120px;
}

--- FILE: templates/base.html ---
{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campus Calm</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{% static 'css/app.css' %}" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="d-flex">
    <nav class="sidebar bg-white border-end">
      <div class="p-3">
        <div class="fw-bold fs-5">Campus Calm</div>
        <div class="text-muted small">Painel do aluno</div>
        <div class="mt-3 small text-muted">
          Ol, {{ request.user.name|default:request.user.email }}
        </div>
        <ul class="nav flex-column mt-4">
          <li class="nav-item">
            <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="/">Dashboard</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":11" == "/onboarding" %}active{% endif %}" href="/onboarding/">Onboarding</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":10" == "/semesters" %}active{% endif %}" href="/semesters/">Semestres</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":6" == "/tasks" %}active{% endif %}" href="/tasks/">Tarefas</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":7" == "/agenda" %}active{% endif %}" href="/agenda/">Agenda</a>
          </li>
        </ul>
        <div class="mt-4 pt-3 border-top">
          <a class="nav-link text-danger" href="/logout/">Sair</a>
        </div>
      </div>
    </nav>

    <main class="content flex-grow-1">
      <div class="container-fluid py-4">
        {% block content %}{% endblock %}
      </div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

--- FILE: templates/registration/password_reset_email.html ---
{% autoescape off %}
Voce solicitou a redefinicao de senha do Campus Calm.

Para criar uma nova senha, acesse o link abaixo:
{{ protocol }}://{{ domain }}{% url 'password_reset_confirm' uidb64=uid token=token %}

Se voce nao solicitou, ignore esta mensagem.
{% endautoescape %}

--- FILE: templates/registration/password_reset_subject.txt ---
Campus Calm - Redefinicao de senha

--- FILE: templates/ui/agenda.html ---
{% extends "base.html" %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">Agenda</h1>
    <div class="text-muted">Eventos dos proximos {{ range_days }} dias</div>
  </div>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="q" placeholder="Buscar evento"
           value="{{ search_query }}">
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="type">
      <option value="">Todos os tipos</option>
      {% for value,label in event_type_choices %}
        <option value="{{ value }}" {% if type_filter == value %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="range">
      <option value="7" {% if range_days == "7" %}selected{% endif %}>Proximos 7 dias</option>
      <option value="15" {% if range_days == "15" %}selected{% endif %}>Proximos 15 dias</option>
      <option value="30" {% if range_days == "30" %}selected{% endif %}>Proximos 30 dias</option>
      <option value="60" {% if range_days == "60" %}selected{% endif %}>Proximos 60 dias</option>
      <option value="90" {% if range_days == "90" %}selected{% endif %}>Proximos 90 dias</option>
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-sm btn-outline-secondary" type="submit">Filtrar</button>
    <a class="btn btn-sm btn-link" href="/agenda/?clear=1">Limpar</a>
  </div>
</form>

<div class="row g-3">
  <div class="col-lg-7">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">Eventos</div>
      <div class="card-body">
        {% if events %}
          <ul class="list-group list-group-flush">
            {% for event in events %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-semibold">{{ event.title }}</div>
                  <div class="text-muted small">{{ event.event_type }}</div>
                </div>
                <span class="text-muted small">{{ event.start_at|date:"d/m/Y H:i" }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">Nenhum evento nos proximos dias.</div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-lg-5">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">Lembretes ativos</div>
      <div class="card-body">
        {% if reminder_rules %}
          <ul class="list-group list-group-flush">
            {% for rule in reminder_rules %}
              <li class="list-group-item d-flex justify-content-between">
                <span>{{ rule.target_type }}</span>
                <span class="text-muted small">{{ rule.remind_before_minutes }} min antes</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">Nenhuma regra ativa.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

--- FILE: templates/ui/auth_base.html ---
{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campus Calm - Acesso</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{% static 'css/app.css' %}" rel="stylesheet">
</head>
<body class="bg-auth">
  <div class="auth-shell">
    {% block content %}{% endblock %}
  </div>
</body>
</html>

--- FILE: templates/ui/dashboard.html ---
{% extends "base.html" %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h4 mb-1">Dashboard</h1>
    <div class="text-muted">Resumo da semana</div>
  </div>
  <form class="d-flex" method="get">
    <input class="form-control form-control-sm me-2" type="text" name="q" placeholder="Buscar tarefa ou evento"
           value="{{ search_query }}">
    <button class="btn btn-sm btn-outline-secondary" type="submit">Aplicar</button>
    <a class="btn btn-sm btn-link ms-2" href="/?clear=1">Limpar</a>
  </form>
</div>

{% if not onboarding_status.is_complete %}
<div class="alert alert-warning">
  <div class="fw-semibold">Onboarding incompleto</div>
  <div>Finalize as etapas pendentes para liberar todo o painel.</div>
  <a class="btn btn-sm btn-outline-dark mt-2" href="/onboarding/">Continuar configuracao</a>
</div>
{% endif %}

<div class="row g-3">
  <div class="col-md-3">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="text-muted small">Humor da semana</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.mood_most_common|default:"Sem dados" }}</div>
        <div class="text-muted small">{{ dashboard_data.mood_weekly_total }} registros</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="text-muted small">Minutos de foco</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.focus_minutes_week }}</div>
        <div class="text-muted small">ultimos 7 dias</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="text-muted small">Estresse da semana</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.stress_avg_week|default:"Sem dados" }}</div>
        <div class="text-muted small">media dos check-ins</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow-sm">
      <div class="card-body">
        <div class="text-muted small">Proximos prazos</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.upcoming_count }}</div>
        <div class="text-muted small">tarefas e eventos</div>
      </div>
    </div>
  </div>
</div>

<div class="row g-3 mt-3">
  <div class="col-lg-7">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">Proximos eventos</div>
      <div class="card-body">
        {% if dashboard_data.upcoming_events %}
          <ul class="list-group list-group-flush">
            {% for event in dashboard_data.upcoming_events %}
              <li class="list-group-item d-flex justify-content-between">
                <span>{{ event.title }}</span>
                <span class="text-muted small">{{ event.start_at|date:"d/m/Y H:i" }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">Nenhum evento nos proximos dias.</div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-lg-5">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">Tarefas proximas</div>
      <div class="card-body">
        {% if dashboard_data.upcoming_tasks %}
          <ul class="list-group list-group-flush">
            {% for task in dashboard_data.upcoming_tasks %}
              <li class="list-group-item d-flex justify-content-between">
                <span>{{ task.title }}</span>
                <span class="text-muted small">{{ task.due_date|date:"d/m/Y" }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">Nenhuma tarefa proxima.</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm mt-4">
  <div class="card-header bg-white fw-semibold">Status do Onboarding</div>
  <div class="card-body">
    <ul class="list-group list-group-flush">
      {% for step in onboarding_status.steps %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span>{{ step.label }}</span>
          {% if step.missing %}
            <span class="badge text-bg-warning">Pendente</span>
          {% else %}
            <span class="badge text-bg-success">Ok</span>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
    {% if not onboarding_status.is_complete %}
      <div class="mt-3">
        <a class="btn btn-primary btn-sm" href="/onboarding/">Continuar configuracao</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}

--- FILE: templates/ui/login.html ---
{% extends "ui/auth_base.html" %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">Bem-estar e organizacao para universitarios</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">Acesso ao painel</h1>
    <p class="text-muted small mb-4">Entre com seu email institucional ou pessoal para continuar.</p>

    {% if form.errors %}
      <div class="alert alert-danger">
        Email ou senha invalidos. Tente novamente.
      </div>
    {% endif %}

    <form method="post" novalidate>
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label">{{ form.username.label }}</label>
        {{ form.username }}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.password.label }}</label>
        <div class="input-group">
          {{ form.password }}
          <button class="btn btn-outline-secondary" type="button" id="toggle-password">Mostrar</button>
        </div>
      </div>
      <button type="submit" class="btn btn-primary w-100">Entrar</button>
    </form>

    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/password-reset/">Esqueci minha senha</a>
    </div>

    <div class="auth-footer text-muted small mt-4">
      Dica: use o mesmo login do sistema administrativo se ja tiver acesso.
    </div>
  </div>
</div>

<script>
  const toggleBtn = document.getElementById("toggle-password");
  const passwordInput = document.getElementById("id_password");
  if (toggleBtn && passwordInput) {
    toggleBtn.addEventListener("click", () => {
      const isPassword = passwordInput.getAttribute("type") === "password";
      passwordInput.setAttribute("type", isPassword ? "text" : "password");
      toggleBtn.textContent = isPassword ? "Ocultar" : "Mostrar";
    });
  }
</script>
{% endblock %}

--- FILE: templates/ui/onboarding.html ---
{% extends "base.html" %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">Onboarding</h1>
    <div class="text-muted">Etapas para completar a configuracao</div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <ul class="list-group list-group-flush">
      {% for step in steps %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <div class="fw-semibold">{{ step.label }}</div>
            <div class="text-muted small">{{ step.message }}</div>
          </div>
          {% if step.missing %}
            <span class="badge text-bg-warning"></span>
          {% else %}
            <span class="badge text-bg-success"></span>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
</div>

{% if required_actions %}
<div class="card shadow-sm mt-3">
  <div class="card-header bg-white fw-semibold">Acoes recomendadas</div>
  <div class="card-body">
    <ul class="mb-0">
      {% for action in required_actions %}
        <li>{{ action }}</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endif %}

<div class="card shadow-sm mt-3">
  <div class="card-header bg-white fw-semibold">Sugestoes rapidas</div>
  <div class="card-body">
    <ul class="mb-0">
      <li><a href="/semesters/">Ver semestres</a></li>
      <li><a href="/tasks/">Ver tarefas</a></li>
      <li><a href="/agenda/">Ver agenda</a></li>
      <li><a href="/api/semester/assessments/">Cadastrar avaliacao (API)</a></li>
    </ul>
  </div>
</div>
{% endblock %}

--- FILE: templates/ui/password_reset_complete.html ---
{% extends "ui/auth_base.html" %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">Senha atualizada</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">Senha redefinida</h1>
    <p class="text-muted small">Sua senha foi atualizada. Voce ja pode acessar o painel.</p>
    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/login/">Ir para o login</a>
    </div>
  </div>
</div>
{% endblock %}

--- FILE: templates/ui/password_reset_confirm.html ---
{% extends "ui/auth_base.html" %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">Nova senha</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">Definir nova senha</h1>
    <form method="post">
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label" for="id_new_password1">Nova senha</label>
        <input class="form-control" type="password" name="new_password1" id="id_new_password1" required>
      </div>
      <div class="mb-3">
        <label class="form-label" for="id_new_password2">Confirmar nova senha</label>
        <input class="form-control" type="password" name="new_password2" id="id_new_password2" required>
      </div>
      <button type="submit" class="btn btn-primary w-100">Atualizar senha</button>
    </form>
  </div>
</div>
{% endblock %}

--- FILE: templates/ui/password_reset_done.html ---
{% extends "ui/auth_base.html" %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">Email enviado</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">Verifique sua caixa de entrada</h1>
    <p class="text-muted small">Se o email existir no sistema, voce recebera um link para redefinir a senha.</p>
    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/login/">Voltar ao login</a>
    </div>
  </div>
</div>
{% endblock %}

--- FILE: templates/ui/password_reset_form.html ---
{% extends "ui/auth_base.html" %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">Recuperacao de acesso</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">Redefinir senha</h1>
    <p class="text-muted small mb-4">Informe seu email para receber o link de redefinicao.</p>

    <form method="post">
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label" for="id_email">Email</label>
        <input class="form-control" type="email" name="email" id="id_email" placeholder="seu.email@universidade.edu" required>
      </div>
      <button type="submit" class="btn btn-primary w-100">Enviar link</button>
    </form>

    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/login/">Voltar ao login</a>
    </div>
  </div>
</div>
{% endblock %}

--- FILE: templates/ui/semesters.html ---
{% extends "base.html" %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">Semestres</h1>
    <div class="text-muted">Resumo das disciplinas e progresso</div>
  </div>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-sm-4 col-md-2">
    <select class="form-select form-select-sm" name="status">
      <option value="">Todos os status</option>
      <option value="ACTIVE" {% if status_filter == "ACTIVE" %}selected{% endif %}>Ativo</option>
      <option value="FINISHED" {% if status_filter == "FINISHED" %}selected{% endif %}>Finalizado</option>
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="course" placeholder="Filtrar por disciplina"
           value="{{ course_query }}">
  </div>
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="teacher" placeholder="Filtrar por professor"
           value="{{ teacher_query }}">
  </div>
  <div class="col-auto">
    <button class="btn btn-sm btn-outline-secondary" type="submit">Filtrar</button>
    <a class="btn btn-sm btn-link" href="/semesters/?clear=1">Limpar</a>
  </div>
</form>

{% if semesters %}
  {% for semester in semesters %}
    <div class="card shadow-sm mb-3">
      <div class="card-header bg-white d-flex justify-content-between">
        <div class="fw-semibold">{{ semester.name }}</div>
        <div class="text-muted small">{{ semester.start_date|date:"d/m/Y" }} - {{ semester.end_date|date:"d/m/Y" }}</div>
      </div>
      <div class="card-body">
        {% if semester.courses %}
          <div class="table-responsive">
            <table class="table table-sm align-middle">
              <thead>
                <tr>
                  <th>Disciplina</th>
                  <th>Professor</th>
                  <th>Status</th>
                  <th>Media atual</th>
                  <th>Progresso</th>
                  <th>Falta para passar</th>
                </tr>
              </thead>
              <tbody>
                {% for course in semester.courses %}
                  <tr>
                    <td>{{ course.title }}</td>
                    <td>{{ course.teacher|default:"-" }}</td>
                    <td>
                      {% if course.status == "PASSED" %}
                        <span class="badge text-bg-success">Aprovado</span>
                      {% elif course.status == "FAILED" %}
                        <span class="badge text-bg-danger">Reprovado</span>
                      {% else %}
                        <span class="badge text-bg-secondary">Em andamento</span>
                      {% endif %}
                    </td>
                    <td>{{ course.current_average }}</td>
                    <td>{{ course.progress_percent }}%</td>
                    <td>{{ course.needed_to_pass }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="text-muted">Nenhuma disciplina cadastrada.</div>
        {% endif %}
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-info">Nenhum semestre cadastrado.</div>
{% endif %}
{% endblock %}

--- FILE: templates/ui/tasks.html ---
{% extends "base.html" %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">Tarefas</h1>
    <div class="text-muted">Lista de tarefas academicas</div>
  </div>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="q" placeholder="Buscar tarefa"
           value="{{ search_query }}">
  </div>
  <div class="col-sm-4 col-md-2">
    <select class="form-select form-select-sm" name="stress">
      <option value="">Stress</option>
      <option value="1" {% if stress_filter == "1" %}selected{% endif %}>1</option>
      <option value="2" {% if stress_filter == "2" %}selected{% endif %}>2</option>
      <option value="3" {% if stress_filter == "3" %}selected{% endif %}>3</option>
      <option value="4" {% if stress_filter == "4" %}selected{% endif %}>4</option>
      <option value="5" {% if stress_filter == "5" %}selected{% endif %}>5</option>
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="status">
      <option value="">Todos os status</option>
      <option value="TODO" {% if status_filter == "TODO" %}selected{% endif %}>A fazer</option>
      <option value="DOING" {% if status_filter == "DOING" %}selected{% endif %}>Em andamento</option>
      <option value="DONE" {% if status_filter == "DONE" %}selected{% endif %}>Concluida</option>
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="due">
      <option value="">Todas as datas</option>
      <option value="overdue" {% if due_filter == "overdue" %}selected{% endif %}>Atrasadas</option>
      <option value="today" {% if due_filter == "today" %}selected{% endif %}>Hoje</option>
      <option value="week" {% if due_filter == "week" %}selected{% endif %}>Proxima semana</option>
      <option value="month" {% if due_filter == "month" %}selected{% endif %}>Proximo mes</option>
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-sm btn-outline-secondary" type="submit">Filtrar</button>
    <a class="btn btn-sm btn-link" href="/tasks/?clear=1">Limpar</a>
  </div>
</form>

<div class="card shadow-sm">
  <div class="card-body">
    {% if tasks %}
      <div class="table-responsive">
        <table class="table table-sm align-middle">
          <thead>
            <tr>
              <th>Titulo</th>
              <th>Entrega</th>
              <th>Stress</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody>
            {% for task in tasks %}
              <tr>
                <td>
                  <div class="fw-semibold">{{ task.title }}</div>
                  <div class="text-muted small">{{ task.description|default:"" }}</div>
                </td>
                <td>{{ task.due_date|date:"d/m/Y" }}</td>
                <td>{{ task.stress_level }}</td>
                <td>
                  {% if task.status == "DONE" %}
                    <span class="badge text-bg-success">Concluida</span>
                  {% elif task.status == "DOING" %}
                    <span class="badge text-bg-primary">Em andamento</span>
                  {% else %}
                    <span class="badge text-bg-secondary">A fazer</span>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">Nenhuma tarefa cadastrada.</div>
    {% endif %}
  </div>
</div>
{% endblock %}

--- FILE: utils/__init__.py ---


--- FILE: utils/constants.py ---
PLAN_LITE = "LITE"
PLAN_PRO = "PRO"
PLAN_CHOICES = [
    (PLAN_LITE, "Lite"),
    (PLAN_PRO, "Pro"),
]

MOOD_VERY_BAD = "VERY_BAD"
MOOD_BAD = "BAD"
MOOD_OK = "OK"
MOOD_GOOD = "GOOD"
MOOD_VERY_GOOD = "VERY_GOOD"
MOOD_CHOICES = [
    (MOOD_VERY_BAD, "Very bad"),
    (MOOD_BAD, "Bad"),
    (MOOD_OK, "Ok"),
    (MOOD_GOOD, "Good"),
    (MOOD_VERY_GOOD, "Very good"),
]

POMODORO_COMPLETED = "COMPLETED"
POMODORO_STOPPED = "STOPPED"
POMODORO_STATUS_CHOICES = [
    (POMODORO_COMPLETED, "Completed"),
    (POMODORO_STOPPED, "Stopped"),
]

TASK_TODO = "TODO"
TASK_DOING = "DOING"
TASK_DONE = "DONE"
TASK_STATUS_CHOICES = [
    (TASK_TODO, "Todo"),
    (TASK_DOING, "Doing"),
    (TASK_DONE, "Done"),
]

EVENT_PROVA = "PROVA"
EVENT_ENTREGA = "ENTREGA"
EVENT_APRESENTACAO = "APRESENTACAO"
EVENT_AULA_IMPORTANTE = "AULA_IMPORTANTE"
EVENT_OUTRO = "OUTRO"
EVENT_TYPE_CHOICES = [
    (EVENT_PROVA, "Prova"),
    (EVENT_ENTREGA, "Entrega"),
    (EVENT_APRESENTACAO, "Apresentacao"),
    (EVENT_AULA_IMPORTANTE, "Aula importante"),
    (EVENT_OUTRO, "Outro"),
]

REMINDER_TARGET_TASK = "TASK"
REMINDER_TARGET_EVENT = "EVENT"
REMINDER_TARGET_CHOICES = [
    (REMINDER_TARGET_TASK, "Task"),
    (REMINDER_TARGET_EVENT, "Event"),
]

CHANNEL_EMAIL = "EMAIL"
CHANNEL_WHATSAPP = "WHATSAPP"
CHANNEL_SMS = "SMS"
CHANNEL_CHOICES = [
    (CHANNEL_EMAIL, "Email"),
    (CHANNEL_WHATSAPP, "WhatsApp"),
    (CHANNEL_SMS, "SMS"),
]

NOTIF_PENDING = "PENDING"
NOTIF_SENT = "SENT"
NOTIF_FAILED = "FAILED"
NOTIFICATION_STATUS_CHOICES = [
    (NOTIF_PENDING, "Pending"),
    (NOTIF_SENT, "Sent"),
    (NOTIF_FAILED, "Failed"),
]

SEMESTER_ACTIVE = "ACTIVE"
SEMESTER_FINISHED = "FINISHED"
SEMESTER_STATUS_CHOICES = [
    (SEMESTER_ACTIVE, "Active"),
    (SEMESTER_FINISHED, "Finished"),
]

COURSE_IN_PROGRESS = "IN_PROGRESS"
COURSE_PASSED = "PASSED"
COURSE_FAILED = "FAILED"
COURSE_STATUS_CHOICES = [
    (COURSE_IN_PROGRESS, "In progress"),
    (COURSE_PASSED, "Passed"),
    (COURSE_FAILED, "Failed"),
]

COACH_PRAZO_PROXIMO = "PRAZO_PROXIMO"
COACH_ATRASO = "ATRASO"
COACH_HUMOR_BAIXO = "HUMOR_BAIXO"
COACH_SEMESTRE_CONCLUIDO = "SEMESTRE_CONCLUIDO"
COACH_REPROVACAO = "REPROVACAO"
COACH_TRIGGER_CHOICES = [
    (COACH_PRAZO_PROXIMO, "Prazo proximo"),
    (COACH_ATRASO, "Atraso"),
    (COACH_HUMOR_BAIXO, "Humor baixo"),
    (COACH_SEMESTRE_CONCLUIDO, "Semestre concluido"),
    (COACH_REPROVACAO, "Reprovacao"),
]

CONTENT_PRE_PROVA = "PRE_PROVA"
CONTENT_ANTI_PROCRASTINACAO = "ANTI_PROCRASTINACAO"
CONTENT_FOCO = "FOCO"
CONTENT_CATEGORY_CHOICES = [
    (CONTENT_PRE_PROVA, "Pre-prova"),
    (CONTENT_ANTI_PROCRASTINACAO, "Anti-procrastinacao"),
    (CONTENT_FOCO, "Foco"),
]

REQUESTER_INDIVIDUAL = "INDIVIDUAL"
REQUESTER_INSTITUTION = "INSTITUTION"
REQUESTER_TYPE_CHOICES = [
    (REQUESTER_INDIVIDUAL, "Individual"),
    (REQUESTER_INSTITUTION, "Institution"),
]

ACCESS_PENDING = "PENDING"
ACCESS_APPROVED = "APPROVED"
ACCESS_REJECTED = "REJECTED"
ACCESS_STATUS_CHOICES = [
    (ACCESS_PENDING, "Pending"),
    (ACCESS_APPROVED, "Approved"),
    (ACCESS_REJECTED, "Rejected"),
]

STEP_1_PROFILE = "STEP_1_PROFILE"
STEP_2_SEMESTER = "STEP_2_SEMESTER"
STEP_3_COURSES = "STEP_3_COURSES"
STEP_4_ASSESSMENTS = "STEP_4_ASSESSMENTS"
STEP_5_REMINDERS = "STEP_5_REMINDERS"
STEP_6_DASHBOARD = "STEP_6_DASHBOARD"

FEATURE_MOOD_BASIC = "MOOD_BASIC"
FEATURE_POMODORO_BASIC = "POMODORO_BASIC"
FEATURE_PLANNER_BASIC = "PLANNER_BASIC"
FEATURE_AGENDA_BASIC = "AGENDA_BASIC"
FEATURE_IN_APP_REMINDERS = "IN_APP_REMINDERS"
FEATURE_DASHBOARD_BASIC = "DASHBOARD_BASIC"
FEATURE_CONTENT_LIMITED = "CONTENT_LIMITED"
FEATURE_EMAIL_NOTIFICATIONS = "EMAIL_NOTIFICATIONS"
FEATURE_REPORTS_ADVANCED = "REPORTS_ADVANCED"
FEATURE_SEMESTER_SUMMARY = "SEMESTER_SUMMARY"
FEATURE_COACH_ADVANCED = "COACH_ADVANCED"
FEATURE_CONTENT_FULL = "CONTENT_FULL"
FEATURE_WHATSAPP = "WHATSAPP"
FEATURE_SMS = "SMS"

--- FILE: utils/features.py ---
from typing import Optional

from rest_framework.exceptions import PermissionDenied

from billing.models import Plan, UserSubscription
from utils.constants import PLAN_LITE


def get_user_plan(user) -> Optional[Plan]:
    if not user or not getattr(user, "is_authenticated", False):
        return None
    subscription = (
        UserSubscription.objects.filter(user=user, is_active=True)
        .select_related("plan")
        .first()
    )
    if subscription and subscription.plan and subscription.plan.is_active:
        return subscription.plan
    return Plan.objects.filter(code=PLAN_LITE, is_active=True).first()


def has_feature(user, feature_name: str) -> bool:
    plan = get_user_plan(user)
    if not plan or plan.features is None:
        return False
    if isinstance(plan.features, list):
        return feature_name in plan.features
    if isinstance(plan.features, dict):
        return bool(plan.features.get(feature_name))
    return False


def require_feature(user, feature_name: str, message: Optional[str] = None) -> None:
    if not has_feature(user, feature_name):
        raise PermissionDenied(message or "Seu plano atual nao permite este recurso.")

--- FILE: utils/gating.py ---
from typing import List, Tuple

from utils.constants import (
    STEP_1_PROFILE,
    STEP_2_SEMESTER,
    STEP_3_COURSES,
    STEP_4_ASSESSMENTS,
    STEP_5_REMINDERS,
    STEP_6_DASHBOARD,
)

STEPS = [
    (STEP_1_PROFILE, "has_profile", "Complete seu perfil para continuar."),
    (STEP_2_SEMESTER, "has_active_semester", "Crie um semestre ativo."),
    (STEP_3_COURSES, "has_at_least_one_course", "Cadastre ao menos uma disciplina."),
    (STEP_4_ASSESSMENTS, "has_at_least_one_assessment", "Cadastre ao menos uma avaliacao."),
    (STEP_5_REMINDERS, "has_reminder_rule", "Configure pelo menos uma regra de lembrete."),
    (STEP_6_DASHBOARD, None, "Tudo pronto para seu dashboard."),
]


def get_or_create_progress(user):
    from onboarding.models import UserSetupProgress

    progress, _ = UserSetupProgress.objects.get_or_create(user=user)
    return progress


def compute_status(progress) -> Tuple[str, List[str], List[str]]:
    missing_steps = []
    required_actions = []
    for step, field, message in STEPS:
        if field is None:
            continue
        if not getattr(progress, field):
            missing_steps.append(step)
            required_actions.append(message)
    current_step = missing_steps[0] if missing_steps else STEP_6_DASHBOARD
    return current_step, missing_steps, required_actions


def gate_course_progress(course) -> Tuple[bool, str]:
    if not course.assessments.exists():
        return False, "Cadastre ao menos uma avaliacao antes de ver o progresso."
    return True, ""


def gate_finish_semester(semester) -> Tuple[bool, str]:
    if not semester.courses.exists():
        return False, "Nao e possivel finalizar um semestre sem disciplinas."
    return True, ""


def gate_generate_reminders(user) -> Tuple[bool, str]:
    from agenda.models import ReminderRule

    if not ReminderRule.objects.filter(user=user, is_active=True).exists():
        return False, "Configure uma regra de lembrete antes de gerar notificacoes."
    return True, ""

--- FILE: utils/triage.py ---
import os
from typing import Dict

from utils.constants import (
    FEATURE_COACH_ADVANCED,
    FEATURE_EMAIL_NOTIFICATIONS,
    FEATURE_REPORTS_ADVANCED,
    FEATURE_SMS,
    FEATURE_WHATSAPP,
    PLAN_LITE,
    PLAN_PRO,
    REQUESTER_INSTITUTION,
)

TRIAGE_MODEL_NAME = os.getenv("TRIAGE_MODEL_NAME", "mock-v1")
TRIAGE_USE_LLM = os.getenv("TRIAGE_USE_LLM", "false").lower() == "true"


def rule_based_plan(access_request) -> str:
    if access_request.requester_type == REQUESTER_INSTITUTION:
        return PLAN_PRO
    if access_request.estimated_users and access_request.estimated_users >= 50:
        return PLAN_PRO
    wants = set(access_request.wants_features or [])
    pro_features = {
        FEATURE_REPORTS_ADVANCED,
        FEATURE_EMAIL_NOTIFICATIONS,
        FEATURE_WHATSAPP,
        FEATURE_SMS,
        FEATURE_COACH_ADVANCED,
    }
    if wants.intersection(pro_features):
        return PLAN_PRO
    return PLAN_LITE


def mock_ai_output(recommended_plan: str) -> Dict[str, object]:
    if recommended_plan == PLAN_PRO:
        score = 82
        rationale = "Solicitacao com sinais de necessidade avancada."
    else:
        score = 28
        rationale = "Solicitacao adequada ao plano basico."
    return {
        "score": score,
        "recommended_plan": recommended_plan,
        "rationale": rationale,
        "llm_enabled": TRIAGE_USE_LLM,
    }


def run_triage(access_request) -> Dict[str, object]:
    recommended_plan = rule_based_plan(access_request)
    output = mock_ai_output(recommended_plan)
    return {
        "recommended_plan": recommended_plan,
        "output_payload": output,
    }

### locale/en/LC_MESSAGES/django.po
--------------------------------------------------------------------------------
msgid ""
msgstr ""
"Project-Id-Version: Campus Calm\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2026-02-02 11:09-0300\n"
"PO-Revision-Date: 2026-01-29 13:10+0000\n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: en\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=2; plural=(n != 1);\n"

#: apps/ui/forms.py:8 apps/ui/forms.py:27 docs/full_dump_atual.txt:9526
#: templates/ui/password_reset_form.html:17
msgid "Email"
msgstr "Email"

#: apps/ui/forms.py:12 apps/ui/forms.py:41
msgid "Senha"
msgstr ""

#: apps/ui/forms.py:22
msgid "Free"
msgstr ""

#: apps/ui/forms.py:23
msgid "Pago"
msgstr ""

#: apps/ui/forms.py:26 docs/full_dump_atual.txt:9908
#: templates/ui/semester/semester_list.html:27
msgid "Nome"
msgstr "Name"

#: apps/ui/forms.py:29
msgid "Telefone (WhatsApp)"
msgstr ""

#: apps/ui/forms.py:35
msgid "Plano"
msgstr ""

#: apps/ui/forms.py:46
#, fuzzy
#| msgid "Confirmar nova senha"
msgid "Confirmar senha"
msgstr "Confirm new password"

#: apps/ui/forms.py:51
msgid "Receber email"
msgstr ""

#: apps/ui/forms.py:57
msgid "Receber WhatsApp"
msgstr ""

#: apps/ui/forms.py:63
msgid "Receber SMS"
msgstr ""

#: apps/ui/forms.py:72
msgid "As senhas nao conferem."
msgstr ""

#: apps/ui/forms_academic.py:13
msgid "Nome do semestre"
msgstr "Semester name"

#: apps/ui/forms_academic.py:14
msgid "Data de inicio"
msgstr "Start date"

#: apps/ui/forms_academic.py:15
msgid "Data de termino"
msgstr "End date"

#: apps/ui/forms_academic.py:16 apps/ui/forms_academic.py:35
#: apps/ui/forms_tasks.py:16 docs/full_dump_atual.txt:8924
#: docs/full_dump_atual.txt:9279 docs/full_dump_atual.txt:9315
#: docs/full_dump_atual.txt:9670 docs/full_dump_atual.txt:9768
#: docs/full_dump_atual.txt:9795 docs/full_dump_atual.txt:9911
#: docs/full_dump_atual.txt:9989 docs/full_dump_atual.txt:10092
#: docs/full_dump_atual.txt:10195 docs/full_dump_atual.txt:10222
#: docs/full_dump_atual.txt:10312 templates/ui/course/course_detail.html:48
#: templates/ui/messages/message_list.html:23
#: templates/ui/messages/message_list.html:60
#: templates/ui/reminders/reminder_list.html:37
#: templates/ui/semester/semester_detail.html:31
#: templates/ui/semester/semester_detail.html:58
#: templates/ui/semester/semester_list.html:30 templates/ui/semesters.html:49
#: templates/ui/tasks.html:60 templates/ui/tasks/task_detail.html:29
#: templates/ui/tasks/task_list.html:28 templates/ui/tasks/task_list.html:55
msgid "Status"
msgstr "Status"

#: apps/ui/forms_academic.py:31
msgid "Nome da disciplina"
msgstr "Course name"

#: apps/ui/forms_academic.py:32 docs/full_dump_atual.txt:9794
#: docs/full_dump_atual.txt:9988 templates/ui/semester/semester_detail.html:57
#: templates/ui/semesters.html:48
msgid "Professor"
msgstr "Instructor"

#: apps/ui/forms_academic.py:33
msgid "Creditos"
msgstr "Credits"

#: apps/ui/forms_academic.py:34 docs/full_dump_atual.txt:8912
#: templates/ui/course/course_detail.html:36
msgid "Nota minima"
msgstr "Passing grade"

#: apps/ui/forms_academic.py:36
msgid "Nota final"
msgstr "Final grade"

#: apps/ui/forms_academic.py:37
msgid "Anotacoes"
msgstr "Notes"

#: apps/ui/forms_academic.py:52
msgid "A nota minima deve ser maior que zero."
msgstr "The minimum grade must be greater than zero."

#: apps/ui/forms_academic.py:61 apps/ui/forms_agenda.py:13
#: apps/ui/forms_tasks.py:12 docs/full_dump_atual.txt:9313
#: docs/full_dump_atual.txt:10309 templates/ui/messages/message_list.html:58
#: templates/ui/tasks.html:57
msgid "Titulo"
msgstr "Title"

#: apps/ui/forms_academic.py:62
msgid "Nota obtida"
msgstr "Score"

#: apps/ui/forms_academic.py:63
msgid "Nota maxima"
msgstr "Max score"

#: apps/ui/forms_academic.py:64 docs/full_dump_atual.txt:8950
#: templates/ui/course/course_detail.html:74
msgid "Peso"
msgstr "Weight"

#: apps/ui/forms_academic.py:65 docs/full_dump_atual.txt:8951
#: templates/ui/course/course_detail.html:75
msgid "Data"
msgstr "Date"

#: apps/ui/forms_academic.py:81
msgid "A nota obtida nao pode ser maior que a nota maxima."
msgstr "The score cannot be greater than the max score."

#: apps/ui/forms_academic.py:83
msgid "O peso deve ser maior ou igual a zero."
msgstr "The weight must be greater than or equal to zero."

#: apps/ui/forms_agenda.py:14 docs/full_dump_atual.txt:8599
#: docs/full_dump_atual.txt:9667 templates/ui/agenda/agenda_list.html:28
#: templates/ui/reminders/reminder_list.html:34
msgid "Tipo"
msgstr "Type"

#: apps/ui/forms_agenda.py:15 docs/full_dump_atual.txt:8600
#: docs/full_dump_atual.txt:9772 docs/full_dump_atual.txt:9909
#: templates/ui/agenda/agenda_list.html:29
#: templates/ui/semester/semester_detail.html:35
#: templates/ui/semester/semester_list.html:28
msgid "Inicio"
msgstr "Start"

#: apps/ui/forms_agenda.py:16 docs/full_dump_atual.txt:8601
#: templates/ui/agenda/agenda_list.html:30
msgid "Fim"
msgstr "End"

#: apps/ui/forms_agenda.py:17
msgid "Tarefa relacionada"
msgstr "Related task"

#: apps/ui/forms_agenda.py:18
msgid "Observacoes"
msgstr "Notes"

#: apps/ui/forms_agenda.py:43
msgid "Estudos"
msgstr "Studies"

#: apps/ui/forms_reminders.py:19 docs/full_dump_atual.txt:9669
#: templates/ui/reminders/reminder_list.html:36
msgid "Canais"
msgstr "Channels"

#: apps/ui/forms_reminders.py:27
msgid "Tipo de alvo"
msgstr "Target type"

#: apps/ui/forms_reminders.py:28 docs/full_dump_atual.txt:9668
#: templates/ui/reminders/reminder_list.html:35
msgid "Minutos antes"
msgstr "Minutes before"

#: apps/ui/forms_reminders.py:29 docs/full_dump_atual.txt:9688
#: docs/full_dump_atual.txt:9956 templates/ui/reminders/reminder_list.html:55
#: templates/ui/semesters.html:16
msgid "Ativo"
msgstr "Active"

#: apps/ui/forms_reminders.py:45
msgid "Informe um valor maior que zero."
msgstr "Enter a value greater than zero."

#: apps/ui/forms_tasks.py:13 docs/full_dump_atual.txt:10100
#: templates/ui/tasks/task_detail.html:37
msgid "Descricao"
msgstr "Description"

#: apps/ui/forms_tasks.py:14
msgid "Data de entrega"
msgstr "Due date"

#: apps/ui/forms_tasks.py:15
msgid "Nivel de estresse(0 a 5)"
msgstr "Stress level (0 to 5)"

#: apps/ui/views.py:41
msgid "Perfil"
msgstr "Profile"

#: apps/ui/views.py:42
msgid "Semestre"
msgstr "Semester"

#: apps/ui/views.py:43 docs/full_dump_atual.txt:9786
#: templates/ui/semester/semester_detail.html:49
msgid "Disciplinas"
msgstr "Courses"

#: apps/ui/views.py:44 docs/full_dump_atual.txt:8941
#: templates/ui/course/course_detail.html:65
msgid "Avaliacoes"
msgstr "Assessments"

#: apps/ui/views.py:45 docs/full_dump_atual.txt:8436
#: docs/full_dump_atual.txt:9548 docs/full_dump_atual.txt:9575
#: docs/full_dump_atual.txt:9648 docs/full_dump_atual.txt:9654
#: templates/base.html:62 templates/ui/reminders/reminder_confirm_delete.html:8
#: templates/ui/reminders/reminder_form.html:8
#: templates/ui/reminders/reminder_list.html:8
#: templates/ui/reminders/reminder_list.html:14
msgid "Lembretes"
msgstr "Reminders"

#: apps/ui/views.py:46 docs/full_dump_atual.txt:8421
#: docs/full_dump_atual.txt:8493 docs/full_dump_atual.txt:8520
#: docs/full_dump_atual.txt:8578 docs/full_dump_atual.txt:8722
#: docs/full_dump_atual.txt:8751 docs/full_dump_atual.txt:8855
#: docs/full_dump_atual.txt:8883 docs/full_dump_atual.txt:8986
#: docs/full_dump_atual.txt:9046 docs/full_dump_atual.txt:9263
#: docs/full_dump_atual.txt:9547 docs/full_dump_atual.txt:9574
#: docs/full_dump_atual.txt:9647 docs/full_dump_atual.txt:9717
#: docs/full_dump_atual.txt:9744 docs/full_dump_atual.txt:9830
#: docs/full_dump_atual.txt:9888 docs/full_dump_atual.txt:10043
#: docs/full_dump_atual.txt:10070 docs/full_dump_atual.txt:10116
#: docs/full_dump_atual.txt:10174 templates/base.html:47
#: templates/ui/agenda/agenda_confirm_delete.html:7
#: templates/ui/agenda/agenda_form.html:7
#: templates/ui/agenda/agenda_list.html:7
#: templates/ui/assessment/assessment_confirm_delete.html:7
#: templates/ui/assessment/assessment_form.html:7
#: templates/ui/course/course_confirm_delete.html:7
#: templates/ui/course/course_detail.html:7
#: templates/ui/course/course_form.html:7 templates/ui/dashboard.html:8
#: templates/ui/messages/message_list.html:7
#: templates/ui/reminders/reminder_confirm_delete.html:7
#: templates/ui/reminders/reminder_form.html:7
#: templates/ui/reminders/reminder_list.html:7
#: templates/ui/semester/semester_confirm_delete.html:7
#: templates/ui/semester/semester_detail.html:7
#: templates/ui/semester/semester_form.html:7
#: templates/ui/semester/semester_list.html:7
#: templates/ui/tasks/task_confirm_delete.html:7
#: templates/ui/tasks/task_detail.html:7 templates/ui/tasks/task_form.html:7
#: templates/ui/tasks/task_list.html:7
msgid "Dashboard"
msgstr "Dashboard"

#: apps/ui/views.py:61
msgid "Concluido"
msgstr "Completed"

#: apps/ui/views.py:80
msgid "Ja existe um usuario com este email."
msgstr ""

#: apps/ui/views.py:104
msgid "Conta criada com sucesso. Faca login para continuar."
msgstr ""

#: apps/ui/views_academic.py:25
msgid "Semestre criado com sucesso."
msgstr "Semester created successfully."

#: apps/ui/views_academic.py:50
msgid "Semestre atualizado com sucesso."
msgstr "Semester updated successfully."

#: apps/ui/views_academic.py:66
msgid "Semestre excluido com sucesso."
msgstr "Semester deleted successfully."

#: apps/ui/views_academic.py:84
msgid "Disciplina criada com sucesso."
msgstr "Course created successfully."

#: apps/ui/views_academic.py:114
msgid "Disciplina atualizada com sucesso."
msgstr "Course updated successfully."

#: apps/ui/views_academic.py:131
msgid "Disciplina excluida com sucesso."
msgstr "Course deleted successfully."

#: apps/ui/views_academic.py:149
msgid "Avaliacao criada com sucesso."
msgstr "Assessment created successfully."

#: apps/ui/views_academic.py:167
msgid "Avaliacao atualizada com sucesso."
msgstr "Assessment updated successfully."

#: apps/ui/views_academic.py:184
msgid "Avaliacao excluida com sucesso."
msgstr "Assessment deleted successfully."

#: apps/ui/views_agenda.py:35
msgid "Evento criado com sucesso."
msgstr "Event created successfully."

#: apps/ui/views_agenda.py:51
msgid "Evento atualizado com sucesso."
msgstr "Event updated successfully."

#: apps/ui/views_agenda.py:63
msgid "Evento excluido com sucesso."
msgstr "Event deleted successfully."

#: apps/ui/views_reminders.py:25
#, fuzzy
#| msgid "Semestre criado com sucesso."
msgid "Lembretes gerados com sucesso."
msgstr "Semester created successfully."

#: apps/ui/views_reminders.py:27
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Nenhum lembrete novo foi gerado."
msgstr "No semesters registered."

#: apps/ui/views_reminders.py:39
msgid "Regra de lembrete criada com sucesso."
msgstr "Reminder rule created successfully."

#: apps/ui/views_reminders.py:53
msgid "Regra de lembrete atualizada com sucesso."
msgstr "Reminder rule updated successfully."

#: apps/ui/views_reminders.py:69
msgid "Regra de lembrete excluida com sucesso."
msgstr "Reminder rule deleted successfully."

#: apps/ui/views_tasks.py:47
msgid "Tarefa criada com sucesso."
msgstr "Task created successfully."

#: apps/ui/views_tasks.py:69
msgid "Tarefa atualizada com sucesso."
msgstr "Task updated successfully."

#: apps/ui/views_tasks.py:81
msgid "Tarefa excluida com sucesso."
msgstr "Task deleted successfully."

#: config/settings.py:104
msgid "English"
msgstr ""

#: config/settings.py:105
msgid "Portugus (Brasil)"
msgstr ""

#: config/settings.py:106
msgid "Portugus (Portugal)"
msgstr ""

#: docs/full_dump_atual.txt:8397 templates/base.html:23
msgid "Painel do aluno"
msgstr "Student dashboard"

#: docs/full_dump_atual.txt:8400 templates/base.html:26
#, python-format
msgid "Ol, %(name)s"
msgstr "Hello, %(name)s"

#: docs/full_dump_atual.txt:8405 docs/full_dump_atual.txt:8826
#: templates/base.html:31 templates/ui/auth_base.html:22
msgid "Idioma"
msgstr "Language"

#: docs/full_dump_atual.txt:8424 docs/full_dump_atual.txt:9386
#: templates/base.html:50 templates/ui/onboarding.html:7
msgid "Onboarding"
msgstr "Onboarding"

#: docs/full_dump_atual.txt:8427 docs/full_dump_atual.txt:8723
#: docs/full_dump_atual.txt:8752 docs/full_dump_atual.txt:8856
#: docs/full_dump_atual.txt:8884 docs/full_dump_atual.txt:8987
#: docs/full_dump_atual.txt:9718 docs/full_dump_atual.txt:9745
#: docs/full_dump_atual.txt:9831 docs/full_dump_atual.txt:9889
#: docs/full_dump_atual.txt:9895 docs/full_dump_atual.txt:9947
#: templates/base.html:53
#: templates/ui/assessment/assessment_confirm_delete.html:8
#: templates/ui/assessment/assessment_form.html:8
#: templates/ui/course/course_confirm_delete.html:8
#: templates/ui/course/course_detail.html:8
#: templates/ui/course/course_form.html:8
#: templates/ui/semester/semester_confirm_delete.html:8
#: templates/ui/semester/semester_detail.html:8
#: templates/ui/semester/semester_form.html:8
#: templates/ui/semester/semester_list.html:8
#: templates/ui/semester/semester_list.html:14 templates/ui/semesters.html:7
msgid "Semestres"
msgstr "Semesters"

#: docs/full_dump_atual.txt:8430 docs/full_dump_atual.txt:10044
#: docs/full_dump_atual.txt:10071 docs/full_dump_atual.txt:10117
#: docs/full_dump_atual.txt:10175 docs/full_dump_atual.txt:10181
#: docs/full_dump_atual.txt:10259 templates/base.html:56
#: templates/ui/tasks.html:7 templates/ui/tasks/task_confirm_delete.html:8
#: templates/ui/tasks/task_detail.html:8 templates/ui/tasks/task_form.html:8
#: templates/ui/tasks/task_list.html:8 templates/ui/tasks/task_list.html:14
msgid "Tarefas"
msgstr "Tasks"

#: docs/full_dump_atual.txt:8433 docs/full_dump_atual.txt:8494
#: docs/full_dump_atual.txt:8521 docs/full_dump_atual.txt:8579
#: docs/full_dump_atual.txt:8585 docs/full_dump_atual.txt:8636
#: templates/base.html:59 templates/ui/agenda.html:7
#: templates/ui/agenda/agenda_confirm_delete.html:8
#: templates/ui/agenda/agenda_form.html:8
#: templates/ui/agenda/agenda_list.html:8
#: templates/ui/agenda/agenda_list.html:14
msgid "Agenda"
msgstr "Calendar"

#: docs/full_dump_atual.txt:8439 docs/full_dump_atual.txt:9264
#: docs/full_dump_atual.txt:9270 docs/full_dump_atual.txt:9349
#: templates/base.html:65 templates/ui/messages.html:7
#: templates/ui/messages/message_list.html:8
#: templates/ui/messages/message_list.html:14
msgid "Mensagens"
msgstr "Messages"

#: docs/full_dump_atual.txt:8445 templates/base.html:71
msgid "Sair"
msgstr "Sign out"

#: docs/full_dump_atual.txt:8457 templates/base.html:83
msgid "Fechar"
msgstr ""

#: docs/full_dump_atual.txt:8495 docs/full_dump_atual.txt:8501
#: templates/ui/agenda/agenda_confirm_delete.html:9
#: templates/ui/agenda/agenda_confirm_delete.html:15
msgid "Excluir evento"
msgstr "Delete event"

#: docs/full_dump_atual.txt:8502
#: templates/ui/agenda/agenda_confirm_delete.html:16
msgid "Tem certeza que deseja excluir o evento"
msgstr "Are you sure you want to delete the event"

#: docs/full_dump_atual.txt:8505 docs/full_dump_atual.txt:8736
#: docs/full_dump_atual.txt:8868 docs/full_dump_atual.txt:9559
#: docs/full_dump_atual.txt:9729 docs/full_dump_atual.txt:10055
#: templates/ui/agenda/agenda_confirm_delete.html:19
#: templates/ui/assessment/assessment_confirm_delete.html:21
#: templates/ui/course/course_confirm_delete.html:20
#: templates/ui/reminders/reminder_confirm_delete.html:19
#: templates/ui/semester/semester_confirm_delete.html:19
#: templates/ui/tasks/task_confirm_delete.html:19
msgid "Cancelar"
msgstr "Cancel"

#: docs/full_dump_atual.txt:8506 docs/full_dump_atual.txt:8614
#: docs/full_dump_atual.txt:8737 docs/full_dump_atual.txt:8869
#: docs/full_dump_atual.txt:8964 docs/full_dump_atual.txt:9560
#: docs/full_dump_atual.txt:9695 docs/full_dump_atual.txt:9730
#: docs/full_dump_atual.txt:9808 docs/full_dump_atual.txt:9925
#: docs/full_dump_atual.txt:10056 docs/full_dump_atual.txt:10084
#: docs/full_dump_atual.txt:10237
#: templates/ui/agenda/agenda_confirm_delete.html:20
#: templates/ui/agenda/agenda_list.html:43
#: templates/ui/assessment/assessment_confirm_delete.html:22
#: templates/ui/course/course_confirm_delete.html:21
#: templates/ui/course/course_detail.html:88
#: templates/ui/reminders/reminder_confirm_delete.html:20
#: templates/ui/reminders/reminder_list.html:62
#: templates/ui/semester/semester_confirm_delete.html:20
#: templates/ui/semester/semester_detail.html:71
#: templates/ui/semester/semester_list.html:44
#: templates/ui/tasks/task_confirm_delete.html:20
#: templates/ui/tasks/task_detail.html:21 templates/ui/tasks/task_list.html:70
msgid "Excluir"
msgstr "Delete"

#: docs/full_dump_atual.txt:8523 docs/full_dump_atual.txt:8533
#: templates/ui/agenda/agenda_form.html:10
#: templates/ui/agenda/agenda_form.html:20
msgid "Editar evento"
msgstr "Edit event"

#: docs/full_dump_atual.txt:8525 docs/full_dump_atual.txt:8536
#: docs/full_dump_atual.txt:8588 templates/ui/agenda/agenda_form.html:12
#: templates/ui/agenda/agenda_form.html:23
#: templates/ui/agenda/agenda_list.html:17
msgid "Novo evento"
msgstr "New event"

#: docs/full_dump_atual.txt:8537 templates/ui/agenda/agenda_form.html:24
msgid "Cadastre um novo evento."
msgstr "Create a new event."

#: docs/full_dump_atual.txt:8540 docs/full_dump_atual.txt:8773
#: docs/full_dump_atual.txt:8896 docs/full_dump_atual.txt:9007
#: docs/full_dump_atual.txt:9594 docs/full_dump_atual.txt:9758
#: docs/full_dump_atual.txt:9850 docs/full_dump_atual.txt:10082
#: docs/full_dump_atual.txt:10136 templates/ui/agenda/agenda_form.html:27
#: templates/ui/assessment/assessment_form.html:29
#: templates/ui/course/course_detail.html:20
#: templates/ui/course/course_form.html:28
#: templates/ui/reminders/reminder_form.html:27
#: templates/ui/semester/semester_detail.html:21
#: templates/ui/semester/semester_form.html:27
#: templates/ui/tasks/task_detail.html:19 templates/ui/tasks/task_form.html:27
msgid "Voltar"
msgstr "Back"

#: docs/full_dump_atual.txt:8563 docs/full_dump_atual.txt:8796
#: docs/full_dump_atual.txt:9030 docs/full_dump_atual.txt:9632
#: docs/full_dump_atual.txt:9873 docs/full_dump_atual.txt:10159
#: templates/ui/agenda/agenda_form.html:50
#: templates/ui/assessment/assessment_form.html:52
#: templates/ui/course/course_form.html:51
#: templates/ui/reminders/reminder_form.html:65
#: templates/ui/semester/semester_form.html:50
#: templates/ui/tasks/task_form.html:50
msgid "Salvar"
msgstr "Save"

#: docs/full_dump_atual.txt:8563 docs/full_dump_atual.txt:8796
#: docs/full_dump_atual.txt:9030 docs/full_dump_atual.txt:9632
#: docs/full_dump_atual.txt:9873 docs/full_dump_atual.txt:10159
#: templates/ui/agenda/agenda_form.html:50
#: templates/ui/assessment/assessment_form.html:52
#: templates/ui/course/course_form.html:51
#: templates/ui/reminders/reminder_form.html:65
#: templates/ui/semester/semester_form.html:50
#: templates/ui/tasks/task_form.html:50
msgid "Criar"
msgstr "Create"

#: docs/full_dump_atual.txt:8586 templates/ui/agenda/agenda_list.html:15
msgid "Seus eventos e compromissos."
msgstr "Your events and appointments."

#: docs/full_dump_atual.txt:8598 templates/ui/agenda/agenda_list.html:27
#: utils/constants.py:62
msgid "Evento"
msgstr "Event"

#: docs/full_dump_atual.txt:8602 docs/full_dump_atual.txt:8952
#: docs/full_dump_atual.txt:9671 docs/full_dump_atual.txt:9796
#: docs/full_dump_atual.txt:9912 docs/full_dump_atual.txt:10224
#: templates/ui/agenda/agenda_list.html:31
#: templates/ui/course/course_detail.html:76
#: templates/ui/reminders/reminder_list.html:38
#: templates/ui/semester/semester_detail.html:59
#: templates/ui/semester/semester_list.html:31
#: templates/ui/tasks/task_list.html:57
msgid "Acoes"
msgstr "Actions"

#: docs/full_dump_atual.txt:8613 docs/full_dump_atual.txt:8897
#: docs/full_dump_atual.txt:8963 docs/full_dump_atual.txt:9694
#: docs/full_dump_atual.txt:9759 docs/full_dump_atual.txt:9807
#: docs/full_dump_atual.txt:9924 docs/full_dump_atual.txt:10083
#: docs/full_dump_atual.txt:10236 templates/ui/agenda/agenda_list.html:42
#: templates/ui/course/course_detail.html:21
#: templates/ui/course/course_detail.html:87
#: templates/ui/reminders/reminder_list.html:61
#: templates/ui/semester/semester_detail.html:22
#: templates/ui/semester/semester_detail.html:70
#: templates/ui/semester/semester_list.html:43
#: templates/ui/tasks/task_detail.html:20 templates/ui/tasks/task_list.html:69
msgid "Editar"
msgstr "Edit"

#: docs/full_dump_atual.txt:8622 templates/ui/agenda/agenda_list.html:51
msgid "Nenhum evento cadastrado."
msgstr "No events registered."

#: docs/full_dump_atual.txt:8637 templates/ui/agenda.html:8
#, python-format
msgid "Eventos dos proximos %(days)s dias"
msgstr "Events for the next %(days)s days"

#: docs/full_dump_atual.txt:8643 templates/ui/agenda.html:14
msgid "Buscar evento"
msgstr "Search event"

#: docs/full_dump_atual.txt:8648 templates/ui/agenda.html:19
msgid "Todos os tipos"
msgstr "All types"

#: docs/full_dump_atual.txt:8656 templates/ui/agenda.html:27
msgid "Proximos 7 dias"
msgstr "Next 7 days"

#: docs/full_dump_atual.txt:8657 templates/ui/agenda.html:28
msgid "Proximos 15 dias"
msgstr "Next 15 days"

#: docs/full_dump_atual.txt:8658 templates/ui/agenda.html:29
msgid "Proximos 30 dias"
msgstr "Next 30 days"

#: docs/full_dump_atual.txt:8659 templates/ui/agenda.html:30
msgid "Proximos 60 dias"
msgstr "Next 60 days"

#: docs/full_dump_atual.txt:8660 templates/ui/agenda.html:31
msgid "Proximos 90 dias"
msgstr "Next 90 days"

#: docs/full_dump_atual.txt:8664 docs/full_dump_atual.txt:9297
#: docs/full_dump_atual.txt:9969 docs/full_dump_atual.txt:10204
#: docs/full_dump_atual.txt:10297 templates/ui/agenda.html:35
#: templates/ui/messages/message_list.html:41 templates/ui/semesters.html:29
#: templates/ui/tasks.html:45 templates/ui/tasks/task_list.html:37
msgid "Filtrar"
msgstr "Filter"

#: docs/full_dump_atual.txt:8665 docs/full_dump_atual.txt:9053
#: docs/full_dump_atual.txt:9300 docs/full_dump_atual.txt:9970
#: docs/full_dump_atual.txt:10207 docs/full_dump_atual.txt:10298
#: templates/ui/agenda.html:36 templates/ui/dashboard.html:15
#: templates/ui/messages/message_list.html:44 templates/ui/semesters.html:30
#: templates/ui/tasks.html:46 templates/ui/tasks/task_list.html:40
msgid "Limpar"
msgstr "Clear"

#: docs/full_dump_atual.txt:8672 templates/ui/agenda.html:43
msgid "Eventos"
msgstr "Events"

#: docs/full_dump_atual.txt:8687 docs/full_dump_atual.txt:9119
#: templates/ui/agenda.html:58 templates/ui/dashboard.html:81
msgid "Nenhum evento nos proximos dias."
msgstr "No events in the next few days."

#: docs/full_dump_atual.txt:8694 templates/ui/agenda.html:65
msgid "Lembretes ativos"
msgstr "Active reminders"

#: docs/full_dump_atual.txt:8701 templates/ui/agenda.html:72
#, python-format
msgid "%(minutes)s min antes"
msgstr "%(minutes)s min before"

#: docs/full_dump_atual.txt:8706 templates/ui/agenda.html:77
msgid "Nenhuma regra ativa."
msgstr "No active rule."

#: docs/full_dump_atual.txt:8726 docs/full_dump_atual.txt:8732
#: templates/ui/assessment/assessment_confirm_delete.html:11
#: templates/ui/assessment/assessment_confirm_delete.html:17
msgid "Excluir avaliacao"
msgstr "Delete assessment"

#: docs/full_dump_atual.txt:8733
#: templates/ui/assessment/assessment_confirm_delete.html:18
msgid "Tem certeza que deseja excluir a avaliacao"
msgstr "Are you sure you want to delete the assessment"

#: docs/full_dump_atual.txt:8756 docs/full_dump_atual.txt:8766
#: templates/ui/assessment/assessment_form.html:12
#: templates/ui/assessment/assessment_form.html:22
msgid "Editar avaliacao"
msgstr "Edit assessment"

#: docs/full_dump_atual.txt:8758 docs/full_dump_atual.txt:8769
#: templates/ui/assessment/assessment_form.html:14
#: templates/ui/assessment/assessment_form.html:25
msgid "Nova avaliacao"
msgstr "New assessment"

#: docs/full_dump_atual.txt:8814 templates/ui/auth_base.html:10
msgid "Campus Calm - Acesso"
msgstr "Campus Calm - Access"

#: docs/full_dump_atual.txt:8858 docs/full_dump_atual.txt:8864
#: templates/ui/course/course_confirm_delete.html:10
#: templates/ui/course/course_confirm_delete.html:16
msgid "Excluir disciplina"
msgstr "Delete course"

#: docs/full_dump_atual.txt:8865
#: templates/ui/course/course_confirm_delete.html:17
msgid "Tem certeza que deseja excluir a disciplina"
msgstr "Are you sure you want to delete the course"

#: docs/full_dump_atual.txt:8898 templates/ui/course/course_detail.html:22
msgid "Nova Avaliacao"
msgstr "New assessment"

#: docs/full_dump_atual.txt:8904 templates/ui/course/course_detail.html:28
msgid "Cadastre ao menos uma avaliacao para calcular a barra de progresso."
msgstr "Add at least one assessment to calculate the progress bar."

#: docs/full_dump_atual.txt:8916 docs/full_dump_atual.txt:9990
#: templates/ui/course/course_detail.html:40 templates/ui/semesters.html:50
msgid "Media atual"
msgstr "Current average"

#: docs/full_dump_atual.txt:8920 docs/full_dump_atual.txt:9992
#: templates/ui/course/course_detail.html:44 templates/ui/semesters.html:52
msgid "Falta para passar"
msgstr "Needed to pass"

#: docs/full_dump_atual.txt:8948 templates/ui/course/course_detail.html:72
msgid "Avaliacao"
msgstr "Assessment"

#: docs/full_dump_atual.txt:8949 templates/ui/course/course_detail.html:73
msgid "Nota"
msgstr "Score"

#: docs/full_dump_atual.txt:8972 templates/ui/course/course_detail.html:96
msgid "Nenhuma avaliacao cadastrada."
msgstr "No assessments registered."

#: docs/full_dump_atual.txt:8990 docs/full_dump_atual.txt:9000
#: templates/ui/course/course_form.html:11
#: templates/ui/course/course_form.html:21
msgid "Editar disciplina"
msgstr "Edit course"

#: docs/full_dump_atual.txt:8992 docs/full_dump_atual.txt:9003
#: templates/ui/course/course_form.html:13
#: templates/ui/course/course_form.html:24
msgid "Nova disciplina"
msgstr "New course"

#: docs/full_dump_atual.txt:9043 templates/ui/dashboard.html:5
msgid "Sem dados"
msgstr "No data"

#: docs/full_dump_atual.txt:9047 templates/ui/dashboard.html:9
msgid "Resumo da semana"
msgstr "Weekly summary"

#: docs/full_dump_atual.txt:9050 templates/ui/dashboard.html:12
msgid "Buscar tarefa ou evento"
msgstr "Search task or event"

#: docs/full_dump_atual.txt:9052 templates/ui/dashboard.html:14
msgid "Aplicar"
msgstr "Apply"

#: docs/full_dump_atual.txt:9059 templates/ui/dashboard.html:21
msgid "Onboarding incompleto"
msgstr "Onboarding incomplete"

#: docs/full_dump_atual.txt:9060 templates/ui/dashboard.html:22
msgid "Finalize as etapas pendentes para liberar todo o painel."
msgstr "Finish the pending steps to unlock the full dashboard."

#: docs/full_dump_atual.txt:9061 docs/full_dump_atual.txt:9186
#: templates/ui/dashboard.html:23 templates/ui/dashboard.html:148
msgid "Continuar configuracao"
msgstr "Continue setup"

#: docs/full_dump_atual.txt:9069 templates/ui/dashboard.html:31
msgid "Humor da semana"
msgstr "Mood this week"

#: docs/full_dump_atual.txt:9071 templates/ui/dashboard.html:33
#, python-format
msgid "%(total)s registros"
msgstr "%(total)s records"

#: docs/full_dump_atual.txt:9078 templates/ui/dashboard.html:40
msgid "Minutos de foco"
msgstr "Focus minutes"

#: docs/full_dump_atual.txt:9080 templates/ui/dashboard.html:42
msgid "ultimos 7 dias"
msgstr "last 7 days"

#: docs/full_dump_atual.txt:9087 templates/ui/dashboard.html:49
msgid "Estresse da semana"
msgstr "Stress this week"

#: docs/full_dump_atual.txt:9089 templates/ui/dashboard.html:51
msgid "media dos check-ins"
msgstr "check-in average"

#: docs/full_dump_atual.txt:9096 templates/ui/dashboard.html:58
msgid "Proximos prazos"
msgstr "Upcoming deadlines"

#: docs/full_dump_atual.txt:9098 templates/ui/dashboard.html:60
msgid "tarefas e eventos"
msgstr "tasks and events"

#: docs/full_dump_atual.txt:9107 templates/ui/dashboard.html:69
msgid "Proximos eventos"
msgstr "Upcoming events"

#: docs/full_dump_atual.txt:9126 templates/ui/dashboard.html:88
msgid "Prximas tarefas"
msgstr "Upcoming tasks"

#: docs/full_dump_atual.txt:9138 templates/ui/dashboard.html:100
msgid "Nenhuma tarefa proxima."
msgstr "No upcoming tasks."

#: docs/full_dump_atual.txt:9146 templates/ui/dashboard.html:108
msgid "Progresso por disciplina"
msgstr "Progress by course"

#: docs/full_dump_atual.txt:9156 templates/ui/dashboard.html:118
#, python-format
msgid "Media atual: %(current)s | Media minima: %(passing)s"
msgstr "Current average: %(current)s | Minimum average: %(passing)s"

#: docs/full_dump_atual.txt:9164 docs/full_dump_atual.txt:9816
#: docs/full_dump_atual.txt:10025 templates/ui/dashboard.html:126
#: templates/ui/semester/semester_detail.html:79 templates/ui/semesters.html:85
msgid "Nenhuma disciplina cadastrada."
msgstr "No courses registered."

#: docs/full_dump_atual.txt:9170 templates/ui/dashboard.html:132
msgid "Status do Onboarding"
msgstr "Onboarding status"

#: docs/full_dump_atual.txt:9177 templates/ui/dashboard.html:139
msgid "Pendente"
msgstr "Pending"

#: docs/full_dump_atual.txt:9179 templates/ui/dashboard.html:141
msgid "Ok"
msgstr "Ok"

#: docs/full_dump_atual.txt:9202 templates/ui/login.html:8
msgid "Bem-estar e organizacao para universitarios"
msgstr "Well-being and organization for university students"

#: docs/full_dump_atual.txt:9205 templates/ui/login.html:11
msgid "Acesso ao painel"
msgstr "Dashboard access"

#: docs/full_dump_atual.txt:9206 templates/ui/login.html:12
msgid "Entre com seu email institucional ou pessoal para continuar."
msgstr "Use your institutional or personal email to continue."

#: docs/full_dump_atual.txt:9210 templates/ui/login.html:16
msgid "Email ou senha invalidos. Tente novamente."
msgstr "Invalid email or password. Try again."

#: docs/full_dump_atual.txt:9224 templates/ui/login.html:30
msgid "Mostrar"
msgstr "Show"

#: docs/full_dump_atual.txt:9224 templates/ui/login.html:30
msgid "Ocultar"
msgstr "Hide"

#: docs/full_dump_atual.txt:9227 templates/ui/login.html:33
msgid "Entrar"
msgstr "Sign in"

#: docs/full_dump_atual.txt:9231 templates/ui/login.html:37
msgid "Esqueci minha senha"
msgstr "Forgot my password"

#: docs/full_dump_atual.txt:9235 templates/ui/login.html:46
msgid "Dica: use o mesmo login do sistema administrativo se ja tiver acesso."
msgstr ""
"Tip: use the same login as the admin system if you already have access."

#: docs/full_dump_atual.txt:9271 templates/ui/messages/message_list.html:15
msgid "Historico de notificacoes"
msgstr "Notification history"

#: docs/full_dump_atual.txt:9281 docs/full_dump_atual.txt:9955
#: docs/full_dump_atual.txt:10197 docs/full_dump_atual.txt:10281
#: templates/ui/messages/message_list.html:25 templates/ui/semesters.html:15
#: templates/ui/tasks.html:29 templates/ui/tasks/task_list.html:30
msgid "Todos os status"
msgstr "All statuses"

#: docs/full_dump_atual.txt:9288 docs/full_dump_atual.txt:9314
#: templates/ui/messages/message_list.html:32
#: templates/ui/messages/message_list.html:59
msgid "Canal"
msgstr "Channel"

#: docs/full_dump_atual.txt:9290 templates/ui/messages/message_list.html:34
msgid "Todos os canais"
msgstr "All channels"

#: docs/full_dump_atual.txt:9316 templates/ui/messages/message_list.html:62
msgid "Agendado"
msgstr "Scheduled"

#: docs/full_dump_atual.txt:9335 docs/full_dump_atual.txt:9372
#: templates/ui/messages.html:30 templates/ui/messages/message_list.html:100
msgid "Nenhuma mensagem registrada."
msgstr "No messages registered."

#: docs/full_dump_atual.txt:9350 templates/ui/messages.html:8
msgid "Avisos e comunicados in-app"
msgstr "In-app alerts and announcements"

#: docs/full_dump_atual.txt:9387 templates/ui/onboarding.html:8
msgid "Etapas para completar a configuracao"
msgstr "Steps to complete setup"

#: docs/full_dump_atual.txt:9413 templates/ui/onboarding.html:34
msgid "Acoes recomendadas"
msgstr "Recommended actions"

#: docs/full_dump_atual.txt:9425 templates/ui/onboarding.html:46
msgid "Sugestoes rapidas"
msgstr "Quick suggestions"

#: docs/full_dump_atual.txt:9428 templates/ui/onboarding.html:49
msgid "Ver semestres"
msgstr "View semesters"

#: docs/full_dump_atual.txt:9429 templates/ui/onboarding.html:50
msgid "Ver tarefas"
msgstr "View tasks"

#: docs/full_dump_atual.txt:9430 templates/ui/onboarding.html:51
msgid "Ver agenda"
msgstr "View calendar"

#: docs/full_dump_atual.txt:9431 templates/ui/onboarding.html:52
msgid "Cadastrar avaliacao (API)"
msgstr "Register assessment (API)"

#: docs/full_dump_atual.txt:9446 templates/ui/password_reset_complete.html:8
msgid "Senha atualizada"
msgstr "Password updated"

#: docs/full_dump_atual.txt:9449 templates/ui/password_reset_complete.html:11
msgid "Senha redefinida"
msgstr "Password reset"

#: docs/full_dump_atual.txt:9450 templates/ui/password_reset_complete.html:12
msgid "Sua senha foi atualizada. Voce ja pode acessar o painel."
msgstr "Your password has been updated. You can now access the dashboard."

#: docs/full_dump_atual.txt:9452 templates/ui/password_reset_complete.html:14
msgid "Ir para o login"
msgstr "Go to login"

#: docs/full_dump_atual.txt:9467 docs/full_dump_atual.txt:9474
#: templates/ui/password_reset_confirm.html:8
#: templates/ui/password_reset_confirm.html:15
msgid "Nova senha"
msgstr "New password"

#: docs/full_dump_atual.txt:9470 templates/ui/password_reset_confirm.html:11
msgid "Definir nova senha"
msgstr "Set new password"

#: docs/full_dump_atual.txt:9478 templates/ui/password_reset_confirm.html:19
msgid "Confirmar nova senha"
msgstr "Confirm new password"

#: docs/full_dump_atual.txt:9481 templates/ui/password_reset_confirm.html:22
msgid "Atualizar senha"
msgstr "Update password"

#: docs/full_dump_atual.txt:9496 templates/ui/password_reset_done.html:8
msgid "Email enviado"
msgstr "Email sent"

#: docs/full_dump_atual.txt:9499 templates/ui/password_reset_done.html:11
msgid "Verifique sua caixa de entrada"
msgstr "Check your inbox"

#: docs/full_dump_atual.txt:9500 templates/ui/password_reset_done.html:12
msgid ""
"Se o email existir no sistema, voce recebera um link para redefinir a senha."
msgstr ""
"If the email exists in the system, you'll receive a link to reset your "
"password."

#: docs/full_dump_atual.txt:9502 docs/full_dump_atual.txt:9533
#: templates/ui/password_reset_done.html:14
#: templates/ui/password_reset_form.html:24
msgid "Voltar ao login"
msgstr "Back to login"

#: docs/full_dump_atual.txt:9517 templates/ui/password_reset_form.html:8
msgid "Recuperacao de acesso"
msgstr "Account recovery"

#: docs/full_dump_atual.txt:9520 templates/ui/password_reset_form.html:11
msgid "Redefinir senha"
msgstr "Reset password"

#: docs/full_dump_atual.txt:9521 templates/ui/password_reset_form.html:12
msgid "Informe seu email para receber o link de redefinicao."
msgstr "Enter your email to receive the reset link."

#: docs/full_dump_atual.txt:9527 templates/ui/password_reset_form.html:18
msgid "seu.email@universidade.edu"
msgstr "your.email@university.edu"

#: docs/full_dump_atual.txt:9529 templates/ui/password_reset_form.html:20
msgid "Enviar link"
msgstr "Send link"

#: docs/full_dump_atual.txt:9549 docs/full_dump_atual.txt:9555
#: templates/ui/reminders/reminder_confirm_delete.html:9
#: templates/ui/reminders/reminder_confirm_delete.html:15
msgid "Excluir lembrete"
msgstr "Delete reminder"

#: docs/full_dump_atual.txt:9556
#: templates/ui/reminders/reminder_confirm_delete.html:16
msgid "Tem certeza que deseja excluir a regra de lembrete"
msgstr "Are you sure you want to delete the reminder rule"

#: docs/full_dump_atual.txt:9577 docs/full_dump_atual.txt:9587
#: templates/ui/reminders/reminder_form.html:10
#: templates/ui/reminders/reminder_form.html:20
msgid "Editar lembrete"
msgstr "Edit reminder"

#: docs/full_dump_atual.txt:9579 docs/full_dump_atual.txt:9590
#: docs/full_dump_atual.txt:9657 templates/ui/reminders/reminder_form.html:12
#: templates/ui/reminders/reminder_form.html:23
#: templates/ui/reminders/reminder_list.html:23
msgid "Novo lembrete"
msgstr "New reminder"

#: docs/full_dump_atual.txt:9588 templates/ui/reminders/reminder_form.html:21
msgid "Atualize sua regra de lembrete."
msgstr "Update your reminder rule."

#: docs/full_dump_atual.txt:9591 templates/ui/reminders/reminder_form.html:24
msgid "Crie uma nova regra de lembrete."
msgstr "Create a new reminder rule."

#: docs/full_dump_atual.txt:9655 templates/ui/reminders/reminder_list.html:15
msgid "Configure suas regras de lembrete."
msgstr "Configure your reminder rules."

#: docs/full_dump_atual.txt:9690 templates/ui/reminders/reminder_list.html:57
msgid "Inativo"
msgstr "Inactive"

#: docs/full_dump_atual.txt:9703 templates/ui/reminders/reminder_list.html:70
msgid "Nenhuma regra de lembrete cadastrada."
msgstr "No reminder rules registered."

#: docs/full_dump_atual.txt:9719 docs/full_dump_atual.txt:9725
#: templates/ui/semester/semester_confirm_delete.html:9
#: templates/ui/semester/semester_confirm_delete.html:15
msgid "Excluir semestre"
msgstr "Delete semester"

#: docs/full_dump_atual.txt:9726
#: templates/ui/semester/semester_confirm_delete.html:16
msgid "Tem certeza que deseja excluir o semestre"
msgstr "Are you sure you want to delete the semester"

#: docs/full_dump_atual.txt:9754 templates/ui/semester/semester_detail.html:17
msgid "Periodo"
msgstr "Term"

#: docs/full_dump_atual.txt:9760 templates/ui/semester/semester_detail.html:23
msgid "Nova Disciplina"
msgstr "New course"

#: docs/full_dump_atual.txt:9776 docs/full_dump_atual.txt:9910
#: templates/ui/semester/semester_detail.html:39
#: templates/ui/semester/semester_list.html:29
msgid "Termino"
msgstr "End"

#: docs/full_dump_atual.txt:9793 docs/full_dump_atual.txt:9987
#: templates/ui/semester/semester_detail.html:56 templates/ui/semesters.html:47
msgid "Disciplina"
msgstr "Course"

#: docs/full_dump_atual.txt:9806 docs/full_dump_atual.txt:9923
#: docs/full_dump_atual.txt:10235 templates/ui/semester/semester_detail.html:69
#: templates/ui/semester/semester_list.html:42
#: templates/ui/tasks/task_list.html:68
msgid "Ver"
msgstr "View"

#: docs/full_dump_atual.txt:9833 docs/full_dump_atual.txt:9843
#: templates/ui/semester/semester_form.html:10
#: templates/ui/semester/semester_form.html:20
msgid "Editar semestre"
msgstr "Edit semester"

#: docs/full_dump_atual.txt:9835 docs/full_dump_atual.txt:9846
#: templates/ui/semester/semester_form.html:12
#: templates/ui/semester/semester_form.html:23
msgid "Novo semestre"
msgstr "New semester"

#: docs/full_dump_atual.txt:9847 templates/ui/semester/semester_form.html:24
msgid "Cadastre um novo semestre."
msgstr "Create a new semester."

#: docs/full_dump_atual.txt:9896 templates/ui/semester/semester_list.html:15
msgid "Gerencie seus semestres e disciplinas."
msgstr "Manage your semesters and courses."

#: docs/full_dump_atual.txt:9898 templates/ui/semester/semester_list.html:17
msgid "Novo Semestre"
msgstr "New semester"

#: docs/full_dump_atual.txt:9933 docs/full_dump_atual.txt:10031
#: templates/ui/semester/semester_list.html:52 templates/ui/semesters.html:91
msgid "Nenhum semestre cadastrado."
msgstr "No semesters registered."

#: docs/full_dump_atual.txt:9948 templates/ui/semesters.html:8
msgid "Resumo das disciplinas e progresso"
msgstr "Course overview and progress"

#: docs/full_dump_atual.txt:9957 templates/ui/semesters.html:17
msgid "Finalizado"
msgstr "Finished"

#: docs/full_dump_atual.txt:9961 templates/ui/semesters.html:21
msgid "Filtrar por disciplina"
msgstr "Filter by course"

#: docs/full_dump_atual.txt:9965 templates/ui/semesters.html:25
msgid "Filtrar por professor"
msgstr "Filter by instructor"

#: docs/full_dump_atual.txt:9991 templates/ui/semesters.html:51
msgid "Progresso"
msgstr "Progress"

#: docs/full_dump_atual.txt:10002 templates/ui/semesters.html:62
msgid "Aprovado"
msgstr "Passed"

#: docs/full_dump_atual.txt:10004 templates/ui/semesters.html:64
msgid "Reprovado"
msgstr "Failed"

#: docs/full_dump_atual.txt:10006 docs/full_dump_atual.txt:10199
#: docs/full_dump_atual.txt:10283 docs/full_dump_atual.txt:10328
#: templates/ui/semesters.html:66 templates/ui/tasks.html:31
#: templates/ui/tasks.html:76 templates/ui/tasks/task_list.html:32
msgid "Em andamento"
msgstr "In progress"

#: docs/full_dump_atual.txt:10045 docs/full_dump_atual.txt:10051
#: templates/ui/tasks/task_confirm_delete.html:9
#: templates/ui/tasks/task_confirm_delete.html:15
msgid "Excluir tarefa"
msgstr "Delete task"

#: docs/full_dump_atual.txt:10052
#: templates/ui/tasks/task_confirm_delete.html:16
msgid "Tem certeza que deseja excluir a tarefa"
msgstr "Are you sure you want to delete the task"

#: docs/full_dump_atual.txt:10079 docs/full_dump_atual.txt:10221
#: docs/full_dump_atual.txt:10310 templates/ui/tasks.html:58
#: templates/ui/tasks/task_detail.html:16 templates/ui/tasks/task_list.html:54
msgid "Entrega"
msgstr "Due date"

#: docs/full_dump_atual.txt:10096 templates/ui/tasks/task_detail.html:33
msgid "Nivel de estresse"
msgstr "Stress level"

#: docs/full_dump_atual.txt:10119 docs/full_dump_atual.txt:10129
#: templates/ui/tasks/task_form.html:10 templates/ui/tasks/task_form.html:20
msgid "Editar tarefa"
msgstr "Edit task"

#: docs/full_dump_atual.txt:10121 docs/full_dump_atual.txt:10132
#: docs/full_dump_atual.txt:10184 templates/ui/tasks/task_form.html:12
#: templates/ui/tasks/task_form.html:23 templates/ui/tasks/task_list.html:17
msgid "Nova tarefa"
msgstr "New task"

#: docs/full_dump_atual.txt:10133 templates/ui/tasks/task_form.html:24
msgid "Cadastre uma nova tarefa."
msgstr "Create a new task."

#: docs/full_dump_atual.txt:10182 templates/ui/tasks/task_list.html:15
msgid "Organize suas tarefas e prazos."
msgstr "Organize your tasks and deadlines."

#: docs/full_dump_atual.txt:10191 templates/ui/tasks/task_list.html:24
msgid "Buscar"
msgstr "Search"

#: docs/full_dump_atual.txt:10192 docs/full_dump_atual.txt:10266
#: templates/ui/tasks.html:14 templates/ui/tasks/task_list.html:25
msgid "Buscar tarefa"
msgstr "Search task"

#: docs/full_dump_atual.txt:10198 docs/full_dump_atual.txt:10282
#: docs/full_dump_atual.txt:10330 templates/ui/tasks.html:30
#: templates/ui/tasks.html:78 templates/ui/tasks/task_list.html:31
msgid "A fazer"
msgstr "To do"

#: docs/full_dump_atual.txt:10200 docs/full_dump_atual.txt:10284
#: docs/full_dump_atual.txt:10326 templates/ui/tasks.html:32
#: templates/ui/tasks.html:74 templates/ui/tasks/task_list.html:33
msgid "Concluida"
msgstr "Completed"

#: docs/full_dump_atual.txt:10220 templates/ui/tasks/task_list.html:53
#: utils/constants.py:61
msgid "Tarefa"
msgstr "Task"

#: docs/full_dump_atual.txt:10223 templates/ui/tasks/task_list.html:56
msgid "Estresse"
msgstr "Stress"

#: docs/full_dump_atual.txt:10245 docs/full_dump_atual.txt:10339
#: templates/ui/tasks.html:87 templates/ui/tasks/task_list.html:78
msgid "Nenhuma tarefa cadastrada."
msgstr "No tasks registered."

#: docs/full_dump_atual.txt:10260 templates/ui/tasks.html:8
msgid "Lista de tarefas academicas"
msgstr "Academic task list"

#: docs/full_dump_atual.txt:10271 docs/full_dump_atual.txt:10311
#: templates/ui/tasks.html:19 templates/ui/tasks.html:59
msgid "Stress"
msgstr "Stress"

#: docs/full_dump_atual.txt:10289 templates/ui/tasks.html:37
msgid "Todas as datas"
msgstr "All dates"

#: docs/full_dump_atual.txt:10290 templates/ui/tasks.html:38
msgid "Atrasadas"
msgstr "Overdue"

#: docs/full_dump_atual.txt:10291 templates/ui/tasks.html:39
msgid "Hoje"
msgstr "Today"

#: docs/full_dump_atual.txt:10292 templates/ui/tasks.html:40
msgid "Proxima semana"
msgstr "Next week"

#: docs/full_dump_atual.txt:10293 templates/ui/tasks.html:41
msgid "Proximo mes"
msgstr "Next month"

#: templates/ui/first_access.html:9
msgid "Primeiro acesso"
msgstr ""

#: templates/ui/first_access.html:12 templates/ui/first_access.html:66
#, fuzzy
#| msgid "Criar"
msgid "Criar conta"
msgstr "Create"

#: templates/ui/first_access.html:13
msgid "Preencha seus dados para iniciar no Campus Calm."
msgstr ""

#: templates/ui/first_access.html:18
msgid "Revise os campos abaixo."
msgstr ""

#: templates/ui/first_access.html:71
#, fuzzy
#| msgid "Voltar ao login"
msgid "Voltar para login"
msgstr "Back to login"

#: templates/ui/login.html:42
msgid "Primeiro acesso / Criar conta"
msgstr ""

#: templates/ui/messages/message_list.html:61
msgid "Acao"
msgstr ""

#: templates/ui/messages/message_list.html:63
#, fuzzy
#| msgid "Email enviado"
msgid "Enviado"
msgstr "Email sent"

#: templates/ui/messages/message_list.html:64
msgid "Tentativas"
msgstr ""

#: templates/ui/messages/message_list.html:65
msgid "Erro"
msgstr ""

#: templates/ui/reminders/reminder_list.html:21
#, fuzzy
#| msgid "Editar lembrete"
msgid "Gerar lembretes"
msgstr "Edit reminder"

#: utils/constants.py:34
msgid "Todo"
msgstr "To do"

#: utils/constants.py:35
msgid "Doing"
msgstr "In progress"

#: utils/constants.py:36
msgid "Done"
msgstr "Done"

#: utils/gating.py:15
msgid "Complete seu perfil para continuar."
msgstr "Complete your profile to continue."

#: utils/gating.py:16
msgid "Crie um semestre ativo."
msgstr "Create an active semester."

#: utils/gating.py:17
msgid "Cadastre ao menos uma disciplina."
msgstr "Add at least one course."

#: utils/gating.py:18
msgid "Cadastre ao menos uma avaliacao."
msgstr "Add at least one assessment."

#: utils/gating.py:19
msgid "Configure pelo menos uma regra de lembrete."
msgstr "Configure at least one reminder rule."

#: utils/gating.py:20
msgid "Tudo pronto para seu dashboard."
msgstr "Everything is ready for your dashboard."

### locale/pt_BR/LC_MESSAGES/django.po
--------------------------------------------------------------------------------
msgid ""
msgstr ""
"Project-Id-Version: Campus Calm\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2026-02-02 11:09-0300\n"
"PO-Revision-Date: 2026-01-29 13:10+0000\n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: pt_BR\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=2; plural=(n != 1);\n"

#: apps/ui/forms.py:8 apps/ui/forms.py:27 docs/full_dump_atual.txt:9526
#: templates/ui/password_reset_form.html:17
msgid "Email"
msgstr "Email"

#: apps/ui/forms.py:12 apps/ui/forms.py:41
msgid "Senha"
msgstr ""

#: apps/ui/forms.py:22
msgid "Free"
msgstr ""

#: apps/ui/forms.py:23
msgid "Pago"
msgstr ""

#: apps/ui/forms.py:26 docs/full_dump_atual.txt:9908
#: templates/ui/semester/semester_list.html:27
msgid "Nome"
msgstr ""

#: apps/ui/forms.py:29
msgid "Telefone (WhatsApp)"
msgstr ""

#: apps/ui/forms.py:35
msgid "Plano"
msgstr ""

#: apps/ui/forms.py:46
#, fuzzy
#| msgid "Confirmar nova senha"
msgid "Confirmar senha"
msgstr "Confirmar nova senha"

#: apps/ui/forms.py:51
msgid "Receber email"
msgstr ""

#: apps/ui/forms.py:57
msgid "Receber WhatsApp"
msgstr ""

#: apps/ui/forms.py:63
msgid "Receber SMS"
msgstr ""

#: apps/ui/forms.py:72
msgid "As senhas nao conferem."
msgstr ""

#: apps/ui/forms_academic.py:13
#, fuzzy
#| msgid "Ver semestres"
msgid "Nome do semestre"
msgstr "Ver semestres"

#: apps/ui/forms_academic.py:14
msgid "Data de inicio"
msgstr ""

#: apps/ui/forms_academic.py:15
msgid "Data de termino"
msgstr ""

#: apps/ui/forms_academic.py:16 apps/ui/forms_academic.py:35
#: apps/ui/forms_tasks.py:16 docs/full_dump_atual.txt:8924
#: docs/full_dump_atual.txt:9279 docs/full_dump_atual.txt:9315
#: docs/full_dump_atual.txt:9670 docs/full_dump_atual.txt:9768
#: docs/full_dump_atual.txt:9795 docs/full_dump_atual.txt:9911
#: docs/full_dump_atual.txt:9989 docs/full_dump_atual.txt:10092
#: docs/full_dump_atual.txt:10195 docs/full_dump_atual.txt:10222
#: docs/full_dump_atual.txt:10312 templates/ui/course/course_detail.html:48
#: templates/ui/messages/message_list.html:23
#: templates/ui/messages/message_list.html:60
#: templates/ui/reminders/reminder_list.html:37
#: templates/ui/semester/semester_detail.html:31
#: templates/ui/semester/semester_detail.html:58
#: templates/ui/semester/semester_list.html:30 templates/ui/semesters.html:49
#: templates/ui/tasks.html:60 templates/ui/tasks/task_detail.html:29
#: templates/ui/tasks/task_list.html:28 templates/ui/tasks/task_list.html:55
msgid "Status"
msgstr "Status"

#: apps/ui/forms_academic.py:31
#, fuzzy
#| msgid "Progresso por disciplina"
msgid "Nome da disciplina"
msgstr "Progresso por disciplina"

#: apps/ui/forms_academic.py:32 docs/full_dump_atual.txt:9794
#: docs/full_dump_atual.txt:9988 templates/ui/semester/semester_detail.html:57
#: templates/ui/semesters.html:48
msgid "Professor"
msgstr "Professor"

#: apps/ui/forms_academic.py:33
msgid "Creditos"
msgstr ""

#: apps/ui/forms_academic.py:34 docs/full_dump_atual.txt:8912
#: templates/ui/course/course_detail.html:36
msgid "Nota minima"
msgstr ""

#: apps/ui/forms_academic.py:36
msgid "Nota final"
msgstr ""

#: apps/ui/forms_academic.py:37
msgid "Anotacoes"
msgstr ""

#: apps/ui/forms_academic.py:52
msgid "A nota minima deve ser maior que zero."
msgstr ""

#: apps/ui/forms_academic.py:61 apps/ui/forms_agenda.py:13
#: apps/ui/forms_tasks.py:12 docs/full_dump_atual.txt:9313
#: docs/full_dump_atual.txt:10309 templates/ui/messages/message_list.html:58
#: templates/ui/tasks.html:57
msgid "Titulo"
msgstr "Titulo"

#: apps/ui/forms_academic.py:62
msgid "Nota obtida"
msgstr ""

#: apps/ui/forms_academic.py:63
msgid "Nota maxima"
msgstr ""

#: apps/ui/forms_academic.py:64 docs/full_dump_atual.txt:8950
#: templates/ui/course/course_detail.html:74
msgid "Peso"
msgstr ""

#: apps/ui/forms_academic.py:65 docs/full_dump_atual.txt:8951
#: templates/ui/course/course_detail.html:75
msgid "Data"
msgstr ""

#: apps/ui/forms_academic.py:81
msgid "A nota obtida nao pode ser maior que a nota maxima."
msgstr ""

#: apps/ui/forms_academic.py:83
msgid "O peso deve ser maior ou igual a zero."
msgstr ""

#: apps/ui/forms_agenda.py:14 docs/full_dump_atual.txt:8599
#: docs/full_dump_atual.txt:9667 templates/ui/agenda/agenda_list.html:28
#: templates/ui/reminders/reminder_list.html:34
msgid "Tipo"
msgstr ""

#: apps/ui/forms_agenda.py:15 docs/full_dump_atual.txt:8600
#: docs/full_dump_atual.txt:9772 docs/full_dump_atual.txt:9909
#: templates/ui/agenda/agenda_list.html:29
#: templates/ui/semester/semester_detail.html:35
#: templates/ui/semester/semester_list.html:28
msgid "Inicio"
msgstr ""

#: apps/ui/forms_agenda.py:16 docs/full_dump_atual.txt:8601
#: templates/ui/agenda/agenda_list.html:30
msgid "Fim"
msgstr ""

#: apps/ui/forms_agenda.py:17
msgid "Tarefa relacionada"
msgstr ""

#: apps/ui/forms_agenda.py:18
msgid "Observacoes"
msgstr ""

#: apps/ui/forms_agenda.py:43
msgid "Estudos"
msgstr "Estudos"

#: apps/ui/forms_reminders.py:19 docs/full_dump_atual.txt:9669
#: templates/ui/reminders/reminder_list.html:36
msgid "Canais"
msgstr ""

#: apps/ui/forms_reminders.py:27
msgid "Tipo de alvo"
msgstr ""

#: apps/ui/forms_reminders.py:28 docs/full_dump_atual.txt:9668
#: templates/ui/reminders/reminder_list.html:35
#, fuzzy
#| msgid "%(minutes)s min antes"
msgid "Minutos antes"
msgstr "%(minutes)s min antes"

#: apps/ui/forms_reminders.py:29 docs/full_dump_atual.txt:9688
#: docs/full_dump_atual.txt:9956 templates/ui/reminders/reminder_list.html:55
#: templates/ui/semesters.html:16
msgid "Ativo"
msgstr "Ativo"

#: apps/ui/forms_reminders.py:45
msgid "Informe um valor maior que zero."
msgstr ""

#: apps/ui/forms_tasks.py:13 docs/full_dump_atual.txt:10100
#: templates/ui/tasks/task_detail.html:37
msgid "Descricao"
msgstr ""

#: apps/ui/forms_tasks.py:14
msgid "Data de entrega"
msgstr ""

#: apps/ui/forms_tasks.py:15
#, fuzzy
#| msgid "Ver semestres"
msgid "Nivel de estresse(0 a 5)"
msgstr "Ver semestres"

#: apps/ui/views.py:41
msgid "Perfil"
msgstr ""

#: apps/ui/views.py:42
#, fuzzy
#| msgid "Semestres"
msgid "Semestre"
msgstr "Semestres"

#: apps/ui/views.py:43 docs/full_dump_atual.txt:9786
#: templates/ui/semester/semester_detail.html:49
#, fuzzy
#| msgid "Disciplina"
msgid "Disciplinas"
msgstr "Disciplina"

#: apps/ui/views.py:44 docs/full_dump_atual.txt:8941
#: templates/ui/course/course_detail.html:65
msgid "Avaliacoes"
msgstr ""

#: apps/ui/views.py:45 docs/full_dump_atual.txt:8436
#: docs/full_dump_atual.txt:9548 docs/full_dump_atual.txt:9575
#: docs/full_dump_atual.txt:9648 docs/full_dump_atual.txt:9654
#: templates/base.html:62 templates/ui/reminders/reminder_confirm_delete.html:8
#: templates/ui/reminders/reminder_form.html:8
#: templates/ui/reminders/reminder_list.html:8
#: templates/ui/reminders/reminder_list.html:14
#, fuzzy
#| msgid "Lembretes ativos"
msgid "Lembretes"
msgstr "Lembretes ativos"

#: apps/ui/views.py:46 docs/full_dump_atual.txt:8421
#: docs/full_dump_atual.txt:8493 docs/full_dump_atual.txt:8520
#: docs/full_dump_atual.txt:8578 docs/full_dump_atual.txt:8722
#: docs/full_dump_atual.txt:8751 docs/full_dump_atual.txt:8855
#: docs/full_dump_atual.txt:8883 docs/full_dump_atual.txt:8986
#: docs/full_dump_atual.txt:9046 docs/full_dump_atual.txt:9263
#: docs/full_dump_atual.txt:9547 docs/full_dump_atual.txt:9574
#: docs/full_dump_atual.txt:9647 docs/full_dump_atual.txt:9717
#: docs/full_dump_atual.txt:9744 docs/full_dump_atual.txt:9830
#: docs/full_dump_atual.txt:9888 docs/full_dump_atual.txt:10043
#: docs/full_dump_atual.txt:10070 docs/full_dump_atual.txt:10116
#: docs/full_dump_atual.txt:10174 templates/base.html:47
#: templates/ui/agenda/agenda_confirm_delete.html:7
#: templates/ui/agenda/agenda_form.html:7
#: templates/ui/agenda/agenda_list.html:7
#: templates/ui/assessment/assessment_confirm_delete.html:7
#: templates/ui/assessment/assessment_form.html:7
#: templates/ui/course/course_confirm_delete.html:7
#: templates/ui/course/course_detail.html:7
#: templates/ui/course/course_form.html:7 templates/ui/dashboard.html:8
#: templates/ui/messages/message_list.html:7
#: templates/ui/reminders/reminder_confirm_delete.html:7
#: templates/ui/reminders/reminder_form.html:7
#: templates/ui/reminders/reminder_list.html:7
#: templates/ui/semester/semester_confirm_delete.html:7
#: templates/ui/semester/semester_detail.html:7
#: templates/ui/semester/semester_form.html:7
#: templates/ui/semester/semester_list.html:7
#: templates/ui/tasks/task_confirm_delete.html:7
#: templates/ui/tasks/task_detail.html:7 templates/ui/tasks/task_form.html:7
#: templates/ui/tasks/task_list.html:7
msgid "Dashboard"
msgstr "Dashboard"

#: apps/ui/views.py:61
#, fuzzy
#| msgid "Concluida"
msgid "Concluido"
msgstr "Concluida"

#: apps/ui/views.py:80
msgid "Ja existe um usuario com este email."
msgstr ""

#: apps/ui/views.py:104
msgid "Conta criada com sucesso. Faca login para continuar."
msgstr ""

#: apps/ui/views_academic.py:25
msgid "Semestre criado com sucesso."
msgstr ""

#: apps/ui/views_academic.py:50
msgid "Semestre atualizado com sucesso."
msgstr ""

#: apps/ui/views_academic.py:66
msgid "Semestre excluido com sucesso."
msgstr ""

#: apps/ui/views_academic.py:84
msgid "Disciplina criada com sucesso."
msgstr ""

#: apps/ui/views_academic.py:114
msgid "Disciplina atualizada com sucesso."
msgstr ""

#: apps/ui/views_academic.py:131
msgid "Disciplina excluida com sucesso."
msgstr ""

#: apps/ui/views_academic.py:149
msgid "Avaliacao criada com sucesso."
msgstr ""

#: apps/ui/views_academic.py:167
msgid "Avaliacao atualizada com sucesso."
msgstr ""

#: apps/ui/views_academic.py:184
msgid "Avaliacao excluida com sucesso."
msgstr ""

#: apps/ui/views_agenda.py:35
msgid "Evento criado com sucesso."
msgstr ""

#: apps/ui/views_agenda.py:51
msgid "Evento atualizado com sucesso."
msgstr ""

#: apps/ui/views_agenda.py:63
msgid "Evento excluido com sucesso."
msgstr ""

#: apps/ui/views_reminders.py:25
msgid "Lembretes gerados com sucesso."
msgstr ""

#: apps/ui/views_reminders.py:27
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Nenhum lembrete novo foi gerado."
msgstr "Nenhum semestre cadastrado."

#: apps/ui/views_reminders.py:39
msgid "Regra de lembrete criada com sucesso."
msgstr ""

#: apps/ui/views_reminders.py:53
msgid "Regra de lembrete atualizada com sucesso."
msgstr ""

#: apps/ui/views_reminders.py:69
msgid "Regra de lembrete excluida com sucesso."
msgstr ""

#: apps/ui/views_tasks.py:47
msgid "Tarefa criada com sucesso."
msgstr ""

#: apps/ui/views_tasks.py:69
msgid "Tarefa atualizada com sucesso."
msgstr ""

#: apps/ui/views_tasks.py:81
msgid "Tarefa excluida com sucesso."
msgstr ""

#: config/settings.py:104
msgid "English"
msgstr ""

#: config/settings.py:105
msgid "Portugus (Brasil)"
msgstr ""

#: config/settings.py:106
msgid "Portugus (Portugal)"
msgstr ""

#: docs/full_dump_atual.txt:8397 templates/base.html:23
msgid "Painel do aluno"
msgstr "Painel do aluno"

#: docs/full_dump_atual.txt:8400 templates/base.html:26
#, python-format
msgid "Ol, %(name)s"
msgstr "Ol, %(name)s"

#: docs/full_dump_atual.txt:8405 docs/full_dump_atual.txt:8826
#: templates/base.html:31 templates/ui/auth_base.html:22
msgid "Idioma"
msgstr "Idioma"

#: docs/full_dump_atual.txt:8424 docs/full_dump_atual.txt:9386
#: templates/base.html:50 templates/ui/onboarding.html:7
msgid "Onboarding"
msgstr "Onboarding"

#: docs/full_dump_atual.txt:8427 docs/full_dump_atual.txt:8723
#: docs/full_dump_atual.txt:8752 docs/full_dump_atual.txt:8856
#: docs/full_dump_atual.txt:8884 docs/full_dump_atual.txt:8987
#: docs/full_dump_atual.txt:9718 docs/full_dump_atual.txt:9745
#: docs/full_dump_atual.txt:9831 docs/full_dump_atual.txt:9889
#: docs/full_dump_atual.txt:9895 docs/full_dump_atual.txt:9947
#: templates/base.html:53
#: templates/ui/assessment/assessment_confirm_delete.html:8
#: templates/ui/assessment/assessment_form.html:8
#: templates/ui/course/course_confirm_delete.html:8
#: templates/ui/course/course_detail.html:8
#: templates/ui/course/course_form.html:8
#: templates/ui/semester/semester_confirm_delete.html:8
#: templates/ui/semester/semester_detail.html:8
#: templates/ui/semester/semester_form.html:8
#: templates/ui/semester/semester_list.html:8
#: templates/ui/semester/semester_list.html:14 templates/ui/semesters.html:7
msgid "Semestres"
msgstr "Semestres"

#: docs/full_dump_atual.txt:8430 docs/full_dump_atual.txt:10044
#: docs/full_dump_atual.txt:10071 docs/full_dump_atual.txt:10117
#: docs/full_dump_atual.txt:10175 docs/full_dump_atual.txt:10181
#: docs/full_dump_atual.txt:10259 templates/base.html:56
#: templates/ui/tasks.html:7 templates/ui/tasks/task_confirm_delete.html:8
#: templates/ui/tasks/task_detail.html:8 templates/ui/tasks/task_form.html:8
#: templates/ui/tasks/task_list.html:8 templates/ui/tasks/task_list.html:14
msgid "Tarefas"
msgstr "Tarefas"

#: docs/full_dump_atual.txt:8433 docs/full_dump_atual.txt:8494
#: docs/full_dump_atual.txt:8521 docs/full_dump_atual.txt:8579
#: docs/full_dump_atual.txt:8585 docs/full_dump_atual.txt:8636
#: templates/base.html:59 templates/ui/agenda.html:7
#: templates/ui/agenda/agenda_confirm_delete.html:8
#: templates/ui/agenda/agenda_form.html:8
#: templates/ui/agenda/agenda_list.html:8
#: templates/ui/agenda/agenda_list.html:14
msgid "Agenda"
msgstr "Agenda"

#: docs/full_dump_atual.txt:8439 docs/full_dump_atual.txt:9264
#: docs/full_dump_atual.txt:9270 docs/full_dump_atual.txt:9349
#: templates/base.html:65 templates/ui/messages.html:7
#: templates/ui/messages/message_list.html:8
#: templates/ui/messages/message_list.html:14
msgid "Mensagens"
msgstr "Mensagens"

#: docs/full_dump_atual.txt:8445 templates/base.html:71
msgid "Sair"
msgstr "Sair"

#: docs/full_dump_atual.txt:8457 templates/base.html:83
msgid "Fechar"
msgstr ""

#: docs/full_dump_atual.txt:8495 docs/full_dump_atual.txt:8501
#: templates/ui/agenda/agenda_confirm_delete.html:9
#: templates/ui/agenda/agenda_confirm_delete.html:15
#, fuzzy
#| msgid "Ver semestres"
msgid "Excluir evento"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:8502
#: templates/ui/agenda/agenda_confirm_delete.html:16
msgid "Tem certeza que deseja excluir o evento"
msgstr ""

#: docs/full_dump_atual.txt:8505 docs/full_dump_atual.txt:8736
#: docs/full_dump_atual.txt:8868 docs/full_dump_atual.txt:9559
#: docs/full_dump_atual.txt:9729 docs/full_dump_atual.txt:10055
#: templates/ui/agenda/agenda_confirm_delete.html:19
#: templates/ui/assessment/assessment_confirm_delete.html:21
#: templates/ui/course/course_confirm_delete.html:20
#: templates/ui/reminders/reminder_confirm_delete.html:19
#: templates/ui/semester/semester_confirm_delete.html:19
#: templates/ui/tasks/task_confirm_delete.html:19
msgid "Cancelar"
msgstr ""

#: docs/full_dump_atual.txt:8506 docs/full_dump_atual.txt:8614
#: docs/full_dump_atual.txt:8737 docs/full_dump_atual.txt:8869
#: docs/full_dump_atual.txt:8964 docs/full_dump_atual.txt:9560
#: docs/full_dump_atual.txt:9695 docs/full_dump_atual.txt:9730
#: docs/full_dump_atual.txt:9808 docs/full_dump_atual.txt:9925
#: docs/full_dump_atual.txt:10056 docs/full_dump_atual.txt:10084
#: docs/full_dump_atual.txt:10237
#: templates/ui/agenda/agenda_confirm_delete.html:20
#: templates/ui/agenda/agenda_list.html:43
#: templates/ui/assessment/assessment_confirm_delete.html:22
#: templates/ui/course/course_confirm_delete.html:21
#: templates/ui/course/course_detail.html:88
#: templates/ui/reminders/reminder_confirm_delete.html:20
#: templates/ui/reminders/reminder_list.html:62
#: templates/ui/semester/semester_confirm_delete.html:20
#: templates/ui/semester/semester_detail.html:71
#: templates/ui/semester/semester_list.html:44
#: templates/ui/tasks/task_confirm_delete.html:20
#: templates/ui/tasks/task_detail.html:21 templates/ui/tasks/task_list.html:70
msgid "Excluir"
msgstr ""

#: docs/full_dump_atual.txt:8523 docs/full_dump_atual.txt:8533
#: templates/ui/agenda/agenda_form.html:10
#: templates/ui/agenda/agenda_form.html:20
#, fuzzy
#| msgid "Ver semestres"
msgid "Editar evento"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:8525 docs/full_dump_atual.txt:8536
#: docs/full_dump_atual.txt:8588 templates/ui/agenda/agenda_form.html:12
#: templates/ui/agenda/agenda_form.html:23
#: templates/ui/agenda/agenda_list.html:17
#, fuzzy
#| msgid "Proximos eventos"
msgid "Novo evento"
msgstr "Proximos eventos"

#: docs/full_dump_atual.txt:8537 templates/ui/agenda/agenda_form.html:24
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Cadastre um novo evento."
msgstr "Nenhum semestre cadastrado."

#: docs/full_dump_atual.txt:8540 docs/full_dump_atual.txt:8773
#: docs/full_dump_atual.txt:8896 docs/full_dump_atual.txt:9007
#: docs/full_dump_atual.txt:9594 docs/full_dump_atual.txt:9758
#: docs/full_dump_atual.txt:9850 docs/full_dump_atual.txt:10082
#: docs/full_dump_atual.txt:10136 templates/ui/agenda/agenda_form.html:27
#: templates/ui/assessment/assessment_form.html:29
#: templates/ui/course/course_detail.html:20
#: templates/ui/course/course_form.html:28
#: templates/ui/reminders/reminder_form.html:27
#: templates/ui/semester/semester_detail.html:21
#: templates/ui/semester/semester_form.html:27
#: templates/ui/tasks/task_detail.html:19 templates/ui/tasks/task_form.html:27
#, fuzzy
#| msgid "Ocultar"
msgid "Voltar"
msgstr "Ocultar"

#: docs/full_dump_atual.txt:8563 docs/full_dump_atual.txt:8796
#: docs/full_dump_atual.txt:9030 docs/full_dump_atual.txt:9632
#: docs/full_dump_atual.txt:9873 docs/full_dump_atual.txt:10159
#: templates/ui/agenda/agenda_form.html:50
#: templates/ui/assessment/assessment_form.html:52
#: templates/ui/course/course_form.html:51
#: templates/ui/reminders/reminder_form.html:65
#: templates/ui/semester/semester_form.html:50
#: templates/ui/tasks/task_form.html:50
msgid "Salvar"
msgstr ""

#: docs/full_dump_atual.txt:8563 docs/full_dump_atual.txt:8796
#: docs/full_dump_atual.txt:9030 docs/full_dump_atual.txt:9632
#: docs/full_dump_atual.txt:9873 docs/full_dump_atual.txt:10159
#: templates/ui/agenda/agenda_form.html:50
#: templates/ui/assessment/assessment_form.html:52
#: templates/ui/course/course_form.html:51
#: templates/ui/reminders/reminder_form.html:65
#: templates/ui/semester/semester_form.html:50
#: templates/ui/tasks/task_form.html:50
msgid "Criar"
msgstr ""

#: docs/full_dump_atual.txt:8586 templates/ui/agenda/agenda_list.html:15
#, fuzzy
#| msgid "Nenhum evento nos proximos dias."
msgid "Seus eventos e compromissos."
msgstr "Nenhum evento nos proximos dias."

#: docs/full_dump_atual.txt:8598 templates/ui/agenda/agenda_list.html:27
#: utils/constants.py:62
#, fuzzy
#| msgid "Eventos"
msgid "Evento"
msgstr "Eventos"

#: docs/full_dump_atual.txt:8602 docs/full_dump_atual.txt:8952
#: docs/full_dump_atual.txt:9671 docs/full_dump_atual.txt:9796
#: docs/full_dump_atual.txt:9912 docs/full_dump_atual.txt:10224
#: templates/ui/agenda/agenda_list.html:31
#: templates/ui/course/course_detail.html:76
#: templates/ui/reminders/reminder_list.html:38
#: templates/ui/semester/semester_detail.html:59
#: templates/ui/semester/semester_list.html:31
#: templates/ui/tasks/task_list.html:57
msgid "Acoes"
msgstr ""

#: docs/full_dump_atual.txt:8613 docs/full_dump_atual.txt:8897
#: docs/full_dump_atual.txt:8963 docs/full_dump_atual.txt:9694
#: docs/full_dump_atual.txt:9759 docs/full_dump_atual.txt:9807
#: docs/full_dump_atual.txt:9924 docs/full_dump_atual.txt:10083
#: docs/full_dump_atual.txt:10236 templates/ui/agenda/agenda_list.html:42
#: templates/ui/course/course_detail.html:21
#: templates/ui/course/course_detail.html:87
#: templates/ui/reminders/reminder_list.html:61
#: templates/ui/semester/semester_detail.html:22
#: templates/ui/semester/semester_detail.html:70
#: templates/ui/semester/semester_list.html:43
#: templates/ui/tasks/task_detail.html:20 templates/ui/tasks/task_list.html:69
msgid "Editar"
msgstr ""

#: docs/full_dump_atual.txt:8622 templates/ui/agenda/agenda_list.html:51
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Nenhum evento cadastrado."
msgstr "Nenhum semestre cadastrado."

#: docs/full_dump_atual.txt:8637 templates/ui/agenda.html:8
#, python-format
msgid "Eventos dos proximos %(days)s dias"
msgstr "Eventos dos proximos %(days)s dias"

#: docs/full_dump_atual.txt:8643 templates/ui/agenda.html:14
msgid "Buscar evento"
msgstr "Buscar evento"

#: docs/full_dump_atual.txt:8648 templates/ui/agenda.html:19
msgid "Todos os tipos"
msgstr "Todos os tipos"

#: docs/full_dump_atual.txt:8656 templates/ui/agenda.html:27
msgid "Proximos 7 dias"
msgstr "Proximos 7 dias"

#: docs/full_dump_atual.txt:8657 templates/ui/agenda.html:28
msgid "Proximos 15 dias"
msgstr "Proximos 15 dias"

#: docs/full_dump_atual.txt:8658 templates/ui/agenda.html:29
msgid "Proximos 30 dias"
msgstr "Proximos 30 dias"

#: docs/full_dump_atual.txt:8659 templates/ui/agenda.html:30
msgid "Proximos 60 dias"
msgstr "Proximos 60 dias"

#: docs/full_dump_atual.txt:8660 templates/ui/agenda.html:31
msgid "Proximos 90 dias"
msgstr "Proximos 90 dias"

#: docs/full_dump_atual.txt:8664 docs/full_dump_atual.txt:9297
#: docs/full_dump_atual.txt:9969 docs/full_dump_atual.txt:10204
#: docs/full_dump_atual.txt:10297 templates/ui/agenda.html:35
#: templates/ui/messages/message_list.html:41 templates/ui/semesters.html:29
#: templates/ui/tasks.html:45 templates/ui/tasks/task_list.html:37
msgid "Filtrar"
msgstr "Filtrar"

#: docs/full_dump_atual.txt:8665 docs/full_dump_atual.txt:9053
#: docs/full_dump_atual.txt:9300 docs/full_dump_atual.txt:9970
#: docs/full_dump_atual.txt:10207 docs/full_dump_atual.txt:10298
#: templates/ui/agenda.html:36 templates/ui/dashboard.html:15
#: templates/ui/messages/message_list.html:44 templates/ui/semesters.html:30
#: templates/ui/tasks.html:46 templates/ui/tasks/task_list.html:40
msgid "Limpar"
msgstr "Limpar"

#: docs/full_dump_atual.txt:8672 templates/ui/agenda.html:43
msgid "Eventos"
msgstr "Eventos"

#: docs/full_dump_atual.txt:8687 docs/full_dump_atual.txt:9119
#: templates/ui/agenda.html:58 templates/ui/dashboard.html:81
msgid "Nenhum evento nos proximos dias."
msgstr "Nenhum evento nos proximos dias."

#: docs/full_dump_atual.txt:8694 templates/ui/agenda.html:65
msgid "Lembretes ativos"
msgstr "Lembretes ativos"

#: docs/full_dump_atual.txt:8701 templates/ui/agenda.html:72
#, python-format
msgid "%(minutes)s min antes"
msgstr "%(minutes)s min antes"

#: docs/full_dump_atual.txt:8706 templates/ui/agenda.html:77
msgid "Nenhuma regra ativa."
msgstr "Nenhuma regra ativa."

#: docs/full_dump_atual.txt:8726 docs/full_dump_atual.txt:8732
#: templates/ui/assessment/assessment_confirm_delete.html:11
#: templates/ui/assessment/assessment_confirm_delete.html:17
msgid "Excluir avaliacao"
msgstr ""

#: docs/full_dump_atual.txt:8733
#: templates/ui/assessment/assessment_confirm_delete.html:18
msgid "Tem certeza que deseja excluir a avaliacao"
msgstr ""

#: docs/full_dump_atual.txt:8756 docs/full_dump_atual.txt:8766
#: templates/ui/assessment/assessment_form.html:12
#: templates/ui/assessment/assessment_form.html:22
#, fuzzy
#| msgid "Cadastrar avaliacao (API)"
msgid "Editar avaliacao"
msgstr "Cadastrar avaliacao (API)"

#: docs/full_dump_atual.txt:8758 docs/full_dump_atual.txt:8769
#: templates/ui/assessment/assessment_form.html:14
#: templates/ui/assessment/assessment_form.html:25
msgid "Nova avaliacao"
msgstr ""

#: docs/full_dump_atual.txt:8814 templates/ui/auth_base.html:10
msgid "Campus Calm - Acesso"
msgstr "Campus Calm - Acesso"

#: docs/full_dump_atual.txt:8858 docs/full_dump_atual.txt:8864
#: templates/ui/course/course_confirm_delete.html:10
#: templates/ui/course/course_confirm_delete.html:16
#, fuzzy
#| msgid "Progresso por disciplina"
msgid "Excluir disciplina"
msgstr "Progresso por disciplina"

#: docs/full_dump_atual.txt:8865
#: templates/ui/course/course_confirm_delete.html:17
msgid "Tem certeza que deseja excluir a disciplina"
msgstr ""

#: docs/full_dump_atual.txt:8898 templates/ui/course/course_detail.html:22
msgid "Nova Avaliacao"
msgstr ""

#: docs/full_dump_atual.txt:8904 templates/ui/course/course_detail.html:28
#, fuzzy
#| msgid "Cadastrar avaliacao (API)"
msgid "Cadastre ao menos uma avaliacao para calcular a barra de progresso."
msgstr "Cadastrar avaliacao (API)"

#: docs/full_dump_atual.txt:8916 docs/full_dump_atual.txt:9990
#: templates/ui/course/course_detail.html:40 templates/ui/semesters.html:50
msgid "Media atual"
msgstr "Media atual"

#: docs/full_dump_atual.txt:8920 docs/full_dump_atual.txt:9992
#: templates/ui/course/course_detail.html:44 templates/ui/semesters.html:52
msgid "Falta para passar"
msgstr "Falta para passar"

#: docs/full_dump_atual.txt:8948 templates/ui/course/course_detail.html:72
msgid "Avaliacao"
msgstr ""

#: docs/full_dump_atual.txt:8949 templates/ui/course/course_detail.html:73
msgid "Nota"
msgstr ""

#: docs/full_dump_atual.txt:8972 templates/ui/course/course_detail.html:96
#, fuzzy
#| msgid "Nenhuma tarefa cadastrada."
msgid "Nenhuma avaliacao cadastrada."
msgstr "Nenhuma tarefa cadastrada."

#: docs/full_dump_atual.txt:8990 docs/full_dump_atual.txt:9000
#: templates/ui/course/course_form.html:11
#: templates/ui/course/course_form.html:21
#, fuzzy
#| msgid "Progresso por disciplina"
msgid "Editar disciplina"
msgstr "Progresso por disciplina"

#: docs/full_dump_atual.txt:8992 docs/full_dump_atual.txt:9003
#: templates/ui/course/course_form.html:13
#: templates/ui/course/course_form.html:24
#, fuzzy
#| msgid "Disciplina"
msgid "Nova disciplina"
msgstr "Disciplina"

#: docs/full_dump_atual.txt:9043 templates/ui/dashboard.html:5
msgid "Sem dados"
msgstr "Sem dados"

#: docs/full_dump_atual.txt:9047 templates/ui/dashboard.html:9
msgid "Resumo da semana"
msgstr "Resumo da semana"

#: docs/full_dump_atual.txt:9050 templates/ui/dashboard.html:12
msgid "Buscar tarefa ou evento"
msgstr "Buscar tarefa ou evento"

#: docs/full_dump_atual.txt:9052 templates/ui/dashboard.html:14
msgid "Aplicar"
msgstr "Aplicar"

#: docs/full_dump_atual.txt:9059 templates/ui/dashboard.html:21
msgid "Onboarding incompleto"
msgstr "Onboarding incompleto"

#: docs/full_dump_atual.txt:9060 templates/ui/dashboard.html:22
msgid "Finalize as etapas pendentes para liberar todo o painel."
msgstr "Finalize as etapas pendentes para liberar todo o painel."

#: docs/full_dump_atual.txt:9061 docs/full_dump_atual.txt:9186
#: templates/ui/dashboard.html:23 templates/ui/dashboard.html:148
msgid "Continuar configuracao"
msgstr "Continuar configuracao"

#: docs/full_dump_atual.txt:9069 templates/ui/dashboard.html:31
msgid "Humor da semana"
msgstr "Humor da semana"

#: docs/full_dump_atual.txt:9071 templates/ui/dashboard.html:33
#, python-format
msgid "%(total)s registros"
msgstr "%(total)s registros"

#: docs/full_dump_atual.txt:9078 templates/ui/dashboard.html:40
msgid "Minutos de foco"
msgstr "Minutos de foco"

#: docs/full_dump_atual.txt:9080 templates/ui/dashboard.html:42
msgid "ultimos 7 dias"
msgstr "ultimos 7 dias"

#: docs/full_dump_atual.txt:9087 templates/ui/dashboard.html:49
msgid "Estresse da semana"
msgstr "Estresse da semana"

#: docs/full_dump_atual.txt:9089 templates/ui/dashboard.html:51
msgid "media dos check-ins"
msgstr "media dos check-ins"

#: docs/full_dump_atual.txt:9096 templates/ui/dashboard.html:58
msgid "Proximos prazos"
msgstr "Proximos prazos"

#: docs/full_dump_atual.txt:9098 templates/ui/dashboard.html:60
msgid "tarefas e eventos"
msgstr "tarefas e eventos"

#: docs/full_dump_atual.txt:9107 templates/ui/dashboard.html:69
msgid "Proximos eventos"
msgstr "Proximos eventos"

#: docs/full_dump_atual.txt:9126 templates/ui/dashboard.html:88
msgid "Prximas tarefas"
msgstr "Prximas tarefas"

#: docs/full_dump_atual.txt:9138 templates/ui/dashboard.html:100
msgid "Nenhuma tarefa proxima."
msgstr "Nenhuma tarefa proxima."

#: docs/full_dump_atual.txt:9146 templates/ui/dashboard.html:108
msgid "Progresso por disciplina"
msgstr "Progresso por disciplina"

#: docs/full_dump_atual.txt:9156 templates/ui/dashboard.html:118
#, python-format
msgid "Media atual: %(current)s | Media minima: %(passing)s"
msgstr "Media atual: %(current)s | Media minima: %(passing)s"

#: docs/full_dump_atual.txt:9164 docs/full_dump_atual.txt:9816
#: docs/full_dump_atual.txt:10025 templates/ui/dashboard.html:126
#: templates/ui/semester/semester_detail.html:79 templates/ui/semesters.html:85
msgid "Nenhuma disciplina cadastrada."
msgstr "Nenhuma disciplina cadastrada."

#: docs/full_dump_atual.txt:9170 templates/ui/dashboard.html:132
msgid "Status do Onboarding"
msgstr "Status do Onboarding"

#: docs/full_dump_atual.txt:9177 templates/ui/dashboard.html:139
msgid "Pendente"
msgstr "Pendente"

#: docs/full_dump_atual.txt:9179 templates/ui/dashboard.html:141
msgid "Ok"
msgstr "Ok"

#: docs/full_dump_atual.txt:9202 templates/ui/login.html:8
msgid "Bem-estar e organizacao para universitarios"
msgstr "Bem-estar e organizacao para universitarios"

#: docs/full_dump_atual.txt:9205 templates/ui/login.html:11
msgid "Acesso ao painel"
msgstr "Acesso ao painel"

#: docs/full_dump_atual.txt:9206 templates/ui/login.html:12
msgid "Entre com seu email institucional ou pessoal para continuar."
msgstr "Entre com seu email institucional ou pessoal para continuar."

#: docs/full_dump_atual.txt:9210 templates/ui/login.html:16
msgid "Email ou senha invalidos. Tente novamente."
msgstr "Email ou senha invalidos. Tente novamente."

#: docs/full_dump_atual.txt:9224 templates/ui/login.html:30
msgid "Mostrar"
msgstr "Mostrar"

#: docs/full_dump_atual.txt:9224 templates/ui/login.html:30
msgid "Ocultar"
msgstr "Ocultar"

#: docs/full_dump_atual.txt:9227 templates/ui/login.html:33
msgid "Entrar"
msgstr "Entrar"

#: docs/full_dump_atual.txt:9231 templates/ui/login.html:37
msgid "Esqueci minha senha"
msgstr "Esqueci minha senha"

#: docs/full_dump_atual.txt:9235 templates/ui/login.html:46
msgid "Dica: use o mesmo login do sistema administrativo se ja tiver acesso."
msgstr "Dica: use o mesmo login do sistema administrativo se ja tiver acesso."

#: docs/full_dump_atual.txt:9271 templates/ui/messages/message_list.html:15
msgid "Historico de notificacoes"
msgstr ""

#: docs/full_dump_atual.txt:9281 docs/full_dump_atual.txt:9955
#: docs/full_dump_atual.txt:10197 docs/full_dump_atual.txt:10281
#: templates/ui/messages/message_list.html:25 templates/ui/semesters.html:15
#: templates/ui/tasks.html:29 templates/ui/tasks/task_list.html:30
msgid "Todos os status"
msgstr "Todos os status"

#: docs/full_dump_atual.txt:9288 docs/full_dump_atual.txt:9314
#: templates/ui/messages/message_list.html:32
#: templates/ui/messages/message_list.html:59
msgid "Canal"
msgstr ""

#: docs/full_dump_atual.txt:9290 templates/ui/messages/message_list.html:34
#, fuzzy
#| msgid "Todos os tipos"
msgid "Todos os canais"
msgstr "Todos os tipos"

#: docs/full_dump_atual.txt:9316 templates/ui/messages/message_list.html:62
#, fuzzy
#| msgid "Agenda"
msgid "Agendado"
msgstr "Agenda"

#: docs/full_dump_atual.txt:9335 docs/full_dump_atual.txt:9372
#: templates/ui/messages.html:30 templates/ui/messages/message_list.html:100
msgid "Nenhuma mensagem registrada."
msgstr "Nenhuma mensagem registrada."

#: docs/full_dump_atual.txt:9350 templates/ui/messages.html:8
msgid "Avisos e comunicados in-app"
msgstr "Avisos e comunicados in-app"

#: docs/full_dump_atual.txt:9387 templates/ui/onboarding.html:8
msgid "Etapas para completar a configuracao"
msgstr "Etapas para completar a configuracao"

#: docs/full_dump_atual.txt:9413 templates/ui/onboarding.html:34
msgid "Acoes recomendadas"
msgstr "Acoes recomendadas"

#: docs/full_dump_atual.txt:9425 templates/ui/onboarding.html:46
msgid "Sugestoes rapidas"
msgstr "Sugestoes rapidas"

#: docs/full_dump_atual.txt:9428 templates/ui/onboarding.html:49
msgid "Ver semestres"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9429 templates/ui/onboarding.html:50
msgid "Ver tarefas"
msgstr "Ver tarefas"

#: docs/full_dump_atual.txt:9430 templates/ui/onboarding.html:51
msgid "Ver agenda"
msgstr "Ver agenda"

#: docs/full_dump_atual.txt:9431 templates/ui/onboarding.html:52
msgid "Cadastrar avaliacao (API)"
msgstr "Cadastrar avaliacao (API)"

#: docs/full_dump_atual.txt:9446 templates/ui/password_reset_complete.html:8
msgid "Senha atualizada"
msgstr "Senha atualizada"

#: docs/full_dump_atual.txt:9449 templates/ui/password_reset_complete.html:11
msgid "Senha redefinida"
msgstr "Senha redefinida"

#: docs/full_dump_atual.txt:9450 templates/ui/password_reset_complete.html:12
msgid "Sua senha foi atualizada. Voce ja pode acessar o painel."
msgstr "Sua senha foi atualizada. Voce ja pode acessar o painel."

#: docs/full_dump_atual.txt:9452 templates/ui/password_reset_complete.html:14
msgid "Ir para o login"
msgstr "Ir para o login"

#: docs/full_dump_atual.txt:9467 docs/full_dump_atual.txt:9474
#: templates/ui/password_reset_confirm.html:8
#: templates/ui/password_reset_confirm.html:15
msgid "Nova senha"
msgstr "Nova senha"

#: docs/full_dump_atual.txt:9470 templates/ui/password_reset_confirm.html:11
msgid "Definir nova senha"
msgstr "Definir nova senha"

#: docs/full_dump_atual.txt:9478 templates/ui/password_reset_confirm.html:19
msgid "Confirmar nova senha"
msgstr "Confirmar nova senha"

#: docs/full_dump_atual.txt:9481 templates/ui/password_reset_confirm.html:22
msgid "Atualizar senha"
msgstr "Atualizar senha"

#: docs/full_dump_atual.txt:9496 templates/ui/password_reset_done.html:8
msgid "Email enviado"
msgstr "Email enviado"

#: docs/full_dump_atual.txt:9499 templates/ui/password_reset_done.html:11
msgid "Verifique sua caixa de entrada"
msgstr "Verifique sua caixa de entrada"

#: docs/full_dump_atual.txt:9500 templates/ui/password_reset_done.html:12
msgid ""
"Se o email existir no sistema, voce recebera um link para redefinir a senha."
msgstr ""
"Se o email existir no sistema, voce recebera um link para redefinir a senha."

#: docs/full_dump_atual.txt:9502 docs/full_dump_atual.txt:9533
#: templates/ui/password_reset_done.html:14
#: templates/ui/password_reset_form.html:24
msgid "Voltar ao login"
msgstr "Voltar ao login"

#: docs/full_dump_atual.txt:9517 templates/ui/password_reset_form.html:8
msgid "Recuperacao de acesso"
msgstr "Recuperacao de acesso"

#: docs/full_dump_atual.txt:9520 templates/ui/password_reset_form.html:11
msgid "Redefinir senha"
msgstr "Redefinir senha"

#: docs/full_dump_atual.txt:9521 templates/ui/password_reset_form.html:12
msgid "Informe seu email para receber o link de redefinicao."
msgstr "Informe seu email para receber o link de redefinicao."

#: docs/full_dump_atual.txt:9527 templates/ui/password_reset_form.html:18
msgid "seu.email@universidade.edu"
msgstr "seu.email@universidade.edu"

#: docs/full_dump_atual.txt:9529 templates/ui/password_reset_form.html:20
msgid "Enviar link"
msgstr "Enviar link"

#: docs/full_dump_atual.txt:9549 docs/full_dump_atual.txt:9555
#: templates/ui/reminders/reminder_confirm_delete.html:9
#: templates/ui/reminders/reminder_confirm_delete.html:15
#, fuzzy
#| msgid "Ver semestres"
msgid "Excluir lembrete"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9556
#: templates/ui/reminders/reminder_confirm_delete.html:16
msgid "Tem certeza que deseja excluir a regra de lembrete"
msgstr ""

#: docs/full_dump_atual.txt:9577 docs/full_dump_atual.txt:9587
#: templates/ui/reminders/reminder_form.html:10
#: templates/ui/reminders/reminder_form.html:20
#, fuzzy
#| msgid "Ver semestres"
msgid "Editar lembrete"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9579 docs/full_dump_atual.txt:9590
#: docs/full_dump_atual.txt:9657 templates/ui/reminders/reminder_form.html:12
#: templates/ui/reminders/reminder_form.html:23
#: templates/ui/reminders/reminder_list.html:23
#, fuzzy
#| msgid "Ver semestres"
msgid "Novo lembrete"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9588 templates/ui/reminders/reminder_form.html:21
msgid "Atualize sua regra de lembrete."
msgstr ""

#: docs/full_dump_atual.txt:9591 templates/ui/reminders/reminder_form.html:24
msgid "Crie uma nova regra de lembrete."
msgstr ""

#: docs/full_dump_atual.txt:9655 templates/ui/reminders/reminder_list.html:15
msgid "Configure suas regras de lembrete."
msgstr ""

#: docs/full_dump_atual.txt:9690 templates/ui/reminders/reminder_list.html:57
#, fuzzy
#| msgid "Ativo"
msgid "Inativo"
msgstr "Ativo"

#: docs/full_dump_atual.txt:9703 templates/ui/reminders/reminder_list.html:70
#, fuzzy
#| msgid "Nenhuma tarefa cadastrada."
msgid "Nenhuma regra de lembrete cadastrada."
msgstr "Nenhuma tarefa cadastrada."

#: docs/full_dump_atual.txt:9719 docs/full_dump_atual.txt:9725
#: templates/ui/semester/semester_confirm_delete.html:9
#: templates/ui/semester/semester_confirm_delete.html:15
#, fuzzy
#| msgid "Ver semestres"
msgid "Excluir semestre"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9726
#: templates/ui/semester/semester_confirm_delete.html:16
msgid "Tem certeza que deseja excluir o semestre"
msgstr ""

#: docs/full_dump_atual.txt:9754 templates/ui/semester/semester_detail.html:17
msgid "Periodo"
msgstr ""

#: docs/full_dump_atual.txt:9760 templates/ui/semester/semester_detail.html:23
#, fuzzy
#| msgid "Disciplina"
msgid "Nova Disciplina"
msgstr "Disciplina"

#: docs/full_dump_atual.txt:9776 docs/full_dump_atual.txt:9910
#: templates/ui/semester/semester_detail.html:39
#: templates/ui/semester/semester_list.html:29
msgid "Termino"
msgstr ""

#: docs/full_dump_atual.txt:9793 docs/full_dump_atual.txt:9987
#: templates/ui/semester/semester_detail.html:56 templates/ui/semesters.html:47
msgid "Disciplina"
msgstr "Disciplina"

#: docs/full_dump_atual.txt:9806 docs/full_dump_atual.txt:9923
#: docs/full_dump_atual.txt:10235 templates/ui/semester/semester_detail.html:69
#: templates/ui/semester/semester_list.html:42
#: templates/ui/tasks/task_list.html:68
msgid "Ver"
msgstr ""

#: docs/full_dump_atual.txt:9833 docs/full_dump_atual.txt:9843
#: templates/ui/semester/semester_form.html:10
#: templates/ui/semester/semester_form.html:20
#, fuzzy
#| msgid "Ver semestres"
msgid "Editar semestre"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9835 docs/full_dump_atual.txt:9846
#: templates/ui/semester/semester_form.html:12
#: templates/ui/semester/semester_form.html:23
#, fuzzy
#| msgid "Ver semestres"
msgid "Novo semestre"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9847 templates/ui/semester/semester_form.html:24
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Cadastre um novo semestre."
msgstr "Nenhum semestre cadastrado."

#: docs/full_dump_atual.txt:9896 templates/ui/semester/semester_list.html:15
msgid "Gerencie seus semestres e disciplinas."
msgstr ""

#: docs/full_dump_atual.txt:9898 templates/ui/semester/semester_list.html:17
#, fuzzy
#| msgid "Semestres"
msgid "Novo Semestre"
msgstr "Semestres"

#: docs/full_dump_atual.txt:9933 docs/full_dump_atual.txt:10031
#: templates/ui/semester/semester_list.html:52 templates/ui/semesters.html:91
msgid "Nenhum semestre cadastrado."
msgstr "Nenhum semestre cadastrado."

#: docs/full_dump_atual.txt:9948 templates/ui/semesters.html:8
msgid "Resumo das disciplinas e progresso"
msgstr "Resumo das disciplinas e progresso"

#: docs/full_dump_atual.txt:9957 templates/ui/semesters.html:17
msgid "Finalizado"
msgstr "Finalizado"

#: docs/full_dump_atual.txt:9961 templates/ui/semesters.html:21
#, fuzzy
#| msgid "Progresso por disciplina"
msgid "Filtrar por disciplina"
msgstr "Progresso por disciplina"

#: docs/full_dump_atual.txt:9965 templates/ui/semesters.html:25
msgid "Filtrar por professor"
msgstr ""

#: docs/full_dump_atual.txt:9991 templates/ui/semesters.html:51
msgid "Progresso"
msgstr "Progresso"

#: docs/full_dump_atual.txt:10002 templates/ui/semesters.html:62
msgid "Aprovado"
msgstr "Aprovado"

#: docs/full_dump_atual.txt:10004 templates/ui/semesters.html:64
msgid "Reprovado"
msgstr "Reprovado"

#: docs/full_dump_atual.txt:10006 docs/full_dump_atual.txt:10199
#: docs/full_dump_atual.txt:10283 docs/full_dump_atual.txt:10328
#: templates/ui/semesters.html:66 templates/ui/tasks.html:31
#: templates/ui/tasks.html:76 templates/ui/tasks/task_list.html:32
msgid "Em andamento"
msgstr "Em andamento"

#: docs/full_dump_atual.txt:10045 docs/full_dump_atual.txt:10051
#: templates/ui/tasks/task_confirm_delete.html:9
#: templates/ui/tasks/task_confirm_delete.html:15
#, fuzzy
#| msgid "Ver semestres"
msgid "Excluir tarefa"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:10052
#: templates/ui/tasks/task_confirm_delete.html:16
msgid "Tem certeza que deseja excluir a tarefa"
msgstr ""

#: docs/full_dump_atual.txt:10079 docs/full_dump_atual.txt:10221
#: docs/full_dump_atual.txt:10310 templates/ui/tasks.html:58
#: templates/ui/tasks/task_detail.html:16 templates/ui/tasks/task_list.html:54
msgid "Entrega"
msgstr "Entrega"

#: docs/full_dump_atual.txt:10096 templates/ui/tasks/task_detail.html:33
#, fuzzy
#| msgid "Ver semestres"
msgid "Nivel de estresse"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:10119 docs/full_dump_atual.txt:10129
#: templates/ui/tasks/task_form.html:10 templates/ui/tasks/task_form.html:20
#, fuzzy
#| msgid "Ver semestres"
msgid "Editar tarefa"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:10121 docs/full_dump_atual.txt:10132
#: docs/full_dump_atual.txt:10184 templates/ui/tasks/task_form.html:12
#: templates/ui/tasks/task_form.html:23 templates/ui/tasks/task_list.html:17
#, fuzzy
#| msgid "Buscar tarefa"
msgid "Nova tarefa"
msgstr "Buscar tarefa"

#: docs/full_dump_atual.txt:10133 templates/ui/tasks/task_form.html:24
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Cadastre uma nova tarefa."
msgstr "Nenhum semestre cadastrado."

#: docs/full_dump_atual.txt:10182 templates/ui/tasks/task_list.html:15
msgid "Organize suas tarefas e prazos."
msgstr ""

#: docs/full_dump_atual.txt:10191 templates/ui/tasks/task_list.html:24
#, fuzzy
#| msgid "Buscar evento"
msgid "Buscar"
msgstr "Buscar evento"

#: docs/full_dump_atual.txt:10192 docs/full_dump_atual.txt:10266
#: templates/ui/tasks.html:14 templates/ui/tasks/task_list.html:25
msgid "Buscar tarefa"
msgstr "Buscar tarefa"

#: docs/full_dump_atual.txt:10198 docs/full_dump_atual.txt:10282
#: docs/full_dump_atual.txt:10330 templates/ui/tasks.html:30
#: templates/ui/tasks.html:78 templates/ui/tasks/task_list.html:31
msgid "A fazer"
msgstr "A fazer"

#: docs/full_dump_atual.txt:10200 docs/full_dump_atual.txt:10284
#: docs/full_dump_atual.txt:10326 templates/ui/tasks.html:32
#: templates/ui/tasks.html:74 templates/ui/tasks/task_list.html:33
msgid "Concluida"
msgstr "Concluida"

#: docs/full_dump_atual.txt:10220 templates/ui/tasks/task_list.html:53
#: utils/constants.py:61
#, fuzzy
#| msgid "Tarefas"
msgid "Tarefa"
msgstr "Tarefas"

#: docs/full_dump_atual.txt:10223 templates/ui/tasks/task_list.html:56
#, fuzzy
#| msgid "Stress"
msgid "Estresse"
msgstr "Stress"

#: docs/full_dump_atual.txt:10245 docs/full_dump_atual.txt:10339
#: templates/ui/tasks.html:87 templates/ui/tasks/task_list.html:78
msgid "Nenhuma tarefa cadastrada."
msgstr "Nenhuma tarefa cadastrada."

#: docs/full_dump_atual.txt:10260 templates/ui/tasks.html:8
msgid "Lista de tarefas academicas"
msgstr "Lista de tarefas academicas"

#: docs/full_dump_atual.txt:10271 docs/full_dump_atual.txt:10311
#: templates/ui/tasks.html:19 templates/ui/tasks.html:59
msgid "Stress"
msgstr "Stress"

#: docs/full_dump_atual.txt:10289 templates/ui/tasks.html:37
msgid "Todas as datas"
msgstr "Todas as datas"

#: docs/full_dump_atual.txt:10290 templates/ui/tasks.html:38
msgid "Atrasadas"
msgstr "Atrasadas"

#: docs/full_dump_atual.txt:10291 templates/ui/tasks.html:39
msgid "Hoje"
msgstr "Hoje"

#: docs/full_dump_atual.txt:10292 templates/ui/tasks.html:40
msgid "Proxima semana"
msgstr "Proxima semana"

#: docs/full_dump_atual.txt:10293 templates/ui/tasks.html:41
msgid "Proximo mes"
msgstr "Proximo mes"

#: templates/ui/first_access.html:9
msgid "Primeiro acesso"
msgstr ""

#: templates/ui/first_access.html:12 templates/ui/first_access.html:66
msgid "Criar conta"
msgstr ""

#: templates/ui/first_access.html:13
msgid "Preencha seus dados para iniciar no Campus Calm."
msgstr ""

#: templates/ui/first_access.html:18
msgid "Revise os campos abaixo."
msgstr ""

#: templates/ui/first_access.html:71
#, fuzzy
#| msgid "Voltar ao login"
msgid "Voltar para login"
msgstr "Voltar ao login"

#: templates/ui/login.html:42
msgid "Primeiro acesso / Criar conta"
msgstr ""

#: templates/ui/messages/message_list.html:61
msgid "Acao"
msgstr ""

#: templates/ui/messages/message_list.html:63
#, fuzzy
#| msgid "Email enviado"
msgid "Enviado"
msgstr "Email enviado"

#: templates/ui/messages/message_list.html:64
msgid "Tentativas"
msgstr ""

#: templates/ui/messages/message_list.html:65
msgid "Erro"
msgstr ""

#: templates/ui/reminders/reminder_list.html:21
#, fuzzy
#| msgid "Ver semestres"
msgid "Gerar lembretes"
msgstr "Ver semestres"

#: utils/constants.py:34
msgid "Todo"
msgstr "A fazer"

#: utils/constants.py:35
msgid "Doing"
msgstr "Em andamento"

#: utils/constants.py:36
msgid "Done"
msgstr "Concluda"

#: utils/gating.py:15
msgid "Complete seu perfil para continuar."
msgstr ""

#: utils/gating.py:16
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Crie um semestre ativo."
msgstr "Nenhum semestre cadastrado."

#: utils/gating.py:17
msgid "Cadastre ao menos uma disciplina."
msgstr ""

#: utils/gating.py:18
#, fuzzy
#| msgid "Cadastrar avaliacao (API)"
msgid "Cadastre ao menos uma avaliacao."
msgstr "Cadastrar avaliacao (API)"

#: utils/gating.py:19
msgid "Configure pelo menos uma regra de lembrete."
msgstr ""

#: utils/gating.py:20
msgid "Tudo pronto para seu dashboard."
msgstr ""

### locale/pt_PT/LC_MESSAGES/django.po
--------------------------------------------------------------------------------
msgid ""
msgstr ""
"Project-Id-Version: Campus Calm\n"
"Report-Msgid-Bugs-To: \n"
"POT-Creation-Date: 2026-02-02 11:09-0300\n"
"PO-Revision-Date: 2026-01-29 13:10+0000\n"
"Last-Translator: \n"
"Language-Team: \n"
"Language: pt_PT\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"
"Plural-Forms: nplurals=2; plural=(n != 1);\n"

#: apps/ui/forms.py:8 apps/ui/forms.py:27 docs/full_dump_atual.txt:9526
#: templates/ui/password_reset_form.html:17
msgid "Email"
msgstr "Email"

#: apps/ui/forms.py:12 apps/ui/forms.py:41
msgid "Senha"
msgstr ""

#: apps/ui/forms.py:22
msgid "Free"
msgstr ""

#: apps/ui/forms.py:23
msgid "Pago"
msgstr ""

#: apps/ui/forms.py:26 docs/full_dump_atual.txt:9908
#: templates/ui/semester/semester_list.html:27
msgid "Nome"
msgstr "Nome"

#: apps/ui/forms.py:29
msgid "Telefone (WhatsApp)"
msgstr ""

#: apps/ui/forms.py:35
msgid "Plano"
msgstr ""

#: apps/ui/forms.py:46
#, fuzzy
#| msgid "Confirmar nova senha"
msgid "Confirmar senha"
msgstr "Confirmar nova palavra-passe"

#: apps/ui/forms.py:51
msgid "Receber email"
msgstr ""

#: apps/ui/forms.py:57
msgid "Receber WhatsApp"
msgstr ""

#: apps/ui/forms.py:63
msgid "Receber SMS"
msgstr ""

#: apps/ui/forms.py:72
msgid "As senhas nao conferem."
msgstr ""

#: apps/ui/forms_academic.py:13
msgid "Nome do semestre"
msgstr "Nome do semestre"

#: apps/ui/forms_academic.py:14
msgid "Data de inicio"
msgstr "Data de incio"

#: apps/ui/forms_academic.py:15
msgid "Data de termino"
msgstr "Data de fim"

#: apps/ui/forms_academic.py:16 apps/ui/forms_academic.py:35
#: apps/ui/forms_tasks.py:16 docs/full_dump_atual.txt:8924
#: docs/full_dump_atual.txt:9279 docs/full_dump_atual.txt:9315
#: docs/full_dump_atual.txt:9670 docs/full_dump_atual.txt:9768
#: docs/full_dump_atual.txt:9795 docs/full_dump_atual.txt:9911
#: docs/full_dump_atual.txt:9989 docs/full_dump_atual.txt:10092
#: docs/full_dump_atual.txt:10195 docs/full_dump_atual.txt:10222
#: docs/full_dump_atual.txt:10312 templates/ui/course/course_detail.html:48
#: templates/ui/messages/message_list.html:23
#: templates/ui/messages/message_list.html:60
#: templates/ui/reminders/reminder_list.html:37
#: templates/ui/semester/semester_detail.html:31
#: templates/ui/semester/semester_detail.html:58
#: templates/ui/semester/semester_list.html:30 templates/ui/semesters.html:49
#: templates/ui/tasks.html:60 templates/ui/tasks/task_detail.html:29
#: templates/ui/tasks/task_list.html:28 templates/ui/tasks/task_list.html:55
msgid "Status"
msgstr "Estado"

#: apps/ui/forms_academic.py:31
msgid "Nome da disciplina"
msgstr "Nome da unidade curricular"

#: apps/ui/forms_academic.py:32 docs/full_dump_atual.txt:9794
#: docs/full_dump_atual.txt:9988 templates/ui/semester/semester_detail.html:57
#: templates/ui/semesters.html:48
msgid "Professor"
msgstr "Docente"

#: apps/ui/forms_academic.py:33
msgid "Creditos"
msgstr "Crditos"

#: apps/ui/forms_academic.py:34 docs/full_dump_atual.txt:8912
#: templates/ui/course/course_detail.html:36
msgid "Nota minima"
msgstr "Classificao mnima"

#: apps/ui/forms_academic.py:36
msgid "Nota final"
msgstr "Classificao final"

#: apps/ui/forms_academic.py:37
msgid "Anotacoes"
msgstr "Anotaes"

#: apps/ui/forms_academic.py:52
msgid "A nota minima deve ser maior que zero."
msgstr "A classificao mnima deve ser superior a zero."

#: apps/ui/forms_academic.py:61 apps/ui/forms_agenda.py:13
#: apps/ui/forms_tasks.py:12 docs/full_dump_atual.txt:9313
#: docs/full_dump_atual.txt:10309 templates/ui/messages/message_list.html:58
#: templates/ui/tasks.html:57
msgid "Titulo"
msgstr "Ttulo"

#: apps/ui/forms_academic.py:62
msgid "Nota obtida"
msgstr "Classificao obtida"

#: apps/ui/forms_academic.py:63
msgid "Nota maxima"
msgstr "Classificao mxima"

#: apps/ui/forms_academic.py:64 docs/full_dump_atual.txt:8950
#: templates/ui/course/course_detail.html:74
msgid "Peso"
msgstr ""

#: apps/ui/forms_academic.py:65 docs/full_dump_atual.txt:8951
#: templates/ui/course/course_detail.html:75
msgid "Data"
msgstr ""

#: apps/ui/forms_academic.py:81
msgid "A nota obtida nao pode ser maior que a nota maxima."
msgstr "A classificao obtida no pode ser superior  classificao mxima."

#: apps/ui/forms_academic.py:83
msgid "O peso deve ser maior ou igual a zero."
msgstr "O peso deve ser maior ou igual a zero."

#: apps/ui/forms_agenda.py:14 docs/full_dump_atual.txt:8599
#: docs/full_dump_atual.txt:9667 templates/ui/agenda/agenda_list.html:28
#: templates/ui/reminders/reminder_list.html:34
msgid "Tipo"
msgstr "Tipo"

#: apps/ui/forms_agenda.py:15 docs/full_dump_atual.txt:8600
#: docs/full_dump_atual.txt:9772 docs/full_dump_atual.txt:9909
#: templates/ui/agenda/agenda_list.html:29
#: templates/ui/semester/semester_detail.html:35
#: templates/ui/semester/semester_list.html:28
msgid "Inicio"
msgstr "Incio"

#: apps/ui/forms_agenda.py:16 docs/full_dump_atual.txt:8601
#: templates/ui/agenda/agenda_list.html:30
msgid "Fim"
msgstr "Fim"

#: apps/ui/forms_agenda.py:17
msgid "Tarefa relacionada"
msgstr "Tarefa relacionada"

#: apps/ui/forms_agenda.py:18
msgid "Observacoes"
msgstr "Observaes"

#: apps/ui/forms_agenda.py:43
msgid "Estudos"
msgstr "Estudos"

#: apps/ui/forms_reminders.py:19 docs/full_dump_atual.txt:9669
#: templates/ui/reminders/reminder_list.html:36
msgid "Canais"
msgstr "Canais"

#: apps/ui/forms_reminders.py:27
msgid "Tipo de alvo"
msgstr "Tipo de alvo"

#: apps/ui/forms_reminders.py:28 docs/full_dump_atual.txt:9668
#: templates/ui/reminders/reminder_list.html:35
msgid "Minutos antes"
msgstr "Minutos antes"

#: apps/ui/forms_reminders.py:29 docs/full_dump_atual.txt:9688
#: docs/full_dump_atual.txt:9956 templates/ui/reminders/reminder_list.html:55
#: templates/ui/semesters.html:16
msgid "Ativo"
msgstr "Ativo"

#: apps/ui/forms_reminders.py:45
msgid "Informe um valor maior que zero."
msgstr "Indique um valor superior a zero."

#: apps/ui/forms_tasks.py:13 docs/full_dump_atual.txt:10100
#: templates/ui/tasks/task_detail.html:37
msgid "Descricao"
msgstr "Descrio"

#: apps/ui/forms_tasks.py:14
msgid "Data de entrega"
msgstr "Data de entrega"

#: apps/ui/forms_tasks.py:15
msgid "Nivel de estresse(0 a 5)"
msgstr "Nvel de stress (0 a 5)"

#: apps/ui/views.py:41
msgid "Perfil"
msgstr "Perfil"

#: apps/ui/views.py:42
msgid "Semestre"
msgstr "Semestre"

#: apps/ui/views.py:43 docs/full_dump_atual.txt:9786
#: templates/ui/semester/semester_detail.html:49
msgid "Disciplinas"
msgstr "Unidades curriculares"

#: apps/ui/views.py:44 docs/full_dump_atual.txt:8941
#: templates/ui/course/course_detail.html:65
msgid "Avaliacoes"
msgstr "Avaliaes"

#: apps/ui/views.py:45 docs/full_dump_atual.txt:8436
#: docs/full_dump_atual.txt:9548 docs/full_dump_atual.txt:9575
#: docs/full_dump_atual.txt:9648 docs/full_dump_atual.txt:9654
#: templates/base.html:62 templates/ui/reminders/reminder_confirm_delete.html:8
#: templates/ui/reminders/reminder_form.html:8
#: templates/ui/reminders/reminder_list.html:8
#: templates/ui/reminders/reminder_list.html:14
msgid "Lembretes"
msgstr "Lembretes"

#: apps/ui/views.py:46 docs/full_dump_atual.txt:8421
#: docs/full_dump_atual.txt:8493 docs/full_dump_atual.txt:8520
#: docs/full_dump_atual.txt:8578 docs/full_dump_atual.txt:8722
#: docs/full_dump_atual.txt:8751 docs/full_dump_atual.txt:8855
#: docs/full_dump_atual.txt:8883 docs/full_dump_atual.txt:8986
#: docs/full_dump_atual.txt:9046 docs/full_dump_atual.txt:9263
#: docs/full_dump_atual.txt:9547 docs/full_dump_atual.txt:9574
#: docs/full_dump_atual.txt:9647 docs/full_dump_atual.txt:9717
#: docs/full_dump_atual.txt:9744 docs/full_dump_atual.txt:9830
#: docs/full_dump_atual.txt:9888 docs/full_dump_atual.txt:10043
#: docs/full_dump_atual.txt:10070 docs/full_dump_atual.txt:10116
#: docs/full_dump_atual.txt:10174 templates/base.html:47
#: templates/ui/agenda/agenda_confirm_delete.html:7
#: templates/ui/agenda/agenda_form.html:7
#: templates/ui/agenda/agenda_list.html:7
#: templates/ui/assessment/assessment_confirm_delete.html:7
#: templates/ui/assessment/assessment_form.html:7
#: templates/ui/course/course_confirm_delete.html:7
#: templates/ui/course/course_detail.html:7
#: templates/ui/course/course_form.html:7 templates/ui/dashboard.html:8
#: templates/ui/messages/message_list.html:7
#: templates/ui/reminders/reminder_confirm_delete.html:7
#: templates/ui/reminders/reminder_form.html:7
#: templates/ui/reminders/reminder_list.html:7
#: templates/ui/semester/semester_confirm_delete.html:7
#: templates/ui/semester/semester_detail.html:7
#: templates/ui/semester/semester_form.html:7
#: templates/ui/semester/semester_list.html:7
#: templates/ui/tasks/task_confirm_delete.html:7
#: templates/ui/tasks/task_detail.html:7 templates/ui/tasks/task_form.html:7
#: templates/ui/tasks/task_list.html:7
msgid "Dashboard"
msgstr "Dashboard"

#: apps/ui/views.py:61
msgid "Concluido"
msgstr "Concludo"

#: apps/ui/views.py:80
msgid "Ja existe um usuario com este email."
msgstr ""

#: apps/ui/views.py:104
msgid "Conta criada com sucesso. Faca login para continuar."
msgstr ""

#: apps/ui/views_academic.py:25
msgid "Semestre criado com sucesso."
msgstr "Semestre criado com sucesso."

#: apps/ui/views_academic.py:50
msgid "Semestre atualizado com sucesso."
msgstr "Semestre atualizado com sucesso."

#: apps/ui/views_academic.py:66
msgid "Semestre excluido com sucesso."
msgstr "Semestre eliminado com sucesso."

#: apps/ui/views_academic.py:84
msgid "Disciplina criada com sucesso."
msgstr "Unidade curricular criada com sucesso."

#: apps/ui/views_academic.py:114
msgid "Disciplina atualizada com sucesso."
msgstr "Unidade curricular atualizada com sucesso."

#: apps/ui/views_academic.py:131
msgid "Disciplina excluida com sucesso."
msgstr "Unidade curricular eliminada com sucesso."

#: apps/ui/views_academic.py:149
msgid "Avaliacao criada com sucesso."
msgstr "Avaliao criada com sucesso."

#: apps/ui/views_academic.py:167
msgid "Avaliacao atualizada com sucesso."
msgstr "Avaliao atualizada com sucesso."

#: apps/ui/views_academic.py:184
msgid "Avaliacao excluida com sucesso."
msgstr "Avaliao eliminada com sucesso."

#: apps/ui/views_agenda.py:35
msgid "Evento criado com sucesso."
msgstr "Evento criado com sucesso."

#: apps/ui/views_agenda.py:51
msgid "Evento atualizado com sucesso."
msgstr "Evento atualizado com sucesso."

#: apps/ui/views_agenda.py:63
msgid "Evento excluido com sucesso."
msgstr "Evento eliminado com sucesso."

#: apps/ui/views_reminders.py:25
#, fuzzy
#| msgid "Semestre criado com sucesso."
msgid "Lembretes gerados com sucesso."
msgstr "Semestre criado com sucesso."

#: apps/ui/views_reminders.py:27
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Nenhum lembrete novo foi gerado."
msgstr "Nenhum semestre registado."

#: apps/ui/views_reminders.py:39
msgid "Regra de lembrete criada com sucesso."
msgstr "Regra de lembrete criada com sucesso."

#: apps/ui/views_reminders.py:53
msgid "Regra de lembrete atualizada com sucesso."
msgstr "Regra de lembrete atualizada com sucesso."

#: apps/ui/views_reminders.py:69
msgid "Regra de lembrete excluida com sucesso."
msgstr "Regra de lembrete eliminada com sucesso."

#: apps/ui/views_tasks.py:47
msgid "Tarefa criada com sucesso."
msgstr "Tarefa criada com sucesso."

#: apps/ui/views_tasks.py:69
msgid "Tarefa atualizada com sucesso."
msgstr "Tarefa atualizada com sucesso."

#: apps/ui/views_tasks.py:81
msgid "Tarefa excluida com sucesso."
msgstr "Tarefa eliminada com sucesso."

#: config/settings.py:104
msgid "English"
msgstr ""

#: config/settings.py:105
msgid "Portugus (Brasil)"
msgstr ""

#: config/settings.py:106
msgid "Portugus (Portugal)"
msgstr ""

#: docs/full_dump_atual.txt:8397 templates/base.html:23
msgid "Painel do aluno"
msgstr "Painel do estudante"

#: docs/full_dump_atual.txt:8400 templates/base.html:26
#, python-format
msgid "Ol, %(name)s"
msgstr "Ol, %(name)s"

#: docs/full_dump_atual.txt:8405 docs/full_dump_atual.txt:8826
#: templates/base.html:31 templates/ui/auth_base.html:22
msgid "Idioma"
msgstr "Idioma"

#: docs/full_dump_atual.txt:8424 docs/full_dump_atual.txt:9386
#: templates/base.html:50 templates/ui/onboarding.html:7
msgid "Onboarding"
msgstr "Onboarding"

#: docs/full_dump_atual.txt:8427 docs/full_dump_atual.txt:8723
#: docs/full_dump_atual.txt:8752 docs/full_dump_atual.txt:8856
#: docs/full_dump_atual.txt:8884 docs/full_dump_atual.txt:8987
#: docs/full_dump_atual.txt:9718 docs/full_dump_atual.txt:9745
#: docs/full_dump_atual.txt:9831 docs/full_dump_atual.txt:9889
#: docs/full_dump_atual.txt:9895 docs/full_dump_atual.txt:9947
#: templates/base.html:53
#: templates/ui/assessment/assessment_confirm_delete.html:8
#: templates/ui/assessment/assessment_form.html:8
#: templates/ui/course/course_confirm_delete.html:8
#: templates/ui/course/course_detail.html:8
#: templates/ui/course/course_form.html:8
#: templates/ui/semester/semester_confirm_delete.html:8
#: templates/ui/semester/semester_detail.html:8
#: templates/ui/semester/semester_form.html:8
#: templates/ui/semester/semester_list.html:8
#: templates/ui/semester/semester_list.html:14 templates/ui/semesters.html:7
msgid "Semestres"
msgstr "Semestres"

#: docs/full_dump_atual.txt:8430 docs/full_dump_atual.txt:10044
#: docs/full_dump_atual.txt:10071 docs/full_dump_atual.txt:10117
#: docs/full_dump_atual.txt:10175 docs/full_dump_atual.txt:10181
#: docs/full_dump_atual.txt:10259 templates/base.html:56
#: templates/ui/tasks.html:7 templates/ui/tasks/task_confirm_delete.html:8
#: templates/ui/tasks/task_detail.html:8 templates/ui/tasks/task_form.html:8
#: templates/ui/tasks/task_list.html:8 templates/ui/tasks/task_list.html:14
msgid "Tarefas"
msgstr "Tarefas"

#: docs/full_dump_atual.txt:8433 docs/full_dump_atual.txt:8494
#: docs/full_dump_atual.txt:8521 docs/full_dump_atual.txt:8579
#: docs/full_dump_atual.txt:8585 docs/full_dump_atual.txt:8636
#: templates/base.html:59 templates/ui/agenda.html:7
#: templates/ui/agenda/agenda_confirm_delete.html:8
#: templates/ui/agenda/agenda_form.html:8
#: templates/ui/agenda/agenda_list.html:8
#: templates/ui/agenda/agenda_list.html:14
msgid "Agenda"
msgstr "Agenda"

#: docs/full_dump_atual.txt:8439 docs/full_dump_atual.txt:9264
#: docs/full_dump_atual.txt:9270 docs/full_dump_atual.txt:9349
#: templates/base.html:65 templates/ui/messages.html:7
#: templates/ui/messages/message_list.html:8
#: templates/ui/messages/message_list.html:14
msgid "Mensagens"
msgstr "Mensagens"

#: docs/full_dump_atual.txt:8445 templates/base.html:71
msgid "Sair"
msgstr "Sair"

#: docs/full_dump_atual.txt:8457 templates/base.html:83
msgid "Fechar"
msgstr "Fechar"

#: docs/full_dump_atual.txt:8495 docs/full_dump_atual.txt:8501
#: templates/ui/agenda/agenda_confirm_delete.html:9
#: templates/ui/agenda/agenda_confirm_delete.html:15
msgid "Excluir evento"
msgstr "Eliminar evento"

#: docs/full_dump_atual.txt:8502
#: templates/ui/agenda/agenda_confirm_delete.html:16
msgid "Tem certeza que deseja excluir o evento"
msgstr "Tem a certeza de que pretende eliminar o evento"

#: docs/full_dump_atual.txt:8505 docs/full_dump_atual.txt:8736
#: docs/full_dump_atual.txt:8868 docs/full_dump_atual.txt:9559
#: docs/full_dump_atual.txt:9729 docs/full_dump_atual.txt:10055
#: templates/ui/agenda/agenda_confirm_delete.html:19
#: templates/ui/assessment/assessment_confirm_delete.html:21
#: templates/ui/course/course_confirm_delete.html:20
#: templates/ui/reminders/reminder_confirm_delete.html:19
#: templates/ui/semester/semester_confirm_delete.html:19
#: templates/ui/tasks/task_confirm_delete.html:19
msgid "Cancelar"
msgstr "Cancelar"

#: docs/full_dump_atual.txt:8506 docs/full_dump_atual.txt:8614
#: docs/full_dump_atual.txt:8737 docs/full_dump_atual.txt:8869
#: docs/full_dump_atual.txt:8964 docs/full_dump_atual.txt:9560
#: docs/full_dump_atual.txt:9695 docs/full_dump_atual.txt:9730
#: docs/full_dump_atual.txt:9808 docs/full_dump_atual.txt:9925
#: docs/full_dump_atual.txt:10056 docs/full_dump_atual.txt:10084
#: docs/full_dump_atual.txt:10237
#: templates/ui/agenda/agenda_confirm_delete.html:20
#: templates/ui/agenda/agenda_list.html:43
#: templates/ui/assessment/assessment_confirm_delete.html:22
#: templates/ui/course/course_confirm_delete.html:21
#: templates/ui/course/course_detail.html:88
#: templates/ui/reminders/reminder_confirm_delete.html:20
#: templates/ui/reminders/reminder_list.html:62
#: templates/ui/semester/semester_confirm_delete.html:20
#: templates/ui/semester/semester_detail.html:71
#: templates/ui/semester/semester_list.html:44
#: templates/ui/tasks/task_confirm_delete.html:20
#: templates/ui/tasks/task_detail.html:21 templates/ui/tasks/task_list.html:70
msgid "Excluir"
msgstr "Eliminar"

#: docs/full_dump_atual.txt:8523 docs/full_dump_atual.txt:8533
#: templates/ui/agenda/agenda_form.html:10
#: templates/ui/agenda/agenda_form.html:20
msgid "Editar evento"
msgstr "Editar evento"

#: docs/full_dump_atual.txt:8525 docs/full_dump_atual.txt:8536
#: docs/full_dump_atual.txt:8588 templates/ui/agenda/agenda_form.html:12
#: templates/ui/agenda/agenda_form.html:23
#: templates/ui/agenda/agenda_list.html:17
msgid "Novo evento"
msgstr "Novo evento"

#: docs/full_dump_atual.txt:8537 templates/ui/agenda/agenda_form.html:24
msgid "Cadastre um novo evento."
msgstr "Crie um novo evento."

#: docs/full_dump_atual.txt:8540 docs/full_dump_atual.txt:8773
#: docs/full_dump_atual.txt:8896 docs/full_dump_atual.txt:9007
#: docs/full_dump_atual.txt:9594 docs/full_dump_atual.txt:9758
#: docs/full_dump_atual.txt:9850 docs/full_dump_atual.txt:10082
#: docs/full_dump_atual.txt:10136 templates/ui/agenda/agenda_form.html:27
#: templates/ui/assessment/assessment_form.html:29
#: templates/ui/course/course_detail.html:20
#: templates/ui/course/course_form.html:28
#: templates/ui/reminders/reminder_form.html:27
#: templates/ui/semester/semester_detail.html:21
#: templates/ui/semester/semester_form.html:27
#: templates/ui/tasks/task_detail.html:19 templates/ui/tasks/task_form.html:27
msgid "Voltar"
msgstr "Voltar"

#: docs/full_dump_atual.txt:8563 docs/full_dump_atual.txt:8796
#: docs/full_dump_atual.txt:9030 docs/full_dump_atual.txt:9632
#: docs/full_dump_atual.txt:9873 docs/full_dump_atual.txt:10159
#: templates/ui/agenda/agenda_form.html:50
#: templates/ui/assessment/assessment_form.html:52
#: templates/ui/course/course_form.html:51
#: templates/ui/reminders/reminder_form.html:65
#: templates/ui/semester/semester_form.html:50
#: templates/ui/tasks/task_form.html:50
msgid "Salvar"
msgstr "Guardar"

#: docs/full_dump_atual.txt:8563 docs/full_dump_atual.txt:8796
#: docs/full_dump_atual.txt:9030 docs/full_dump_atual.txt:9632
#: docs/full_dump_atual.txt:9873 docs/full_dump_atual.txt:10159
#: templates/ui/agenda/agenda_form.html:50
#: templates/ui/assessment/assessment_form.html:52
#: templates/ui/course/course_form.html:51
#: templates/ui/reminders/reminder_form.html:65
#: templates/ui/semester/semester_form.html:50
#: templates/ui/tasks/task_form.html:50
msgid "Criar"
msgstr "Criar"

#: docs/full_dump_atual.txt:8586 templates/ui/agenda/agenda_list.html:15
msgid "Seus eventos e compromissos."
msgstr "Os seus eventos e compromissos."

#: docs/full_dump_atual.txt:8598 templates/ui/agenda/agenda_list.html:27
#: utils/constants.py:62
msgid "Evento"
msgstr "Evento"

#: docs/full_dump_atual.txt:8602 docs/full_dump_atual.txt:8952
#: docs/full_dump_atual.txt:9671 docs/full_dump_atual.txt:9796
#: docs/full_dump_atual.txt:9912 docs/full_dump_atual.txt:10224
#: templates/ui/agenda/agenda_list.html:31
#: templates/ui/course/course_detail.html:76
#: templates/ui/reminders/reminder_list.html:38
#: templates/ui/semester/semester_detail.html:59
#: templates/ui/semester/semester_list.html:31
#: templates/ui/tasks/task_list.html:57
msgid "Acoes"
msgstr "Aes"

#: docs/full_dump_atual.txt:8613 docs/full_dump_atual.txt:8897
#: docs/full_dump_atual.txt:8963 docs/full_dump_atual.txt:9694
#: docs/full_dump_atual.txt:9759 docs/full_dump_atual.txt:9807
#: docs/full_dump_atual.txt:9924 docs/full_dump_atual.txt:10083
#: docs/full_dump_atual.txt:10236 templates/ui/agenda/agenda_list.html:42
#: templates/ui/course/course_detail.html:21
#: templates/ui/course/course_detail.html:87
#: templates/ui/reminders/reminder_list.html:61
#: templates/ui/semester/semester_detail.html:22
#: templates/ui/semester/semester_detail.html:70
#: templates/ui/semester/semester_list.html:43
#: templates/ui/tasks/task_detail.html:20 templates/ui/tasks/task_list.html:69
msgid "Editar"
msgstr "Editar"

#: docs/full_dump_atual.txt:8622 templates/ui/agenda/agenda_list.html:51
msgid "Nenhum evento cadastrado."
msgstr "Nenhum evento registado."

#: docs/full_dump_atual.txt:8637 templates/ui/agenda.html:8
#, python-format
msgid "Eventos dos proximos %(days)s dias"
msgstr "Eventos dos prximos %(days)s dias"

#: docs/full_dump_atual.txt:8643 templates/ui/agenda.html:14
msgid "Buscar evento"
msgstr "Procurar evento"

#: docs/full_dump_atual.txt:8648 templates/ui/agenda.html:19
msgid "Todos os tipos"
msgstr "Todos os tipos"

#: docs/full_dump_atual.txt:8656 templates/ui/agenda.html:27
msgid "Proximos 7 dias"
msgstr "Prximos 7 dias"

#: docs/full_dump_atual.txt:8657 templates/ui/agenda.html:28
msgid "Proximos 15 dias"
msgstr "Prximos 15 dias"

#: docs/full_dump_atual.txt:8658 templates/ui/agenda.html:29
msgid "Proximos 30 dias"
msgstr "Prximos 30 dias"

#: docs/full_dump_atual.txt:8659 templates/ui/agenda.html:30
msgid "Proximos 60 dias"
msgstr "Prximos 60 dias"

#: docs/full_dump_atual.txt:8660 templates/ui/agenda.html:31
msgid "Proximos 90 dias"
msgstr "Prximos 90 dias"

#: docs/full_dump_atual.txt:8664 docs/full_dump_atual.txt:9297
#: docs/full_dump_atual.txt:9969 docs/full_dump_atual.txt:10204
#: docs/full_dump_atual.txt:10297 templates/ui/agenda.html:35
#: templates/ui/messages/message_list.html:41 templates/ui/semesters.html:29
#: templates/ui/tasks.html:45 templates/ui/tasks/task_list.html:37
msgid "Filtrar"
msgstr "Filtrar"

#: docs/full_dump_atual.txt:8665 docs/full_dump_atual.txt:9053
#: docs/full_dump_atual.txt:9300 docs/full_dump_atual.txt:9970
#: docs/full_dump_atual.txt:10207 docs/full_dump_atual.txt:10298
#: templates/ui/agenda.html:36 templates/ui/dashboard.html:15
#: templates/ui/messages/message_list.html:44 templates/ui/semesters.html:30
#: templates/ui/tasks.html:46 templates/ui/tasks/task_list.html:40
msgid "Limpar"
msgstr "Limpar"

#: docs/full_dump_atual.txt:8672 templates/ui/agenda.html:43
msgid "Eventos"
msgstr "Eventos"

#: docs/full_dump_atual.txt:8687 docs/full_dump_atual.txt:9119
#: templates/ui/agenda.html:58 templates/ui/dashboard.html:81
msgid "Nenhum evento nos proximos dias."
msgstr "Nenhum evento nos prximos dias."

#: docs/full_dump_atual.txt:8694 templates/ui/agenda.html:65
msgid "Lembretes ativos"
msgstr "Lembretes ativos"

#: docs/full_dump_atual.txt:8701 templates/ui/agenda.html:72
#, python-format
msgid "%(minutes)s min antes"
msgstr "%(minutes)s min antes"

#: docs/full_dump_atual.txt:8706 templates/ui/agenda.html:77
msgid "Nenhuma regra ativa."
msgstr "Nenhuma regra ativa."

#: docs/full_dump_atual.txt:8726 docs/full_dump_atual.txt:8732
#: templates/ui/assessment/assessment_confirm_delete.html:11
#: templates/ui/assessment/assessment_confirm_delete.html:17
msgid "Excluir avaliacao"
msgstr "Eliminar avaliao"

#: docs/full_dump_atual.txt:8733
#: templates/ui/assessment/assessment_confirm_delete.html:18
msgid "Tem certeza que deseja excluir a avaliacao"
msgstr "Tem a certeza de que pretende eliminar a avaliao"

#: docs/full_dump_atual.txt:8756 docs/full_dump_atual.txt:8766
#: templates/ui/assessment/assessment_form.html:12
#: templates/ui/assessment/assessment_form.html:22
msgid "Editar avaliacao"
msgstr "Editar avaliao"

#: docs/full_dump_atual.txt:8758 docs/full_dump_atual.txt:8769
#: templates/ui/assessment/assessment_form.html:14
#: templates/ui/assessment/assessment_form.html:25
msgid "Nova avaliacao"
msgstr "Nova avaliao"

#: docs/full_dump_atual.txt:8814 templates/ui/auth_base.html:10
msgid "Campus Calm - Acesso"
msgstr "Campus Calm - Acesso"

#: docs/full_dump_atual.txt:8858 docs/full_dump_atual.txt:8864
#: templates/ui/course/course_confirm_delete.html:10
#: templates/ui/course/course_confirm_delete.html:16
msgid "Excluir disciplina"
msgstr "Eliminar unidade curricular"

#: docs/full_dump_atual.txt:8865
#: templates/ui/course/course_confirm_delete.html:17
msgid "Tem certeza que deseja excluir a disciplina"
msgstr "Tem a certeza de que pretende eliminar a unidade curricular"

#: docs/full_dump_atual.txt:8898 templates/ui/course/course_detail.html:22
msgid "Nova Avaliacao"
msgstr "Nova avaliao"

#: docs/full_dump_atual.txt:8904 templates/ui/course/course_detail.html:28
msgid "Cadastre ao menos uma avaliacao para calcular a barra de progresso."
msgstr "Registe pelo menos uma avaliao para calcular a barra de progresso."

#: docs/full_dump_atual.txt:8916 docs/full_dump_atual.txt:9990
#: templates/ui/course/course_detail.html:40 templates/ui/semesters.html:50
msgid "Media atual"
msgstr "Mdia atual"

#: docs/full_dump_atual.txt:8920 docs/full_dump_atual.txt:9992
#: templates/ui/course/course_detail.html:44 templates/ui/semesters.html:52
msgid "Falta para passar"
msgstr "Falta para aprovao"

#: docs/full_dump_atual.txt:8948 templates/ui/course/course_detail.html:72
msgid "Avaliacao"
msgstr "Avaliao"

#: docs/full_dump_atual.txt:8949 templates/ui/course/course_detail.html:73
msgid "Nota"
msgstr "Classificao"

#: docs/full_dump_atual.txt:8972 templates/ui/course/course_detail.html:96
msgid "Nenhuma avaliacao cadastrada."
msgstr "Nenhuma avaliao registada."

#: docs/full_dump_atual.txt:8990 docs/full_dump_atual.txt:9000
#: templates/ui/course/course_form.html:11
#: templates/ui/course/course_form.html:21
msgid "Editar disciplina"
msgstr "Editar unidade curricular"

#: docs/full_dump_atual.txt:8992 docs/full_dump_atual.txt:9003
#: templates/ui/course/course_form.html:13
#: templates/ui/course/course_form.html:24
msgid "Nova disciplina"
msgstr "Nova unidade curricular"

#: docs/full_dump_atual.txt:9043 templates/ui/dashboard.html:5
msgid "Sem dados"
msgstr "Sem dados"

#: docs/full_dump_atual.txt:9047 templates/ui/dashboard.html:9
msgid "Resumo da semana"
msgstr "Resumo da semana"

#: docs/full_dump_atual.txt:9050 templates/ui/dashboard.html:12
msgid "Buscar tarefa ou evento"
msgstr "Procurar tarefa ou evento"

#: docs/full_dump_atual.txt:9052 templates/ui/dashboard.html:14
msgid "Aplicar"
msgstr "Aplicar"

#: docs/full_dump_atual.txt:9059 templates/ui/dashboard.html:21
msgid "Onboarding incompleto"
msgstr "Onboarding incompleto"

#: docs/full_dump_atual.txt:9060 templates/ui/dashboard.html:22
msgid "Finalize as etapas pendentes para liberar todo o painel."
msgstr "Finalize as etapas pendentes para desbloquear todo o painel."

#: docs/full_dump_atual.txt:9061 docs/full_dump_atual.txt:9186
#: templates/ui/dashboard.html:23 templates/ui/dashboard.html:148
msgid "Continuar configuracao"
msgstr "Continuar configurao"

#: docs/full_dump_atual.txt:9069 templates/ui/dashboard.html:31
msgid "Humor da semana"
msgstr "Humor da semana"

#: docs/full_dump_atual.txt:9071 templates/ui/dashboard.html:33
#, python-format
msgid "%(total)s registros"
msgstr "%(total)s registos"

#: docs/full_dump_atual.txt:9078 templates/ui/dashboard.html:40
msgid "Minutos de foco"
msgstr "Minutos de foco"

#: docs/full_dump_atual.txt:9080 templates/ui/dashboard.html:42
msgid "ultimos 7 dias"
msgstr "ltimos 7 dias"

#: docs/full_dump_atual.txt:9087 templates/ui/dashboard.html:49
msgid "Estresse da semana"
msgstr "Stress da semana"

#: docs/full_dump_atual.txt:9089 templates/ui/dashboard.html:51
msgid "media dos check-ins"
msgstr "mdia dos check-ins"

#: docs/full_dump_atual.txt:9096 templates/ui/dashboard.html:58
msgid "Proximos prazos"
msgstr "Prximos prazos"

#: docs/full_dump_atual.txt:9098 templates/ui/dashboard.html:60
msgid "tarefas e eventos"
msgstr "tarefas e eventos"

#: docs/full_dump_atual.txt:9107 templates/ui/dashboard.html:69
msgid "Proximos eventos"
msgstr "Prximos eventos"

#: docs/full_dump_atual.txt:9126 templates/ui/dashboard.html:88
msgid "Prximas tarefas"
msgstr "Prximas tarefas"

#: docs/full_dump_atual.txt:9138 templates/ui/dashboard.html:100
msgid "Nenhuma tarefa proxima."
msgstr "Nenhuma tarefa prxima."

#: docs/full_dump_atual.txt:9146 templates/ui/dashboard.html:108
msgid "Progresso por disciplina"
msgstr "Progresso por disciplina"

#: docs/full_dump_atual.txt:9156 templates/ui/dashboard.html:118
#, python-format
msgid "Media atual: %(current)s | Media minima: %(passing)s"
msgstr "Mdia atual: %(current)s | Mdia mnima: %(passing)s"

#: docs/full_dump_atual.txt:9164 docs/full_dump_atual.txt:9816
#: docs/full_dump_atual.txt:10025 templates/ui/dashboard.html:126
#: templates/ui/semester/semester_detail.html:79 templates/ui/semesters.html:85
msgid "Nenhuma disciplina cadastrada."
msgstr "Nenhuma disciplina registada."

#: docs/full_dump_atual.txt:9170 templates/ui/dashboard.html:132
msgid "Status do Onboarding"
msgstr "Estado do Onboarding"

#: docs/full_dump_atual.txt:9177 templates/ui/dashboard.html:139
msgid "Pendente"
msgstr "Pendente"

#: docs/full_dump_atual.txt:9179 templates/ui/dashboard.html:141
msgid "Ok"
msgstr "Ok"

#: docs/full_dump_atual.txt:9202 templates/ui/login.html:8
msgid "Bem-estar e organizacao para universitarios"
msgstr "Bem-estar e organizao para universitrios"

#: docs/full_dump_atual.txt:9205 templates/ui/login.html:11
msgid "Acesso ao painel"
msgstr "Acesso ao painel"

#: docs/full_dump_atual.txt:9206 templates/ui/login.html:12
msgid "Entre com seu email institucional ou pessoal para continuar."
msgstr "Entre com o seu email institucional ou pessoal para continuar."

#: docs/full_dump_atual.txt:9210 templates/ui/login.html:16
msgid "Email ou senha invalidos. Tente novamente."
msgstr "Email ou palavra-passe invlidos. Tente novamente."

#: docs/full_dump_atual.txt:9224 templates/ui/login.html:30
msgid "Mostrar"
msgstr "Mostrar"

#: docs/full_dump_atual.txt:9224 templates/ui/login.html:30
msgid "Ocultar"
msgstr "Ocultar"

#: docs/full_dump_atual.txt:9227 templates/ui/login.html:33
msgid "Entrar"
msgstr "Entrar"

#: docs/full_dump_atual.txt:9231 templates/ui/login.html:37
msgid "Esqueci minha senha"
msgstr "Esqueci a minha palavra-passe"

#: docs/full_dump_atual.txt:9235 templates/ui/login.html:46
msgid "Dica: use o mesmo login do sistema administrativo se ja tiver acesso."
msgstr "Dica: use o mesmo login do sistema administrativo se j tiver acesso."

#: docs/full_dump_atual.txt:9271 templates/ui/messages/message_list.html:15
msgid "Historico de notificacoes"
msgstr "Histrico de notificaes"

#: docs/full_dump_atual.txt:9281 docs/full_dump_atual.txt:9955
#: docs/full_dump_atual.txt:10197 docs/full_dump_atual.txt:10281
#: templates/ui/messages/message_list.html:25 templates/ui/semesters.html:15
#: templates/ui/tasks.html:29 templates/ui/tasks/task_list.html:30
msgid "Todos os status"
msgstr "Todos os estados"

#: docs/full_dump_atual.txt:9288 docs/full_dump_atual.txt:9314
#: templates/ui/messages/message_list.html:32
#: templates/ui/messages/message_list.html:59
msgid "Canal"
msgstr "Canal"

#: docs/full_dump_atual.txt:9290 templates/ui/messages/message_list.html:34
msgid "Todos os canais"
msgstr "Todos os canais"

#: docs/full_dump_atual.txt:9316 templates/ui/messages/message_list.html:62
msgid "Agendado"
msgstr "Agendado"

#: docs/full_dump_atual.txt:9335 docs/full_dump_atual.txt:9372
#: templates/ui/messages.html:30 templates/ui/messages/message_list.html:100
msgid "Nenhuma mensagem registrada."
msgstr "Nenhuma mensagem registada."

#: docs/full_dump_atual.txt:9350 templates/ui/messages.html:8
msgid "Avisos e comunicados in-app"
msgstr "Avisos e comunicados na app"

#: docs/full_dump_atual.txt:9387 templates/ui/onboarding.html:8
msgid "Etapas para completar a configuracao"
msgstr "Etapas para completar a configurao"

#: docs/full_dump_atual.txt:9413 templates/ui/onboarding.html:34
msgid "Acoes recomendadas"
msgstr "Aes recomendadas"

#: docs/full_dump_atual.txt:9425 templates/ui/onboarding.html:46
msgid "Sugestoes rapidas"
msgstr "Sugestes rpidas"

#: docs/full_dump_atual.txt:9428 templates/ui/onboarding.html:49
msgid "Ver semestres"
msgstr "Ver semestres"

#: docs/full_dump_atual.txt:9429 templates/ui/onboarding.html:50
msgid "Ver tarefas"
msgstr "Ver tarefas"

#: docs/full_dump_atual.txt:9430 templates/ui/onboarding.html:51
msgid "Ver agenda"
msgstr "Ver agenda"

#: docs/full_dump_atual.txt:9431 templates/ui/onboarding.html:52
msgid "Cadastrar avaliacao (API)"
msgstr "Registar avaliao (API)"

#: docs/full_dump_atual.txt:9446 templates/ui/password_reset_complete.html:8
msgid "Senha atualizada"
msgstr "Palavra-passe atualizada"

#: docs/full_dump_atual.txt:9449 templates/ui/password_reset_complete.html:11
msgid "Senha redefinida"
msgstr "Palavra-passe redefinida"

#: docs/full_dump_atual.txt:9450 templates/ui/password_reset_complete.html:12
msgid "Sua senha foi atualizada. Voce ja pode acessar o painel."
msgstr "A sua palavra-passe foi atualizada. J pode aceder ao painel."

#: docs/full_dump_atual.txt:9452 templates/ui/password_reset_complete.html:14
msgid "Ir para o login"
msgstr "Ir para o login"

#: docs/full_dump_atual.txt:9467 docs/full_dump_atual.txt:9474
#: templates/ui/password_reset_confirm.html:8
#: templates/ui/password_reset_confirm.html:15
msgid "Nova senha"
msgstr "Nova palavra-passe"

#: docs/full_dump_atual.txt:9470 templates/ui/password_reset_confirm.html:11
msgid "Definir nova senha"
msgstr "Definir nova palavra-passe"

#: docs/full_dump_atual.txt:9478 templates/ui/password_reset_confirm.html:19
msgid "Confirmar nova senha"
msgstr "Confirmar nova palavra-passe"

#: docs/full_dump_atual.txt:9481 templates/ui/password_reset_confirm.html:22
msgid "Atualizar senha"
msgstr "Atualizar palavra-passe"

#: docs/full_dump_atual.txt:9496 templates/ui/password_reset_done.html:8
msgid "Email enviado"
msgstr "Email enviado"

#: docs/full_dump_atual.txt:9499 templates/ui/password_reset_done.html:11
msgid "Verifique sua caixa de entrada"
msgstr "Verifique a sua caixa de entrada"

#: docs/full_dump_atual.txt:9500 templates/ui/password_reset_done.html:12
msgid ""
"Se o email existir no sistema, voce recebera um link para redefinir a senha."
msgstr ""
"Se o email existir no sistema, ir receber um link para redefinir a palavra-"
"passe."

#: docs/full_dump_atual.txt:9502 docs/full_dump_atual.txt:9533
#: templates/ui/password_reset_done.html:14
#: templates/ui/password_reset_form.html:24
msgid "Voltar ao login"
msgstr "Voltar ao login"

#: docs/full_dump_atual.txt:9517 templates/ui/password_reset_form.html:8
msgid "Recuperacao de acesso"
msgstr "Recuperao de acesso"

#: docs/full_dump_atual.txt:9520 templates/ui/password_reset_form.html:11
msgid "Redefinir senha"
msgstr "Redefinir palavra-passe"

#: docs/full_dump_atual.txt:9521 templates/ui/password_reset_form.html:12
msgid "Informe seu email para receber o link de redefinicao."
msgstr "Informe o seu email para receber o link de redefinio."

#: docs/full_dump_atual.txt:9527 templates/ui/password_reset_form.html:18
msgid "seu.email@universidade.edu"
msgstr "o.seu.email@universidade.edu"

#: docs/full_dump_atual.txt:9529 templates/ui/password_reset_form.html:20
msgid "Enviar link"
msgstr "Enviar link"

#: docs/full_dump_atual.txt:9549 docs/full_dump_atual.txt:9555
#: templates/ui/reminders/reminder_confirm_delete.html:9
#: templates/ui/reminders/reminder_confirm_delete.html:15
msgid "Excluir lembrete"
msgstr "Eliminar lembrete"

#: docs/full_dump_atual.txt:9556
#: templates/ui/reminders/reminder_confirm_delete.html:16
msgid "Tem certeza que deseja excluir a regra de lembrete"
msgstr "Tem a certeza de que pretende eliminar a regra de lembrete"

#: docs/full_dump_atual.txt:9577 docs/full_dump_atual.txt:9587
#: templates/ui/reminders/reminder_form.html:10
#: templates/ui/reminders/reminder_form.html:20
msgid "Editar lembrete"
msgstr "Editar lembrete"

#: docs/full_dump_atual.txt:9579 docs/full_dump_atual.txt:9590
#: docs/full_dump_atual.txt:9657 templates/ui/reminders/reminder_form.html:12
#: templates/ui/reminders/reminder_form.html:23
#: templates/ui/reminders/reminder_list.html:23
msgid "Novo lembrete"
msgstr "Novo lembrete"

#: docs/full_dump_atual.txt:9588 templates/ui/reminders/reminder_form.html:21
msgid "Atualize sua regra de lembrete."
msgstr "Atualize a sua regra de lembrete."

#: docs/full_dump_atual.txt:9591 templates/ui/reminders/reminder_form.html:24
msgid "Crie uma nova regra de lembrete."
msgstr "Crie uma nova regra de lembrete."

#: docs/full_dump_atual.txt:9655 templates/ui/reminders/reminder_list.html:15
msgid "Configure suas regras de lembrete."
msgstr "Configure as suas regras de lembrete."

#: docs/full_dump_atual.txt:9690 templates/ui/reminders/reminder_list.html:57
msgid "Inativo"
msgstr "Inativo"

#: docs/full_dump_atual.txt:9703 templates/ui/reminders/reminder_list.html:70
msgid "Nenhuma regra de lembrete cadastrada."
msgstr "Nenhuma regra de lembrete registada."

#: docs/full_dump_atual.txt:9719 docs/full_dump_atual.txt:9725
#: templates/ui/semester/semester_confirm_delete.html:9
#: templates/ui/semester/semester_confirm_delete.html:15
msgid "Excluir semestre"
msgstr "Eliminar semestre"

#: docs/full_dump_atual.txt:9726
#: templates/ui/semester/semester_confirm_delete.html:16
msgid "Tem certeza que deseja excluir o semestre"
msgstr "Tem a certeza de que pretende eliminar o semestre"

#: docs/full_dump_atual.txt:9754 templates/ui/semester/semester_detail.html:17
msgid "Periodo"
msgstr "Perodo"

#: docs/full_dump_atual.txt:9760 templates/ui/semester/semester_detail.html:23
msgid "Nova Disciplina"
msgstr "Nova unidade curricular"

#: docs/full_dump_atual.txt:9776 docs/full_dump_atual.txt:9910
#: templates/ui/semester/semester_detail.html:39
#: templates/ui/semester/semester_list.html:29
msgid "Termino"
msgstr "Fim"

#: docs/full_dump_atual.txt:9793 docs/full_dump_atual.txt:9987
#: templates/ui/semester/semester_detail.html:56 templates/ui/semesters.html:47
msgid "Disciplina"
msgstr "Unidade curricular"

#: docs/full_dump_atual.txt:9806 docs/full_dump_atual.txt:9923
#: docs/full_dump_atual.txt:10235 templates/ui/semester/semester_detail.html:69
#: templates/ui/semester/semester_list.html:42
#: templates/ui/tasks/task_list.html:68
msgid "Ver"
msgstr "Ver"

#: docs/full_dump_atual.txt:9833 docs/full_dump_atual.txt:9843
#: templates/ui/semester/semester_form.html:10
#: templates/ui/semester/semester_form.html:20
msgid "Editar semestre"
msgstr "Editar semestre"

#: docs/full_dump_atual.txt:9835 docs/full_dump_atual.txt:9846
#: templates/ui/semester/semester_form.html:12
#: templates/ui/semester/semester_form.html:23
msgid "Novo semestre"
msgstr "Novo semestre"

#: docs/full_dump_atual.txt:9847 templates/ui/semester/semester_form.html:24
msgid "Cadastre um novo semestre."
msgstr "Crie um novo semestre."

#: docs/full_dump_atual.txt:9896 templates/ui/semester/semester_list.html:15
msgid "Gerencie seus semestres e disciplinas."
msgstr "Gerir os seus semestres e unidades curriculares."

#: docs/full_dump_atual.txt:9898 templates/ui/semester/semester_list.html:17
msgid "Novo Semestre"
msgstr "Novo semestre"

#: docs/full_dump_atual.txt:9933 docs/full_dump_atual.txt:10031
#: templates/ui/semester/semester_list.html:52 templates/ui/semesters.html:91
msgid "Nenhum semestre cadastrado."
msgstr "Nenhum semestre registado."

#: docs/full_dump_atual.txt:9948 templates/ui/semesters.html:8
msgid "Resumo das disciplinas e progresso"
msgstr "Resumo das disciplinas e progresso"

#: docs/full_dump_atual.txt:9957 templates/ui/semesters.html:17
msgid "Finalizado"
msgstr "Concludo"

#: docs/full_dump_atual.txt:9961 templates/ui/semesters.html:21
#, fuzzy
#| msgid "Progresso por disciplina"
msgid "Filtrar por disciplina"
msgstr "Progresso por disciplina"

#: docs/full_dump_atual.txt:9965 templates/ui/semesters.html:25
msgid "Filtrar por professor"
msgstr ""

#: docs/full_dump_atual.txt:9991 templates/ui/semesters.html:51
msgid "Progresso"
msgstr "Progresso"

#: docs/full_dump_atual.txt:10002 templates/ui/semesters.html:62
msgid "Aprovado"
msgstr "Aprovado"

#: docs/full_dump_atual.txt:10004 templates/ui/semesters.html:64
msgid "Reprovado"
msgstr "Reprovado"

#: docs/full_dump_atual.txt:10006 docs/full_dump_atual.txt:10199
#: docs/full_dump_atual.txt:10283 docs/full_dump_atual.txt:10328
#: templates/ui/semesters.html:66 templates/ui/tasks.html:31
#: templates/ui/tasks.html:76 templates/ui/tasks/task_list.html:32
msgid "Em andamento"
msgstr "Em curso"

#: docs/full_dump_atual.txt:10045 docs/full_dump_atual.txt:10051
#: templates/ui/tasks/task_confirm_delete.html:9
#: templates/ui/tasks/task_confirm_delete.html:15
msgid "Excluir tarefa"
msgstr "Eliminar tarefa"

#: docs/full_dump_atual.txt:10052
#: templates/ui/tasks/task_confirm_delete.html:16
msgid "Tem certeza que deseja excluir a tarefa"
msgstr "Tem a certeza de que pretende eliminar a tarefa"

#: docs/full_dump_atual.txt:10079 docs/full_dump_atual.txt:10221
#: docs/full_dump_atual.txt:10310 templates/ui/tasks.html:58
#: templates/ui/tasks/task_detail.html:16 templates/ui/tasks/task_list.html:54
msgid "Entrega"
msgstr "Data de entrega"

#: docs/full_dump_atual.txt:10096 templates/ui/tasks/task_detail.html:33
msgid "Nivel de estresse"
msgstr "Nvel de stress"

#: docs/full_dump_atual.txt:10119 docs/full_dump_atual.txt:10129
#: templates/ui/tasks/task_form.html:10 templates/ui/tasks/task_form.html:20
msgid "Editar tarefa"
msgstr "Editar tarefa"

#: docs/full_dump_atual.txt:10121 docs/full_dump_atual.txt:10132
#: docs/full_dump_atual.txt:10184 templates/ui/tasks/task_form.html:12
#: templates/ui/tasks/task_form.html:23 templates/ui/tasks/task_list.html:17
msgid "Nova tarefa"
msgstr "Nova tarefa"

#: docs/full_dump_atual.txt:10133 templates/ui/tasks/task_form.html:24
msgid "Cadastre uma nova tarefa."
msgstr "Crie uma nova tarefa."

#: docs/full_dump_atual.txt:10182 templates/ui/tasks/task_list.html:15
msgid "Organize suas tarefas e prazos."
msgstr "Organize as suas tarefas e prazos."

#: docs/full_dump_atual.txt:10191 templates/ui/tasks/task_list.html:24
msgid "Buscar"
msgstr "Pesquisar"

#: docs/full_dump_atual.txt:10192 docs/full_dump_atual.txt:10266
#: templates/ui/tasks.html:14 templates/ui/tasks/task_list.html:25
msgid "Buscar tarefa"
msgstr "Pesquisar tarefa"

#: docs/full_dump_atual.txt:10198 docs/full_dump_atual.txt:10282
#: docs/full_dump_atual.txt:10330 templates/ui/tasks.html:30
#: templates/ui/tasks.html:78 templates/ui/tasks/task_list.html:31
msgid "A fazer"
msgstr "Por fazer"

#: docs/full_dump_atual.txt:10200 docs/full_dump_atual.txt:10284
#: docs/full_dump_atual.txt:10326 templates/ui/tasks.html:32
#: templates/ui/tasks.html:74 templates/ui/tasks/task_list.html:33
msgid "Concluida"
msgstr "Concluda"

#: docs/full_dump_atual.txt:10220 templates/ui/tasks/task_list.html:53
#: utils/constants.py:61
msgid "Tarefa"
msgstr "Tarefa"

#: docs/full_dump_atual.txt:10223 templates/ui/tasks/task_list.html:56
msgid "Estresse"
msgstr "Stress"

#: docs/full_dump_atual.txt:10245 docs/full_dump_atual.txt:10339
#: templates/ui/tasks.html:87 templates/ui/tasks/task_list.html:78
msgid "Nenhuma tarefa cadastrada."
msgstr "Nenhuma tarefa registada."

#: docs/full_dump_atual.txt:10260 templates/ui/tasks.html:8
msgid "Lista de tarefas academicas"
msgstr "Lista de tarefas acadmicas"

#: docs/full_dump_atual.txt:10271 docs/full_dump_atual.txt:10311
#: templates/ui/tasks.html:19 templates/ui/tasks.html:59
msgid "Stress"
msgstr "Stress"

#: docs/full_dump_atual.txt:10289 templates/ui/tasks.html:37
msgid "Todas as datas"
msgstr "Todas as datas"

#: docs/full_dump_atual.txt:10290 templates/ui/tasks.html:38
msgid "Atrasadas"
msgstr "Atrasadas"

#: docs/full_dump_atual.txt:10291 templates/ui/tasks.html:39
msgid "Hoje"
msgstr "Hoje"

#: docs/full_dump_atual.txt:10292 templates/ui/tasks.html:40
msgid "Proxima semana"
msgstr "Prxima semana"

#: docs/full_dump_atual.txt:10293 templates/ui/tasks.html:41
msgid "Proximo mes"
msgstr "Prximo ms"

#: templates/ui/first_access.html:9
msgid "Primeiro acesso"
msgstr ""

#: templates/ui/first_access.html:12 templates/ui/first_access.html:66
#, fuzzy
#| msgid "Criar"
msgid "Criar conta"
msgstr "Criar"

#: templates/ui/first_access.html:13
msgid "Preencha seus dados para iniciar no Campus Calm."
msgstr ""

#: templates/ui/first_access.html:18
msgid "Revise os campos abaixo."
msgstr ""

#: templates/ui/first_access.html:71
#, fuzzy
#| msgid "Voltar ao login"
msgid "Voltar para login"
msgstr "Voltar ao login"

#: templates/ui/login.html:42
msgid "Primeiro acesso / Criar conta"
msgstr ""

#: templates/ui/messages/message_list.html:61
msgid "Acao"
msgstr ""

#: templates/ui/messages/message_list.html:63
#, fuzzy
#| msgid "Email enviado"
msgid "Enviado"
msgstr "Email enviado"

#: templates/ui/messages/message_list.html:64
msgid "Tentativas"
msgstr ""

#: templates/ui/messages/message_list.html:65
msgid "Erro"
msgstr ""

#: templates/ui/reminders/reminder_list.html:21
#, fuzzy
#| msgid "Editar lembrete"
msgid "Gerar lembretes"
msgstr "Editar lembrete"

#: utils/constants.py:34
msgid "Todo"
msgstr "Por fazer"

#: utils/constants.py:35
msgid "Doing"
msgstr "Em curso"

#: utils/constants.py:36
msgid "Done"
msgstr "Concluda"

#: utils/gating.py:15
msgid "Complete seu perfil para continuar."
msgstr ""

#: utils/gating.py:16
#, fuzzy
#| msgid "Nenhum semestre cadastrado."
msgid "Crie um semestre ativo."
msgstr "Nenhum semestre registado."

#: utils/gating.py:17
msgid "Cadastre ao menos uma disciplina."
msgstr ""

#: utils/gating.py:18
#, fuzzy
#| msgid "Cadastrar avaliacao (API)"
msgid "Cadastre ao menos uma avaliacao."
msgstr "Registar avaliao (API)"

#: utils/gating.py:19
msgid "Configure pelo menos uma regra de lembrete."
msgstr ""

#: utils/gating.py:20
msgid "Tudo pronto para seu dashboard."
msgstr ""

### scripts/i18n_refresh.sh
--------------------------------------------------------------------------------
#!/usr/bin/env bash
set -euo pipefail

if ! command -v msguniq >/dev/null 2>&1 || ! command -v msgfmt >/dev/null 2>&1; then
  echo "GNU gettext tools (msguniq/msgfmt) not found. Install gettext and re-run."
  exit 1
fi

python3 manage.py makemessages -l en -l pt_BR -l pt_PT
python3 manage.py compilemessages

### scripts/run_curl_demo.sh
--------------------------------------------------------------------------------
#!/usr/bin/env bash
set -euo pipefail

API_HOST="${API_HOST:-http://localhost:8000}"
EMAIL="${API_EMAIL:-nari.naluu@gmail.com}"
PASSWORD="${API_PASSWORD:-Pucca&garu@20}"

login_response=$(curl -s -X POST "${API_HOST}/api/auth/login/" \
  -H "Content-Type: application/json" \
  -d "{\"email\":\"${EMAIL}\",\"password\":\"${PASSWORD}\"}")

access=$(printf '%s' "$login_response" | python3 - <<'PY'
import json, sys
try:
    data = json.load(sys.stdin)
    print(data.get("access", ""))
except Exception:
    print("", end="")
PY
)

if [ -z "$access" ]; then
  echo "Falha no login. Resposta:" >&2
  echo "$login_response" >&2
  exit 1
fi

bearer="Authorization: Bearer $access"

echo "== /api/auth/me/"
curl -s -H "$bearer" "${API_HOST}/api/auth/me/" | python3 -m json.tool

echo "== /api/mood/entries/"
curl -s -H "$bearer" "${API_HOST}/api/mood/entries/" | python3 -m json.tool

echo "== /api/planner/tasks/"
curl -s -H "$bearer" "${API_HOST}/api/planner/tasks/" | python3 -m json.tool

echo "== /api/agenda/week/"
curl -s -H "$bearer" "${API_HOST}/api/agenda/week/" | python3 -m json.tool

echo "== /api/semester/courses/"
course_list=$(curl -s -H "$bearer" "${API_HOST}/api/semester/courses/")
course_id=$(printf '%s' "$course_list" | python3 - <<'PY'
import json, sys
try:
    data = json.load(sys.stdin)
    if data:
        print(data[0].get("id", ""))
except Exception:
    print("")
PY
)

echo "$course_list" | python3 -m json.tool

if [ -n "$course_id" ]; then
  echo "== /api/semester/courses/${course_id}/progress/"
  curl -s -H "$bearer" "${API_HOST}/api/semester/courses/${course_id}/progress/" | python3 -m json.tool
fi

echo "== /api/content/guided/"
curl -s -H "$bearer" "${API_HOST}/api/content/guided/" | python3 -m json.tool

echo "== /api/onboarding/status/"
curl -s -H "$bearer" "${API_HOST}/api/onboarding/status/" | python3 -m json.tool

echo "== /api/analytics/dashboard/"
curl -s -H "$bearer" "${API_HOST}/api/analytics/dashboard/" | python3 -m json.tool

### static/css/app.css
--------------------------------------------------------------------------------
:root {
  --sidebar-width: 220px;
  --sidebar-bg: #ffffff;
  --primary-soft: #e8f0fb;
  --brand: #1d4ed8;
}

body {
  font-family: "Sora", system-ui, sans-serif;
}

.sidebar {
  width: var(--sidebar-width);
  min-height: 100vh;
  position: fixed;
  left: 0;
  top: 0;
  padding-top: 0;
  box-shadow: 0 0 12px rgba(15, 23, 42, 0.04);
}

.content {
  margin-left: var(--sidebar-width);
  min-height: 100vh;
}

.nav-link {
  color: #334155;
  padding: 0.5rem 0.75rem;
  margin-bottom: 4px;
}

.nav-link:hover {
  background: var(--primary-soft);
  border-radius: 6px;
}

.nav-link.active {
  background: #dbe7f8;
  border-radius: 6px;
  font-weight: 600;
}

.sidebar-panel-title {
  display: block;
  width: 100%;
  padding: 0.35rem 0.75rem;
  border-radius: 8px;
  background: #effaf2;
  color: #2f6f45;
  font-weight: 700;
  font-size: 0.9rem;
  line-height: 1.1;
  text-align: center;
  box-sizing: border-box;
}

.card {
  border-radius: 10px;
  border: 1px solid #e2e8f0;
}

.card-soft-blue {
  background-color: #edf4ff !important;
  border-color: #dce9ff !important;
}

.card-soft-green {
  background-color: #eef8f2 !important;
  border-color: #d8eee2 !important;
}

.card-soft-amber {
  background-color: #fff5ec !important;
  border-color: #f7e6d6 !important;
}

.card-soft-purple {
  background-color: #f3f0ff !important;
  border-color: #e5defa !important;
}

.bg-auth {
  min-height: 100vh;
  background: radial-gradient(circle at top left, #e2e8f0, #f8fafc 60%);
  position: relative;
  overflow: hidden;
}

.auth-shell {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  position: relative;
  z-index: 1;
}

.auth-language-switcher {
  z-index: 2;
}

.auth-card {
  background: #ffffff;
  border-radius: 16px;
  width: min(420px, 100%);
  overflow: hidden;
  border: 1px solid #e2e8f0;
}

.auth-header {
  padding: 28px 28px 16px;
  background: linear-gradient(135deg, #1d4ed8, #3b82f6);
  color: #fff;
}

.auth-logo {
  font-weight: 700;
  font-size: 1.25rem;
  letter-spacing: 0.2px;
}

.auth-subtitle {
  font-size: 0.85rem;
  opacity: 0.9;
}

.brand-logo {
  width: 44px;
  height: 44px;
  object-fit: contain;
}

.brand-logo-large {
  width: 180px;
  height: 180px;
  object-fit: contain;
  margin-bottom: -32px;
}

.auth-logo-img {
  width: 56px;
  height: 56px;
  object-fit: contain;
  margin-bottom: 8px;
}

.auth-body {
  padding: 24px 28px 28px;
}

.bg-auth::before,
.bg-auth::after {
  content: "";
  position: absolute;
  width: 320px;
  height: 320px;
  border-radius: 50%;
  background: radial-gradient(circle at 30% 30%, rgba(59, 130, 246, 0.25), transparent 60%);
  filter: blur(2px);
}

.bg-auth::before {
  top: -80px;
  right: -120px;
}

.bg-auth::after {
  bottom: -100px;
  left: -120px;
}

### templates/base.html
--------------------------------------------------------------------------------
{% load i18n static %}
{% get_current_language as CURRENT_LANGUAGE %}
{% get_available_languages as AVAILABLE_LANGUAGES %}
{% get_language_info_list for AVAILABLE_LANGUAGES as languages %}
<!DOCTYPE html>
<html lang="{{ CURRENT_LANGUAGE }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Campus Calm</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{% static 'css/app.css' %}" rel="stylesheet">
</head>
<body class="bg-light">
  <div class="d-flex">
    <nav class="sidebar bg-white border-end">
      <div class="p-3">
        <div class="text-center mb-2">
          <img src="/media/Logo%20Campus%20Calm.png" alt="Campus Calm" class="brand-logo-large">
          <div class="sidebar-panel-title text-muted small">{% trans "Painel do aluno" %}</div>
        </div>
        <div class="mt-3 small text-muted">
          {% blocktrans with name=request.user.name|default:request.user.email %}Ol, {{ name }}{% endblocktrans %}
        </div>
        <form class="mt-3" method="post" action="{% url 'set_language' %}">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.get_full_path }}">
          <label class="form-label small text-muted mb-1" for="language-select">{% trans "Idioma" %}</label>
          {% with current_lang=CURRENT_LANGUAGE|cut:"-"|cut:"_" %}
            <select id="language-select" class="form-select form-select-sm" name="language" onchange="this.form.submit()">
              {% for language in languages %}
                {% with code=language.code|cut:"-"|cut:"_"|lower %}
                  <option value="{{ language.code }}"{% if language.code|cut:"-"|cut:"_" == current_lang %} selected{% endif %}>
                    {% if code == "ptbr" %}{% elif code == "ptpt" %}{% elif code == "en" %}{% else %}{% endif %}
                    {{ language.name_local }}
                  </option>
                {% endwith %}
              {% endfor %}
            </select>
          {% endwith %}
        </form>
        <ul class="nav flex-column mt-4">
          <li class="nav-item">
            <a class="nav-link {% if request.path == '/' %}active{% endif %}" href="/">{% trans "Dashboard" %}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":11" == "/onboarding" %}active{% endif %}" href="/onboarding/">{% trans "Onboarding" %}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":10" == "/semestres" %}active{% endif %}" href="/semestres/">{% trans "Semestres" %}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":8" == "/tarefas" %}active{% endif %}" href="/tarefas/">{% trans "Tarefas" %}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":7" == "/agenda" %}active{% endif %}" href="/agenda/">{% trans "Agenda" %}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":11" == "/lembretes" %}active{% endif %}" href="/lembretes/">{% trans "Lembretes" %}</a>
          </li>
          <li class="nav-item">
            <a class="nav-link {% if request.path|slice:":10" == "/mensagens" %}active{% endif %}" href="/mensagens/">{% trans "Mensagens" %}</a>
          </li>
        </ul>
        <div class="mt-4 pt-3 border-top">
          <form method="post" action="/logout/">
            {% csrf_token %}
            <button class="nav-link text-danger btn btn-link p-0" type="submit">{% trans "Sair" %}</button>
          </form>
        </div>
      </div>
    </nav>

    <main class="content flex-grow-1">
      <div class="container-fluid py-4">
        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-{{ message.tags|default:"info" }} alert-dismissible fade show" role="alert">
              {{ message }}
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="{% trans "Fechar" %}"></button>
            </div>
          {% endfor %}
        {% endif %}
        {% block content %}{% endblock %}
      </div>
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>

### templates/registration/password_reset_email.html
--------------------------------------------------------------------------------
{% autoescape off %}
Voce solicitou a redefinicao de senha do Campus Calm.

Para criar uma nova senha, acesse o link abaixo:
{{ protocol }}://{{ domain }}{% url 'password_reset_confirm' uidb64=uid token=token %}

Se voce nao solicitou, ignore esta mensagem.
{% endautoescape %}

### templates/registration/password_reset_subject.txt
--------------------------------------------------------------------------------
Campus Calm - Redefinicao de senha

### templates/ui/agenda/agenda_confirm_delete.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-agenda-list' %}">{% trans "Agenda" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Excluir evento" %}</li>
  </ol>
</nav>

<div class="card shadow-sm">
  <div class="card-body">
    <h1 class="h5 mb-3">{% trans "Excluir evento" %}</h1>
    <p class="text-muted">{% trans "Tem certeza que deseja excluir o evento" %} <strong>{{ event.title }}</strong>?</p>
    <form method="post">
      {% csrf_token %}
      <a class="btn btn-outline-secondary" href="{% url 'ui-agenda-list' %}">{% trans "Cancelar" %}</a>
      <button class="btn btn-danger" type="submit">{% trans "Excluir" %}</button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/agenda/agenda_form.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-agenda-list' %}">{% trans "Agenda" %}</a></li>
    {% if mode == "edit" %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Editar evento" %}</li>
    {% else %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Novo evento" %}</li>
    {% endif %}
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    {% if mode == "edit" %}
      <h1 class="h4 mb-1">{% trans "Editar evento" %}</h1>
      <div class="text-muted">{{ event.title }}</div>
    {% else %}
      <h1 class="h4 mb-1">{% trans "Novo evento" %}</h1>
      <div class="text-muted">{% trans "Cadastre um novo evento." %}</div>
    {% endif %}
  </div>
  <a class="btn btn-outline-secondary" href="{% url 'ui-agenda-list' %}">{% trans "Voltar" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
      {% endif %}
      {% for field in form %}
        <div class="mb-3">
          <label class="form-label">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <div class="form-text">{{ field.help_text }}</div>
          {% endif %}
          {% for error in field.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>
      {% endfor %}
      <button class="btn btn-primary" type="submit">
        {% if mode == "edit" %}{% trans "Salvar" %}{% else %}{% trans "Criar" %}{% endif %}
      </button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/agenda/agenda_list.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Agenda" %}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Agenda" %}</h1>
    <div class="text-muted">{% trans "Seus eventos e compromissos." %}</div>
  </div>
  <a class="btn btn-primary" href="{% url 'ui-agenda-create' %}">{% trans "Novo evento" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    {% if events %}
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>{% trans "Evento" %}</th>
              <th>{% trans "Tipo" %}</th>
              <th>{% trans "Inicio" %}</th>
              <th>{% trans "Fim" %}</th>
              <th class="text-end">{% trans "Acoes" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for event in events %}
              <tr>
                <td>{{ event.title }}</td>
                <td><span class="badge text-bg-light">{{ event.get_event_type_display }}</span></td>
                <td>{{ event.start_at|date:"d/m/Y H:i" }}</td>
                <td>{{ event.end_at|date:"d/m/Y H:i"|default:"-" }}</td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-secondary" href="{% url 'ui-agenda-edit' event.pk %}">{% trans "Editar" %}</a>
                  <a class="btn btn-sm btn-outline-danger" href="{% url 'ui-agenda-delete' event.pk %}">{% trans "Excluir" %}</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhum evento cadastrado." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/agenda.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Agenda" %}</h1>
    <div class="text-muted">{% blocktrans with days=range_days %}Eventos dos proximos {{ days }} dias{% endblocktrans %}</div>
  </div>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="q" placeholder="{% trans "Buscar evento" %}"
           value="{{ search_query }}">
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="type">
      <option value="">{% trans "Todos os tipos" %}</option>
      {% for value,label in event_type_choices %}
        <option value="{{ value }}" {% if type_filter == value %}selected{% endif %}>{{ label }}</option>
      {% endfor %}
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="range">
      <option value="7" {% if range_days == "7" %}selected{% endif %}>{% trans "Proximos 7 dias" %}</option>
      <option value="15" {% if range_days == "15" %}selected{% endif %}>{% trans "Proximos 15 dias" %}</option>
      <option value="30" {% if range_days == "30" %}selected{% endif %}>{% trans "Proximos 30 dias" %}</option>
      <option value="60" {% if range_days == "60" %}selected{% endif %}>{% trans "Proximos 60 dias" %}</option>
      <option value="90" {% if range_days == "90" %}selected{% endif %}>{% trans "Proximos 90 dias" %}</option>
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-sm btn-outline-secondary" type="submit">{% trans "Filtrar" %}</button>
    <a class="btn btn-sm btn-link" href="/agenda/?clear=1">{% trans "Limpar" %}</a>
  </div>
</form>

<div class="row g-3">
  <div class="col-lg-7">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">{% trans "Eventos" %}</div>
      <div class="card-body">
        {% if events %}
          <ul class="list-group list-group-flush">
            {% for event in events %}
              <li class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                  <div class="fw-semibold">{{ event.title }}</div>
                  <div class="text-muted small">{{ event.event_type }}</div>
                </div>
                <span class="text-muted small">{{ event.start_at|date:"d/m/Y H:i" }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">{% trans "Nenhum evento nos proximos dias." %}</div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-lg-5">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">{% trans "Lembretes ativos" %}</div>
      <div class="card-body">
        {% if reminder_rules %}
          <ul class="list-group list-group-flush">
            {% for rule in reminder_rules %}
              <li class="list-group-item d-flex justify-content-between">
                <span>{{ rule.target_type }}</span>
                <span class="text-muted small">{% blocktrans with minutes=rule.remind_before_minutes %}{{ minutes }} min antes{% endblocktrans %}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">{% trans "Nenhuma regra ativa." %}</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>
{% endblock %}

### templates/ui/assessment/assessment_confirm_delete.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-detail' course.semester.pk %}">{{ course.semester.name }}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-course-detail' course.pk %}">{{ course.title }}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Excluir avaliacao" %}</li>
  </ol>
</nav>

<div class="card shadow-sm">
  <div class="card-body">
    <h1 class="h5 mb-3">{% trans "Excluir avaliacao" %}</h1>
    <p class="text-muted">{% trans "Tem certeza que deseja excluir a avaliacao" %} <strong>{{ assessment.title }}</strong>?</p>
    <form method="post">
      {% csrf_token %}
      <a class="btn btn-outline-secondary" href="{% url 'ui-course-detail' course.pk %}">{% trans "Cancelar" %}</a>
      <button class="btn btn-danger" type="submit">{% trans "Excluir" %}</button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/assessment/assessment_form.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-detail' course.semester.pk %}">{{ course.semester.name }}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-course-detail' course.pk %}">{{ course.title }}</a></li>
    {% if mode == "edit" %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Editar avaliacao" %}</li>
    {% else %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Nova avaliacao" %}</li>
    {% endif %}
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    {% if mode == "edit" %}
      <h1 class="h4 mb-1">{% trans "Editar avaliacao" %}</h1>
      <div class="text-muted">{{ assessment.title }}</div>
    {% else %}
      <h1 class="h4 mb-1">{% trans "Nova avaliacao" %}</h1>
      <div class="text-muted">{{ course.title }}</div>
    {% endif %}
  </div>
  <a class="btn btn-outline-secondary" href="{% url 'ui-course-detail' course.pk %}">{% trans "Voltar" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
      {% endif %}
      {% for field in form %}
        <div class="mb-3">
          <label class="form-label">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <div class="form-text">{{ field.help_text }}</div>
          {% endif %}
          {% for error in field.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>
      {% endfor %}
      <button class="btn btn-primary" type="submit">
        {% if mode == "edit" %}{% trans "Salvar" %}{% else %}{% trans "Criar" %}{% endif %}
      </button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/auth_base.html
--------------------------------------------------------------------------------
{% load i18n static %}
{% get_current_language as CURRENT_LANGUAGE %}
{% get_available_languages as AVAILABLE_LANGUAGES %}
{% get_language_info_list for AVAILABLE_LANGUAGES as languages %}
<!DOCTYPE html>
<html lang="{{ CURRENT_LANGUAGE }}">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% trans "Campus Calm - Acesso" %}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Sora:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="{% static 'css/app.css' %}" rel="stylesheet">
</head>
<body class="bg-auth">
  <div class="position-absolute top-0 end-0 p-3 auth-language-switcher">
    <form method="post" action="{% url 'set_language' %}">
      {% csrf_token %}
      <input type="hidden" name="next" value="{{ request.get_full_path }}">
      <label class="form-label small text-muted mb-1" for="auth-language-select">{% trans "Idioma" %}</label>
      {% with current_lang=CURRENT_LANGUAGE|cut:"-"|cut:"_" %}
        <select id="auth-language-select" class="form-select form-select-sm" name="language" onchange="this.form.submit()">
          {% for language in languages %}
            {% with code=language.code|cut:"-"|cut:"_"|lower %}
              <option value="{{ language.code }}"{% if language.code|cut:"-"|cut:"_" == current_lang %} selected{% endif %}>
                {% if code == "ptbr" %}{% elif code == "ptpt" %}{% elif code == "en" %}{% else %}{% endif %}
                {{ language.name_local }}
              </option>
            {% endwith %}
          {% endfor %}
        </select>
      {% endwith %}
    </form>
  </div>
  <div class="auth-shell">
    {% block content %}{% endblock %}
  </div>
</body>
</html>

### templates/ui/course/course_confirm_delete.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-detail' course.semester.pk %}">{{ course.semester.name }}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Excluir disciplina" %}</li>
  </ol>
</nav>

<div class="card shadow-sm">
  <div class="card-body">
    <h1 class="h5 mb-3">{% trans "Excluir disciplina" %}</h1>
    <p class="text-muted">{% trans "Tem certeza que deseja excluir a disciplina" %} <strong>{{ course.title }}</strong>?</p>
    <form method="post">
      {% csrf_token %}
      <a class="btn btn-outline-secondary" href="{% url 'ui-course-detail' course.pk %}">{% trans "Cancelar" %}</a>
      <button class="btn btn-danger" type="submit">{% trans "Excluir" %}</button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/course/course_detail.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-detail' course.semester.pk %}">{{ course.semester.name }}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ course.title }}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h4 mb-1">{{ course.title }}</h1>
    <div class="text-muted">{{ course.teacher|default:"-" }}</div>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary" href="{% url 'ui-semester-detail' course.semester.pk %}">{% trans "Voltar" %}</a>
    <a class="btn btn-outline-primary" href="{% url 'ui-course-edit' course.pk %}">{% trans "Editar" %}</a>
    <a class="btn btn-primary" href="{% url 'ui-assessment-create' course.pk %}">{% trans "Nova Avaliacao" %}</a>
  </div>
</div>

{% if not progress.has_assessments %}
  <div class="alert alert-warning">
    {% trans "Cadastre ao menos uma avaliacao para calcular a barra de progresso." %}
  </div>
{% endif %}

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <div class="row g-3">
      <div class="col-md-3">
        <div class="text-muted small">{% trans "Nota minima" %}</div>
        <div class="fw-semibold">{{ progress.passing_grade|floatformat:2 }}</div>
      </div>
      <div class="col-md-3">
        <div class="text-muted small">{% trans "Media atual" %}</div>
        <div class="fw-semibold">{{ progress.current_average|floatformat:2 }}</div>
      </div>
      <div class="col-md-3">
        <div class="text-muted small">{% trans "Falta para passar" %}</div>
        <div class="fw-semibold">{{ progress.needed_to_pass|floatformat:2 }}</div>
      </div>
      <div class="col-md-3">
        <div class="text-muted small">{% trans "Status" %}</div>
        <div class="fw-semibold">{{ course.get_status_display }}</div>
      </div>
    </div>
    <div class="mt-3">
      <div class="progress" role="progressbar" aria-valuenow="{{ progress.progress_percent|floatformat:0 }}" aria-valuemin="0" aria-valuemax="100">
        <div class="progress-bar" style="width: {{ progress.progress_percent|floatformat:0 }}%;">
          {{ progress.progress_percent|floatformat:0 }}%
        </div>
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h2 class="h6 mb-0">{% trans "Avaliacoes" %}</h2>
    </div>
    {% if assessments %}
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>{% trans "Avaliacao" %}</th>
              <th>{% trans "Nota" %}</th>
              <th>{% trans "Peso" %}</th>
              <th>{% trans "Data" %}</th>
              <th class="text-end">{% trans "Acoes" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for assessment in assessments %}
              <tr>
                <td>{{ assessment.title }}</td>
                <td>{{ assessment.score|floatformat:2 }} / {{ assessment.max_score|floatformat:2 }}</td>
                <td>{{ assessment.weight|floatformat:2 }}</td>
                <td>{{ assessment.date|date:"d/m/Y"|default:"-" }}</td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-secondary" href="{% url 'ui-assessment-edit' assessment.pk %}">{% trans "Editar" %}</a>
                  <a class="btn btn-sm btn-outline-danger" href="{% url 'ui-assessment-delete' assessment.pk %}">{% trans "Excluir" %}</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhuma avaliacao cadastrada." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/course/course_form.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-detail' semester.pk %}">{{ semester.name }}</a></li>
    {% if mode == "edit" %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Editar disciplina" %}</li>
    {% else %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Nova disciplina" %}</li>
    {% endif %}
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    {% if mode == "edit" %}
      <h1 class="h4 mb-1">{% trans "Editar disciplina" %}</h1>
      <div class="text-muted">{{ course.title }}</div>
    {% else %}
      <h1 class="h4 mb-1">{% trans "Nova disciplina" %}</h1>
      <div class="text-muted">{{ semester.name }}</div>
    {% endif %}
  </div>
  <a class="btn btn-outline-secondary" href="{% url 'ui-semester-detail' semester.pk %}">{% trans "Voltar" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
      {% endif %}
      {% for field in form %}
        <div class="mb-3">
          <label class="form-label">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <div class="form-text">{{ field.help_text }}</div>
          {% endif %}
          {% for error in field.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>
      {% endfor %}
      <button class="btn btn-primary" type="submit">
        {% if mode == "edit" %}{% trans "Salvar" %}{% else %}{% trans "Criar" %}{% endif %}
      </button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/dashboard.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
{% trans "Sem dados" as label_no_data %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h4 mb-1">{% trans "Dashboard" %}</h1>
    <div class="text-muted">{% trans "Resumo da semana" %}</div>
  </div>
  <form class="d-flex" method="get">
    <input class="form-control form-control-sm me-2" type="text" name="q" placeholder="{% trans "Buscar tarefa ou evento" %}"
           value="{{ search_query }}">
    <button class="btn btn-sm btn-outline-secondary" type="submit">{% trans "Aplicar" %}</button>
    <a class="btn btn-sm btn-link ms-2" href="/?clear=1">{% trans "Limpar" %}</a>
  </form>
</div>

{% if not onboarding_status.is_complete %}
<div class="alert alert-warning">
  <div class="fw-semibold">{% trans "Onboarding incompleto" %}</div>
  <div>{% trans "Finalize as etapas pendentes para liberar todo o painel." %}</div>
  <a class="btn btn-sm btn-outline-dark mt-2" href="/onboarding/">{% trans "Continuar configuracao" %}</a>
</div>
{% endif %}

<div class="row g-3">
  <div class="col-md-3">
    <div class="card shadow-sm card-soft-blue">
      <div class="card-body">
        <div class="text-muted small">{% trans "Humor da semana" %}</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.mood_most_common|default:label_no_data }}</div>
        <div class="text-muted small">{% blocktrans with total=dashboard_data.mood_weekly_total %}{{ total }} registros{% endblocktrans %}</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow-sm card-soft-purple">
      <div class="card-body">
        <div class="text-muted small">{% trans "Minutos de foco" %}</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.focus_minutes_week }}</div>
        <div class="text-muted small">{% trans "ultimos 7 dias" %}</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow-sm card-soft-amber">
      <div class="card-body">
        <div class="text-muted small">{% trans "Estresse da semana" %}</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.stress_avg_week|default:label_no_data }}</div>
        <div class="text-muted small">{% trans "media dos check-ins" %}</div>
      </div>
    </div>
  </div>
  <div class="col-md-3">
    <div class="card shadow-sm card-soft-green">
      <div class="card-body">
        <div class="text-muted small">{% trans "Proximos prazos" %}</div>
        <div class="fs-4 fw-bold">{{ dashboard_data.upcoming_count }}</div>
        <div class="text-muted small">{% trans "tarefas e eventos" %}</div>
      </div>
    </div>
  </div>
</div>

<div class="row g-3 mt-3">
  <div class="col-lg-7">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">{% trans "Proximos eventos" %}</div>
      <div class="card-body">
        {% if dashboard_data.upcoming_events %}
          <ul class="list-group list-group-flush">
            {% for event in dashboard_data.upcoming_events %}
              <li class="list-group-item d-flex justify-content-between">
                <span>{{ event.title }}</span>
                <span class="text-muted small">{{ event.start_at|date:"d/m/Y H:i" }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">{% trans "Nenhum evento nos proximos dias." %}</div>
        {% endif %}
      </div>
    </div>
  </div>
  <div class="col-lg-5">
    <div class="card shadow-sm">
      <div class="card-header bg-white fw-semibold">{% trans "Prximas tarefas" %}</div>
      <div class="card-body">
        {% if dashboard_data.upcoming_tasks %}
          <ul class="list-group list-group-flush">
            {% for task in dashboard_data.upcoming_tasks %}
              <li class="list-group-item d-flex justify-content-between">
                <span>{{ task.title }}</span>
                <span class="text-muted small">{{ task.due_date|date:"d/m/Y" }}</span>
              </li>
            {% endfor %}
          </ul>
        {% else %}
          <div class="text-muted">{% trans "Nenhuma tarefa proxima." %}</div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm mt-4">
  <div class="card-header bg-white fw-semibold">{% trans "Progresso por disciplina" %}</div>
  <div class="card-body">
    {% if dashboard_data.course_progress %}
      {% for course in dashboard_data.course_progress %}
        <div class="mb-3">
          <div class="d-flex justify-content-between">
            <div class="fw-semibold">{{ course.title }}</div>
            <div class="text-muted small">{{ course.semester }}</div>
          </div>
          <div class="text-muted small">
            {% blocktrans with current=course.current_average passing=course.passing_grade %}Media atual: {{ current }} | Media minima: {{ passing }}{% endblocktrans %}
          </div>
          <div class="progress mt-2" style="height: 8px;">
            <div class="progress-bar" role="progressbar" style="width: {{ course.progress_percent }}%;"></div>
          </div>
        </div>
      {% endfor %}
    {% else %}
      <div class="text-muted">{% trans "Nenhuma disciplina cadastrada." %}</div>
    {% endif %}
  </div>
</div>

<div class="card shadow-sm mt-4">
  <div class="card-header bg-white fw-semibold">{% trans "Status do Onboarding" %}</div>
  <div class="card-body">
    <ul class="list-group list-group-flush">
      {% for step in onboarding_status.steps %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span>{{ step.label }}</span>
          {% if step.missing %}
            <span class="badge text-bg-warning">{% trans "Pendente" %}</span>
          {% else %}
            <span class="badge text-bg-success">{% trans "Ok" %}</span>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
    {% if not onboarding_status.is_complete %}
      <div class="mt-3">
        <a class="btn btn-primary btn-sm" href="/onboarding/">{% trans "Continuar configuracao" %}</a>
      </div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/first_access.html
--------------------------------------------------------------------------------
{% extends "ui/auth_base.html" %}
{% load i18n %}

{% block content %}
<!-- Bloco: Card de primeiro acesso -->
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">{% trans "Primeiro acesso" %}</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">{% trans "Criar conta" %}</h1>
    <p class="text-muted small mb-4">{% trans "Preencha seus dados para iniciar no Campus Calm." %}</p>

    {% if form.errors %}
      <!-- Bloco: Erros do formulario -->
      <div class="alert alert-danger">
        {% trans "Revise os campos abaixo." %}
      </div>
    {% endif %}

    <!-- Bloco: Formulario -->
    <form method="post" novalidate>
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label">{{ form.name.label }}</label>
        {{ form.name }}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.email.label }}</label>
        {{ form.email }}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.phone.label }}</label>
        {{ form.phone }}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.plan.label }}</label>
        {{ form.plan }}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.password1.label }}</label>
        {{ form.password1 }}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.password2.label }}</label>
        {{ form.password2 }}
      </div>

      <!-- Bloco: Consentimentos -->
      <div class="mb-3">
        <div class="form-check">
          {{ form.allow_email }}
          <label class="form-check-label" for="{{ form.allow_email.id_for_label }}">{{ form.allow_email.label }}</label>
        </div>
        <div class="form-check">
          {{ form.allow_whatsapp }}
          <label class="form-check-label" for="{{ form.allow_whatsapp.id_for_label }}">{{ form.allow_whatsapp.label }}</label>
        </div>
        <div class="form-check">
          {{ form.allow_sms }}
          <label class="form-check-label" for="{{ form.allow_sms.id_for_label }}">{{ form.allow_sms.label }}</label>
        </div>
      </div>

      <button type="submit" class="btn btn-primary w-100">{% trans "Criar conta" %}</button>
    </form>

    <!-- Bloco: Voltar para login -->
    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="{% url 'ui-login' %}">{% trans "Voltar para login" %}</a>
    </div>
  </div>
</div>
{% endblock %}

### templates/ui/login.html
--------------------------------------------------------------------------------
{% extends "ui/auth_base.html" %}
{% load i18n %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">{% trans "Bem-estar e organizacao para universitarios" %}</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">{% trans "Acesso ao painel" %}</h1>
    <p class="text-muted small mb-4">{% trans "Entre com seu email institucional ou pessoal para continuar." %}</p>

    {% if form.errors %}
      <div class="alert alert-danger">
        {% trans "Email ou senha invalidos. Tente novamente." %}
      </div>
    {% endif %}

    <form method="post" novalidate>
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label">{{ form.username.label }}</label>
        {{ form.username }}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.password.label }}</label>
        <div class="input-group">
          {{ form.password }}
          <button class="btn btn-outline-secondary" type="button" id="toggle-password" data-show="{% trans "Mostrar" %}" data-hide="{% trans "Ocultar" %}">{% trans "Mostrar" %}</button>
        </div>
      </div>
      <button type="submit" class="btn btn-primary w-100">{% trans "Entrar" %}</button>
    </form>

    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/password-reset/">{% trans "Esqueci minha senha" %}</a>
    </div>

    <!-- Bloco: Primeiro acesso -->
    <div class="mt-2 text-center">
      <a class="small text-decoration-none" href="{% url 'ui-first-access' %}">{% trans "Primeiro acesso / Criar conta" %}</a>
    </div>

    <div class="auth-footer text-muted small mt-4">
      {% trans "Dica: use o mesmo login do sistema administrativo se ja tiver acesso." %}
    </div>
  </div>
</div>

<script>
  const toggleBtn = document.getElementById("toggle-password");
  const passwordInput = document.getElementById("id_password");
  if (toggleBtn && passwordInput) {
    toggleBtn.addEventListener("click", () => {
      const showLabel = toggleBtn.dataset.show || "Mostrar";
      const hideLabel = toggleBtn.dataset.hide || "Ocultar";
      const isPassword = passwordInput.getAttribute("type") === "password";
      passwordInput.setAttribute("type", isPassword ? "text" : "password");
      toggleBtn.textContent = isPassword ? hideLabel : showLabel;
    });
  }
</script>
{% endblock %}

### templates/ui/messages/message_list.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Mensagens" %}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Mensagens" %}</h1>
    <div class="text-muted">{% trans "Historico de notificacoes" %}</div>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <form class="row g-2 align-items-end" method="get">
      <div class="col-md-3">
        <label class="form-label">{% trans "Status" %}</label>
        <select class="form-select" name="status">
          <option value="">{% trans "Todos os status" %}</option>
          {% for value, label in status_choices %}
            <option value="{{ value }}" {% if status_filter == value %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">{% trans "Canal" %}</label>
        <select class="form-select" name="channel">
          <option value="">{% trans "Todos os canais" %}</option>
          {% for value, label in channel_choices %}
            <option value="{{ value }}" {% if channel_filter == value %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
      </div>
      <div class="col-md-2">
        <button class="btn btn-outline-primary w-100" type="submit">{% trans "Filtrar" %}</button>
      </div>
      <div class="col-md-2">
        <a class="btn btn-outline-secondary w-100" href="{% url 'ui-message-list' %}">{% trans "Limpar" %}</a>
      </div>
    </form>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    {% if notifications %}
      <!-- Bloco: Tabela de historico -->
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>{% trans "Titulo" %}</th>
              <th>{% trans "Canal" %}</th>
              <th>{% trans "Status" %}</th>
              <th>{% trans "Acao" %}</th>
              <th>{% trans "Agendado" %}</th>
              <th>{% trans "Enviado" %}</th>
              <th>{% trans "Tentativas" %}</th>
              <th>{% trans "Erro" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for item in notifications %}
              <tr>
                <td>
                  <div class="fw-semibold">{{ item.title }}</div>
                  <div class="text-muted small">{{ item.message|truncatechars:80 }}</div>
                </td>
                <td>{{ item.get_channel_display }}</td>
                <td><span class="badge text-bg-light">{{ item.get_status_display }}</span></td>
                <td>{{ item.get_action_taken_display }}</td>
                <td>{{ item.scheduled_for|date:"d/m/Y H:i" }}</td>
                <td>
                  {% if item.sent_at %}
                    {{ item.sent_at|date:"d/m/Y H:i" }}
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td>{{ item.attempts }}</td>
                <td class="text-muted small">
                  {% if item.last_error %}
                    {{ item.last_error|truncatechars:40 }}
                  {% else %}
                    -
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhuma mensagem registrada." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/messages.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Mensagens" %}</h1>
    <div class="text-muted">{% trans "Avisos e comunicados in-app" %}</div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    {% if notifications %}
      <div class="list-group list-group-flush">
        {% for msg in notifications %}
          <div class="list-group-item">
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <div class="fw-semibold">{{ msg.title }}</div>
                <div class="text-muted small">{{ msg.scheduled_for|date:"d/m/Y H:i" }}</div>
              </div>
              <span class="badge text-bg-light text-muted">{{ msg.status }}</span>
            </div>
            <div class="mt-2 text-muted">{{ msg.message|linebreaksbr }}</div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhuma mensagem registrada." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/onboarding.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Onboarding" %}</h1>
    <div class="text-muted">{% trans "Etapas para completar a configuracao" %}</div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <ul class="list-group list-group-flush">
      {% for step in steps %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <div class="fw-semibold">{{ step.label }}</div>
            <div class="text-muted small">{{ step.message }}</div>
          </div>
          {% if step.missing %}
            <span class="badge text-bg-warning"></span>
          {% else %}
            <span class="badge text-bg-success"></span>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
</div>

{% if required_actions %}
<div class="card shadow-sm mt-3">
  <div class="card-header bg-white fw-semibold">{% trans "Acoes recomendadas" %}</div>
  <div class="card-body">
    <ul class="mb-0">
      {% for action in required_actions %}
        <li>{{ action }}</li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endif %}

<div class="card shadow-sm mt-3">
  <div class="card-header bg-white fw-semibold">{% trans "Sugestoes rapidas" %}</div>
  <div class="card-body">
    <ul class="mb-0">
      <li><a href="/semesters/">{% trans "Ver semestres" %}</a></li>
      <li><a href="/tasks/">{% trans "Ver tarefas" %}</a></li>
      <li><a href="/agenda/">{% trans "Ver agenda" %}</a></li>
      <li><a href="/api/semester/assessments/">{% trans "Cadastrar avaliacao (API)" %}</a></li>
    </ul>
  </div>
</div>
{% endblock %}

### templates/ui/password_reset_complete.html
--------------------------------------------------------------------------------
{% extends "ui/auth_base.html" %}
{% load i18n %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">{% trans "Senha atualizada" %}</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">{% trans "Senha redefinida" %}</h1>
    <p class="text-muted small">{% trans "Sua senha foi atualizada. Voce ja pode acessar o painel." %}</p>
    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/login/">{% trans "Ir para o login" %}</a>
    </div>
  </div>
</div>
{% endblock %}

### templates/ui/password_reset_confirm.html
--------------------------------------------------------------------------------
{% extends "ui/auth_base.html" %}
{% load i18n %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">{% trans "Nova senha" %}</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">{% trans "Definir nova senha" %}</h1>
    <form method="post">
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label" for="id_new_password1">{% trans "Nova senha" %}</label>
        <input class="form-control" type="password" name="new_password1" id="id_new_password1" required>
      </div>
      <div class="mb-3">
        <label class="form-label" for="id_new_password2">{% trans "Confirmar nova senha" %}</label>
        <input class="form-control" type="password" name="new_password2" id="id_new_password2" required>
      </div>
      <button type="submit" class="btn btn-primary w-100">{% trans "Atualizar senha" %}</button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/password_reset_done.html
--------------------------------------------------------------------------------
{% extends "ui/auth_base.html" %}
{% load i18n %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">{% trans "Email enviado" %}</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">{% trans "Verifique sua caixa de entrada" %}</h1>
    <p class="text-muted small">{% trans "Se o email existir no sistema, voce recebera um link para redefinir a senha." %}</p>
    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/login/">{% trans "Voltar ao login" %}</a>
    </div>
  </div>
</div>
{% endblock %}

### templates/ui/password_reset_form.html
--------------------------------------------------------------------------------
{% extends "ui/auth_base.html" %}
{% load i18n %}

{% block content %}
<div class="auth-card shadow-sm">
  <div class="auth-header">
    <div class="auth-logo">Campus Calm</div>
    <div class="auth-subtitle">{% trans "Recuperacao de acesso" %}</div>
  </div>
  <div class="auth-body">
    <h1 class="h5 mb-3">{% trans "Redefinir senha" %}</h1>
    <p class="text-muted small mb-4">{% trans "Informe seu email para receber o link de redefinicao." %}</p>

    <form method="post">
      {% csrf_token %}
      <div class="mb-3">
        <label class="form-label" for="id_email">{% trans "Email" %}</label>
        <input class="form-control" type="email" name="email" id="id_email" placeholder="{% trans "seu.email@universidade.edu" %}" required>
      </div>
      <button type="submit" class="btn btn-primary w-100">{% trans "Enviar link" %}</button>
    </form>

    <div class="mt-3 text-center">
      <a class="small text-decoration-none" href="/login/">{% trans "Voltar ao login" %}</a>
    </div>
  </div>
</div>
{% endblock %}

### templates/ui/reminders/reminder_confirm_delete.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-reminder-list' %}">{% trans "Lembretes" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Excluir lembrete" %}</li>
  </ol>
</nav>

<div class="card shadow-sm">
  <div class="card-body">
    <h1 class="h5 mb-3">{% trans "Excluir lembrete" %}</h1>
    <p class="text-muted">{% trans "Tem certeza que deseja excluir a regra de lembrete" %}?</p>
    <form method="post">
      {% csrf_token %}
      <a class="btn btn-outline-secondary" href="{% url 'ui-reminder-list' %}">{% trans "Cancelar" %}</a>
      <button class="btn btn-danger" type="submit">{% trans "Excluir" %}</button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/reminders/reminder_form.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-reminder-list' %}">{% trans "Lembretes" %}</a></li>
    {% if mode == "edit" %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Editar lembrete" %}</li>
    {% else %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Novo lembrete" %}</li>
    {% endif %}
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    {% if mode == "edit" %}
      <h1 class="h4 mb-1">{% trans "Editar lembrete" %}</h1>
      <div class="text-muted">{% trans "Atualize sua regra de lembrete." %}</div>
    {% else %}
      <h1 class="h4 mb-1">{% trans "Novo lembrete" %}</h1>
      <div class="text-muted">{% trans "Crie uma nova regra de lembrete." %}</div>
    {% endif %}
  </div>
  <a class="btn btn-outline-secondary" href="{% url 'ui-reminder-list' %}">{% trans "Voltar" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
      {% endif %}
      <div class="mb-3">
        <label class="form-label">{{ form.target_type.label }}</label>
        {{ form.target_type }}
        {% for error in form.target_type.errors %}
          <div class="text-danger small">{{ error }}</div>
        {% endfor %}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.remind_before_minutes.label }}</label>
        {{ form.remind_before_minutes }}
        {% for error in form.remind_before_minutes.errors %}
          <div class="text-danger small">{{ error }}</div>
        {% endfor %}
      </div>
      <div class="mb-3">
        <label class="form-label">{{ form.channels.label }}</label>
        <div class="d-flex flex-column gap-1">
          {{ form.channels }}
        </div>
        {% for error in form.channels.errors %}
          <div class="text-danger small">{{ error }}</div>
        {% endfor %}
      </div>
      <div class="form-check mb-3">
        {{ form.is_active }}
        <label class="form-check-label" for="{{ form.is_active.id_for_label }}">{{ form.is_active.label }}</label>
      </div>
      <button class="btn btn-primary" type="submit">
        {% if mode == "edit" %}{% trans "Salvar" %}{% else %}{% trans "Criar" %}{% endif %}
      </button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/reminders/reminder_list.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Lembretes" %}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Lembretes" %}</h1>
    <div class="text-muted">{% trans "Configure suas regras de lembrete." %}</div>
  </div>
  <!-- Bloco: Acoes -->
  <div class="d-flex gap-2">
    <form method="post" action="{% url 'ui-reminder-generate' %}">
      {% csrf_token %}
      <button class="btn btn-outline-primary" type="submit">{% trans "Gerar lembretes" %}</button>
    </form>
    <a class="btn btn-primary" href="{% url 'ui-reminder-create' %}">{% trans "Novo lembrete" %}</a>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    {% if reminders %}
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>{% trans "Tipo" %}</th>
              <th>{% trans "Minutos antes" %}</th>
              <th>{% trans "Canais" %}</th>
              <th>{% trans "Status" %}</th>
              <th class="text-end">{% trans "Acoes" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for reminder in reminders %}
              <tr>
                <td>{{ reminder.get_target_type_display }}</td>
                <td>{{ reminder.remind_before_minutes }}</td>
                <td>
                  {% if reminder.channels %}
                    {{ reminder.channels|join:", " }}
                  {% else %}
                    -
                  {% endif %}
                </td>
                <td>
                  {% if reminder.is_active %}
                    <span class="badge text-bg-success">{% trans "Ativo" %}</span>
                  {% else %}
                    <span class="badge text-bg-secondary">{% trans "Inativo" %}</span>
                  {% endif %}
                </td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-secondary" href="{% url 'ui-reminder-edit' reminder.pk %}">{% trans "Editar" %}</a>
                  <a class="btn btn-sm btn-outline-danger" href="{% url 'ui-reminder-delete' reminder.pk %}">{% trans "Excluir" %}</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhuma regra de lembrete cadastrada." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/semester/semester_confirm_delete.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Excluir semestre" %}</li>
  </ol>
</nav>

<div class="card shadow-sm">
  <div class="card-body">
    <h1 class="h5 mb-3">{% trans "Excluir semestre" %}</h1>
    <p class="text-muted">{% trans "Tem certeza que deseja excluir o semestre" %} <strong>{{ semester.name }}</strong>?</p>
    <form method="post">
      {% csrf_token %}
      <a class="btn btn-outline-secondary" href="{% url 'ui-semester-detail' semester.pk %}">{% trans "Cancelar" %}</a>
      <button class="btn btn-danger" type="submit">{% trans "Excluir" %}</button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/semester/semester_detail.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ semester.name }}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h4 mb-1">{{ semester.name }}</h1>
    <div class="text-muted">
      {% trans "Periodo" %}: {{ semester.start_date|date:"d/m/Y" }} - {{ semester.end_date|date:"d/m/Y" }}
    </div>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary" href="{% url 'ui-semester-list' %}">{% trans "Voltar" %}</a>
    <a class="btn btn-outline-primary" href="{% url 'ui-semester-edit' semester.pk %}">{% trans "Editar" %}</a>
    <a class="btn btn-primary" href="{% url 'ui-course-create' semester.pk %}">{% trans "Nova Disciplina" %}</a>
  </div>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <div class="d-flex flex-wrap gap-3">
      <div>
        <div class="text-muted small">{% trans "Status" %}</div>
        <div class="fw-semibold">{{ semester.get_status_display }}</div>
      </div>
      <div>
        <div class="text-muted small">{% trans "Inicio" %}</div>
        <div class="fw-semibold">{{ semester.start_date|date:"d/m/Y" }}</div>
      </div>
      <div>
        <div class="text-muted small">{% trans "Termino" %}</div>
        <div class="fw-semibold">{{ semester.end_date|date:"d/m/Y" }}</div>
      </div>
    </div>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h2 class="h6 mb-0">{% trans "Disciplinas" %}</h2>
    </div>
    {% if courses %}
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>{% trans "Disciplina" %}</th>
              <th>{% trans "Professor" %}</th>
              <th>{% trans "Status" %}</th>
              <th class="text-end">{% trans "Acoes" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for course in courses %}
              <tr>
                <td>{{ course.title }}</td>
                <td>{{ course.teacher|default:"-" }}</td>
                <td>{{ course.get_status_display }}</td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-primary" href="{% url 'ui-course-detail' course.pk %}">{% trans "Ver" %}</a>
                  <a class="btn btn-sm btn-outline-secondary" href="{% url 'ui-course-edit' course.pk %}">{% trans "Editar" %}</a>
                  <a class="btn btn-sm btn-outline-danger" href="{% url 'ui-course-delete' course.pk %}">{% trans "Excluir" %}</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhuma disciplina cadastrada." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/semester/semester_form.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-semester-list' %}">{% trans "Semestres" %}</a></li>
    {% if mode == "edit" %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Editar semestre" %}</li>
    {% else %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Novo semestre" %}</li>
    {% endif %}
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    {% if mode == "edit" %}
      <h1 class="h4 mb-1">{% trans "Editar semestre" %}</h1>
      <div class="text-muted">{{ semester.name }}</div>
    {% else %}
      <h1 class="h4 mb-1">{% trans "Novo semestre" %}</h1>
      <div class="text-muted">{% trans "Cadastre um novo semestre." %}</div>
    {% endif %}
  </div>
  <a class="btn btn-outline-secondary" href="{% url 'ui-semester-list' %}">{% trans "Voltar" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
      {% endif %}
      {% for field in form %}
        <div class="mb-3">
          <label class="form-label">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <div class="form-text">{{ field.help_text }}</div>
          {% endif %}
          {% for error in field.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>
      {% endfor %}
      <button class="btn btn-primary" type="submit">
        {% if mode == "edit" %}{% trans "Salvar" %}{% else %}{% trans "Criar" %}{% endif %}
      </button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/semester/semester_list.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Semestres" %}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Semestres" %}</h1>
    <div class="text-muted">{% trans "Gerencie seus semestres e disciplinas." %}</div>
  </div>
  <a class="btn btn-primary" href="{% url 'ui-semester-create' %}">{% trans "Novo Semestre" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    {% if semesters %}
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>{% trans "Nome" %}</th>
              <th>{% trans "Inicio" %}</th>
              <th>{% trans "Termino" %}</th>
              <th>{% trans "Status" %}</th>
              <th class="text-end">{% trans "Acoes" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for semester in semesters %}
              <tr>
                <td>{{ semester.name }}</td>
                <td>{{ semester.start_date|date:"d/m/Y" }}</td>
                <td>{{ semester.end_date|date:"d/m/Y" }}</td>
                <td>{{ semester.get_status_display }}</td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-primary" href="{% url 'ui-semester-detail' semester.pk %}">{% trans "Ver" %}</a>
                  <a class="btn btn-sm btn-outline-secondary" href="{% url 'ui-semester-edit' semester.pk %}">{% trans "Editar" %}</a>
                  <a class="btn btn-sm btn-outline-danger" href="{% url 'ui-semester-delete' semester.pk %}">{% trans "Excluir" %}</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhum semestre cadastrado." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/semesters.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Semestres" %}</h1>
    <div class="text-muted">{% trans "Resumo das disciplinas e progresso" %}</div>
  </div>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-sm-4 col-md-2">
    <select class="form-select form-select-sm" name="status">
      <option value="">{% trans "Todos os status" %}</option>
      <option value="ACTIVE" {% if status_filter == "ACTIVE" %}selected{% endif %}>{% trans "Ativo" %}</option>
      <option value="FINISHED" {% if status_filter == "FINISHED" %}selected{% endif %}>{% trans "Finalizado" %}</option>
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="course" placeholder="{% trans "Filtrar por disciplina" %}"
           value="{{ course_query }}">
  </div>
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="teacher" placeholder="{% trans "Filtrar por professor" %}"
           value="{{ teacher_query }}">
  </div>
  <div class="col-auto">
    <button class="btn btn-sm btn-outline-secondary" type="submit">{% trans "Filtrar" %}</button>
    <a class="btn btn-sm btn-link" href="/semesters/?clear=1">{% trans "Limpar" %}</a>
  </div>
</form>

{% if semesters %}
  {% for semester in semesters %}
    <div class="card shadow-sm mb-3">
      <div class="card-header bg-white d-flex justify-content-between">
        <div class="fw-semibold">{{ semester.name }}</div>
        <div class="text-muted small">{{ semester.start_date|date:"d/m/Y" }} - {{ semester.end_date|date:"d/m/Y" }}</div>
      </div>
      <div class="card-body">
        {% if semester.courses %}
          <div class="table-responsive">
            <table class="table table-sm align-middle">
              <thead>
                <tr>
                  <th>{% trans "Disciplina" %}</th>
                  <th>{% trans "Professor" %}</th>
                  <th>{% trans "Status" %}</th>
                  <th>{% trans "Media atual" %}</th>
                  <th>{% trans "Progresso" %}</th>
                  <th>{% trans "Falta para passar" %}</th>
                </tr>
              </thead>
              <tbody>
                {% for course in semester.courses %}
                  <tr>
                    <td>{{ course.title }}</td>
                    <td>{{ course.teacher|default:"-" }}</td>
                    <td>
                      {% if course.status == "PASSED" %}
                        <span class="badge text-bg-success">{% trans "Aprovado" %}</span>
                      {% elif course.status == "FAILED" %}
                        <span class="badge text-bg-danger">{% trans "Reprovado" %}</span>
                      {% else %}
                        <span class="badge text-bg-secondary">{% trans "Em andamento" %}</span>
                      {% endif %}
                    </td>
                    <td>{{ course.current_average }}</td>
                    <td style="min-width: 180px;">
                      <div class="d-flex justify-content-between">
                        <span class="small text-muted">{{ course.progress_percent }}%</span>
                      </div>
                      <div class="progress mt-1" style="height: 6px;">
                        <div class="progress-bar" role="progressbar" style="width: {{ course.progress_percent_css }}%;"></div>
                      </div>
                    </td>
                    <td>{{ course.needed_to_pass }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        {% else %}
          <div class="text-muted">{% trans "Nenhuma disciplina cadastrada." %}</div>
        {% endif %}
      </div>
    </div>
  {% endfor %}
{% else %}
  <div class="alert alert-info">{% trans "Nenhum semestre cadastrado." %}</div>
{% endif %}
{% endblock %}

### templates/ui/tasks/task_confirm_delete.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-task-list' %}">{% trans "Tarefas" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Excluir tarefa" %}</li>
  </ol>
</nav>

<div class="card shadow-sm">
  <div class="card-body">
    <h1 class="h5 mb-3">{% trans "Excluir tarefa" %}</h1>
    <p class="text-muted">{% trans "Tem certeza que deseja excluir a tarefa" %} <strong>{{ task.title }}</strong>?</p>
    <form method="post">
      {% csrf_token %}
      <a class="btn btn-outline-secondary" href="{% url 'ui-task-detail' task.pk %}">{% trans "Cancelar" %}</a>
      <button class="btn btn-danger" type="submit">{% trans "Excluir" %}</button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/tasks/task_detail.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-task-list' %}">{% trans "Tarefas" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{ task.title }}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h4 mb-1">{{ task.title }}</h1>
    <div class="text-muted">{% trans "Entrega" %}: {{ task.due_date|date:"d/m/Y" }}</div>
  </div>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary" href="{% url 'ui-task-list' %}">{% trans "Voltar" %}</a>
    <a class="btn btn-outline-primary" href="{% url 'ui-task-edit' task.pk %}">{% trans "Editar" %}</a>
    <a class="btn btn-outline-danger" href="{% url 'ui-task-delete' task.pk %}">{% trans "Excluir" %}</a>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="row g-3">
      <div class="col-md-3">
        <div class="text-muted small">{% trans "Status" %}</div>
        <div class="fw-semibold">{{ task.get_status_display }}</div>
      </div>
      <div class="col-md-3">
        <div class="text-muted small">{% trans "Nivel de estresse" %}</div>
        <div class="fw-semibold">{{ task.stress_level }}</div>
      </div>
      <div class="col-md-6">
        <div class="text-muted small">{% trans "Descricao" %}</div>
        <div class="fw-semibold">{{ task.description|default:"-" }}</div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

### templates/ui/tasks/task_form.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item"><a href="{% url 'ui-task-list' %}">{% trans "Tarefas" %}</a></li>
    {% if mode == "edit" %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Editar tarefa" %}</li>
    {% else %}
      <li class="breadcrumb-item active" aria-current="page">{% trans "Nova tarefa" %}</li>
    {% endif %}
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    {% if mode == "edit" %}
      <h1 class="h4 mb-1">{% trans "Editar tarefa" %}</h1>
      <div class="text-muted">{{ task.title }}</div>
    {% else %}
      <h1 class="h4 mb-1">{% trans "Nova tarefa" %}</h1>
      <div class="text-muted">{% trans "Cadastre uma nova tarefa." %}</div>
    {% endif %}
  </div>
  <a class="btn btn-outline-secondary" href="{% url 'ui-task-list' %}">{% trans "Voltar" %}</a>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    <form method="post">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="alert alert-danger">{{ form.non_field_errors }}</div>
      {% endif %}
      {% for field in form %}
        <div class="mb-3">
          <label class="form-label">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <div class="form-text">{{ field.help_text }}</div>
          {% endif %}
          {% for error in field.errors %}
            <div class="text-danger small">{{ error }}</div>
          {% endfor %}
        </div>
      {% endfor %}
      <button class="btn btn-primary" type="submit">
        {% if mode == "edit" %}{% trans "Salvar" %}{% else %}{% trans "Criar" %}{% endif %}
      </button>
    </form>
  </div>
</div>
{% endblock %}

### templates/ui/tasks/task_list.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{% trans "Dashboard" %}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{% trans "Tarefas" %}</li>
  </ol>
</nav>

<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Tarefas" %}</h1>
    <div class="text-muted">{% trans "Organize suas tarefas e prazos." %}</div>
  </div>
  <a class="btn btn-primary" href="{% url 'ui-task-create' %}">{% trans "Nova tarefa" %}</a>
</div>

<div class="card shadow-sm mb-4">
  <div class="card-body">
    <form class="row g-2 align-items-end" method="get">
      <div class="col-md-4">
        <label class="form-label">{% trans "Buscar" %}</label>
        <input class="form-control" type="text" name="q" value="{{ query }}" placeholder="{% trans "Buscar tarefa" %}">
      </div>
      <div class="col-md-3">
        <label class="form-label">{% trans "Status" %}</label>
        <select class="form-select" name="status">
          <option value="">{% trans "Todos os status" %}</option>
          <option value="TODO" {% if status_filter == "TODO" %}selected{% endif %}>{% trans "A fazer" %}</option>
          <option value="DOING" {% if status_filter == "DOING" %}selected{% endif %}>{% trans "Em andamento" %}</option>
          <option value="DONE" {% if status_filter == "DONE" %}selected{% endif %}>{% trans "Concluida" %}</option>
        </select>
      </div>
      <div class="col-md-2">
        <button class="btn btn-outline-primary w-100" type="submit">{% trans "Filtrar" %}</button>
      </div>
      <div class="col-md-2">
        <a class="btn btn-outline-secondary w-100" href="{% url 'ui-task-list' %}">{% trans "Limpar" %}</a>
      </div>
    </form>
  </div>
</div>

<div class="card shadow-sm">
  <div class="card-body">
    {% if tasks %}
      <div class="table-responsive">
        <table class="table align-middle">
          <thead>
            <tr>
              <th>{% trans "Tarefa" %}</th>
              <th>{% trans "Entrega" %}</th>
              <th>{% trans "Status" %}</th>
              <th>{% trans "Estresse" %}</th>
              <th class="text-end">{% trans "Acoes" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for task in tasks %}
              <tr>
                <td>{{ task.title }}</td>
                <td>{{ task.due_date|date:"d/m/Y" }}</td>
                <td><span class="badge text-bg-light">{{ task.get_status_display }}</span></td>
                <td><span class="badge text-bg-secondary">{{ task.stress_level }}</span></td>
                <td class="text-end">
                  <a class="btn btn-sm btn-outline-primary" href="{% url 'ui-task-detail' task.pk %}">{% trans "Ver" %}</a>
                  <a class="btn btn-sm btn-outline-secondary" href="{% url 'ui-task-edit' task.pk %}">{% trans "Editar" %}</a>
                  <a class="btn btn-sm btn-outline-danger" href="{% url 'ui-task-delete' task.pk %}">{% trans "Excluir" %}</a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhuma tarefa cadastrada." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### templates/ui/tasks.html
--------------------------------------------------------------------------------
{% extends "base.html" %}
{% load i18n %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-4">
  <div>
    <h1 class="h4 mb-1">{% trans "Tarefas" %}</h1>
    <div class="text-muted">{% trans "Lista de tarefas academicas" %}</div>
  </div>
</div>

<form class="row g-2 mb-3" method="get">
  <div class="col-sm-4 col-md-3">
    <input class="form-control form-control-sm" type="text" name="q" placeholder="{% trans "Buscar tarefa" %}"
           value="{{ search_query }}">
  </div>
  <div class="col-sm-4 col-md-2">
    <select class="form-select form-select-sm" name="stress">
      <option value="">{% trans "Stress" %}</option>
      <option value="1" {% if stress_filter == "1" %}selected{% endif %}>1</option>
      <option value="2" {% if stress_filter == "2" %}selected{% endif %}>2</option>
      <option value="3" {% if stress_filter == "3" %}selected{% endif %}>3</option>
      <option value="4" {% if stress_filter == "4" %}selected{% endif %}>4</option>
      <option value="5" {% if stress_filter == "5" %}selected{% endif %}>5</option>
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="status">
      <option value="">{% trans "Todos os status" %}</option>
      <option value="TODO" {% if status_filter == "TODO" %}selected{% endif %}>{% trans "A fazer" %}</option>
      <option value="DOING" {% if status_filter == "DOING" %}selected{% endif %}>{% trans "Em andamento" %}</option>
      <option value="DONE" {% if status_filter == "DONE" %}selected{% endif %}>{% trans "Concluida" %}</option>
    </select>
  </div>
  <div class="col-sm-4 col-md-3">
    <select class="form-select form-select-sm" name="due">
      <option value="">{% trans "Todas as datas" %}</option>
      <option value="overdue" {% if due_filter == "overdue" %}selected{% endif %}>{% trans "Atrasadas" %}</option>
      <option value="today" {% if due_filter == "today" %}selected{% endif %}>{% trans "Hoje" %}</option>
      <option value="week" {% if due_filter == "week" %}selected{% endif %}>{% trans "Proxima semana" %}</option>
      <option value="month" {% if due_filter == "month" %}selected{% endif %}>{% trans "Proximo mes" %}</option>
    </select>
  </div>
  <div class="col-auto">
    <button class="btn btn-sm btn-outline-secondary" type="submit">{% trans "Filtrar" %}</button>
    <a class="btn btn-sm btn-link" href="/tasks/?clear=1">{% trans "Limpar" %}</a>
  </div>
</form>

<div class="card shadow-sm">
  <div class="card-body">
    {% if tasks %}
      <div class="table-responsive">
        <table class="table table-sm align-middle">
          <thead>
            <tr>
              <th>{% trans "Titulo" %}</th>
              <th>{% trans "Entrega" %}</th>
              <th>{% trans "Stress" %}</th>
              <th>{% trans "Status" %}</th>
            </tr>
          </thead>
          <tbody>
            {% for task in tasks %}
              <tr>
                <td>
                  <div class="fw-semibold">{{ task.title }}</div>
                  <div class="text-muted small">{{ task.description|default:"" }}</div>
                </td>
                <td>{{ task.due_date|date:"d/m/Y" }}</td>
                <td>{{ task.stress_level }}</td>
                <td>
                  {% if task.status == "DONE" %}
                    <span class="badge text-bg-success">{% trans "Concluida" %}</span>
                  {% elif task.status == "DOING" %}
                    <span class="badge text-bg-primary">{% trans "Em andamento" %}</span>
                  {% else %}
                    <span class="badge text-bg-secondary">{% trans "A fazer" %}</span>
                  {% endif %}
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    {% else %}
      <div class="text-muted">{% trans "Nenhuma tarefa cadastrada." %}</div>
    {% endif %}
  </div>
</div>
{% endblock %}

### utils/__init__.py
--------------------------------------------------------------------------------


### utils/academic_progress.py
--------------------------------------------------------------------------------
from decimal import Decimal, ROUND_HALF_UP


def calculate_course_average(course) -> Decimal:
    assessments = course.assessments.all()
    total_weight = sum((a.weight for a in assessments), Decimal("0"))
    if total_weight == 0:
        return Decimal("0")
    total_score = sum((a.score * a.weight for a in assessments), Decimal("0"))
    return (total_score / total_weight).quantize(Decimal("0.01"), rounding=ROUND_HALF_UP)


def calculate_progress_percent(course) -> Decimal:
    current_average = calculate_course_average(course)
    passing_grade = course.passing_grade or Decimal("0")
    if passing_grade == 0:
        return Decimal("0")
    progress = (current_average / passing_grade) * Decimal("100")
    return min(Decimal("100"), progress)


def calculate_needed_to_pass(course) -> Decimal:
    current_average = calculate_course_average(course)
    passing_grade = course.passing_grade or Decimal("0")
    needed = passing_grade - current_average
    return max(Decimal("0"), needed)


def update_course_status(course, semester_status: str | None = None) -> None:
    from utils.constants import COURSE_FAILED, COURSE_IN_PROGRESS, COURSE_PASSED, SEMESTER_FINISHED

    progress = calculate_progress_percent(course)
    if progress >= Decimal("100"):
        course.status = COURSE_PASSED
        return
    if semester_status == SEMESTER_FINISHED:
        course.status = COURSE_FAILED
        return
    course.status = COURSE_IN_PROGRESS

### utils/constants.py
--------------------------------------------------------------------------------
from django.utils.translation import gettext_lazy as _

PLAN_LITE = "LITE"
PLAN_PRO = "PRO"
PLAN_CHOICES = [
    (PLAN_LITE, "Lite"),
    (PLAN_PRO, "Pro"),
]

MOOD_VERY_BAD = "VERY_BAD"
MOOD_BAD = "BAD"
MOOD_OK = "OK"
MOOD_GOOD = "GOOD"
MOOD_VERY_GOOD = "VERY_GOOD"
MOOD_CHOICES = [
    (MOOD_VERY_BAD, "Very bad"),
    (MOOD_BAD, "Bad"),
    (MOOD_OK, "Ok"),
    (MOOD_GOOD, "Good"),
    (MOOD_VERY_GOOD, "Very good"),
]

POMODORO_COMPLETED = "COMPLETED"
POMODORO_STOPPED = "STOPPED"
POMODORO_STATUS_CHOICES = [
    (POMODORO_COMPLETED, "Completed"),
    (POMODORO_STOPPED, "Stopped"),
]

TASK_TODO = "TODO"
TASK_DOING = "DOING"
TASK_DONE = "DONE"
TASK_STATUS_CHOICES = [
    (TASK_TODO, _("Todo")),
    (TASK_DOING, _("Doing")),
    (TASK_DONE, _("Done")),
]

EVENT_PROVA = "PROVA"
EVENT_ENTREGA = "ENTREGA"
EVENT_APRESENTACAO = "APRESENTACAO"
EVENT_AULA_IMPORTANTE = "AULA_IMPORTANTE"
EVENT_REUNIAO_GRUPO = "REUNIAO_GRUPO"
EVENT_REUNIAO_PROFESSORES = "REUNIAO_PROFESSORES"
EVENT_ESTUDAR_FACULDADE = "ESTUDAR_FACULDADE"
EVENT_OUTRO = "OUTRO"
EVENT_TYPE_CHOICES = [
    (EVENT_PROVA, "Prova"),
    (EVENT_ENTREGA, "Entrega"),
    (EVENT_APRESENTACAO, "Apresentacao"),
    (EVENT_AULA_IMPORTANTE, "Aula importante"),
    (EVENT_REUNIAO_GRUPO, "Reuniao em grupo"),
    (EVENT_REUNIAO_PROFESSORES, "Reuniao com professores"),
    (EVENT_ESTUDAR_FACULDADE, "Estudar na faculdade"),
    (EVENT_OUTRO, "Outro"),
]

REMINDER_TARGET_TASK = "TASK"
REMINDER_TARGET_EVENT = "EVENT"
REMINDER_TARGET_CHOICES = [
    (REMINDER_TARGET_TASK, _("Tarefa")),
    (REMINDER_TARGET_EVENT, _("Evento")),
]

CHANNEL_IN_APP = "IN_APP"
CHANNEL_EMAIL = "EMAIL"
CHANNEL_WHATSAPP = "WHATSAPP"
CHANNEL_SMS = "SMS"
CHANNEL_CHOICES = [
    (CHANNEL_IN_APP, "In app"),
    (CHANNEL_EMAIL, "Email"),
    (CHANNEL_WHATSAPP, "WhatsApp"),
    (CHANNEL_SMS, "SMS"),
]

NOTIF_PENDING = "PENDING"
NOTIF_SENT = "SENT"
NOTIF_FAILED = "FAILED"
NOTIFICATION_STATUS_CHOICES = [
    (NOTIF_PENDING, "Pending"),
    (NOTIF_SENT, "Sent"),
    (NOTIF_FAILED, "Failed"),
]

ACTION_NONE = "NONE"
ACTION_CONFIRMED = "CONFIRMED"
ACTION_DELAYED = "DELAYED"
ACTION_CANCELED = "CANCELED"
NOTIFICATION_ACTION_CHOICES = [
    (ACTION_NONE, "None"),
    (ACTION_CONFIRMED, "Confirmed"),
    (ACTION_DELAYED, "Delayed"),
    (ACTION_CANCELED, "Canceled"),
]

SEMESTER_ACTIVE = "ACTIVE"
SEMESTER_FINISHED = "FINISHED"
SEMESTER_STATUS_CHOICES = [
    (SEMESTER_ACTIVE, "Active"),
    (SEMESTER_FINISHED, "Finished"),
]

COURSE_IN_PROGRESS = "IN_PROGRESS"
COURSE_PASSED = "PASSED"
COURSE_FAILED = "FAILED"
COURSE_STATUS_CHOICES = [
    (COURSE_IN_PROGRESS, "In progress"),
    (COURSE_PASSED, "Passed"),
    (COURSE_FAILED, "Failed"),
]

COACH_PRAZO_PROXIMO = "PRAZO_PROXIMO"
COACH_ATRASO = "ATRASO"
COACH_HUMOR_BAIXO = "HUMOR_BAIXO"
COACH_SEMESTRE_CONCLUIDO = "SEMESTRE_CONCLUIDO"
COACH_REPROVACAO = "REPROVACAO"
COACH_TRIGGER_CHOICES = [
    (COACH_PRAZO_PROXIMO, "Prazo proximo"),
    (COACH_ATRASO, "Atraso"),
    (COACH_HUMOR_BAIXO, "Humor baixo"),
    (COACH_SEMESTRE_CONCLUIDO, "Semestre concluido"),
    (COACH_REPROVACAO, "Reprovacao"),
]

CONTENT_PRE_PROVA = "PRE_PROVA"
CONTENT_ANTI_PROCRASTINACAO = "ANTI_PROCRASTINACAO"
CONTENT_FOCO = "FOCO"
CONTENT_CATEGORY_CHOICES = [
    (CONTENT_PRE_PROVA, "Pre-prova"),
    (CONTENT_ANTI_PROCRASTINACAO, "Anti-procrastinacao"),
    (CONTENT_FOCO, "Foco"),
]

REQUESTER_INDIVIDUAL = "INDIVIDUAL"
REQUESTER_INSTITUTION = "INSTITUTION"
REQUESTER_TYPE_CHOICES = [
    (REQUESTER_INDIVIDUAL, "Individual"),
    (REQUESTER_INSTITUTION, "Institution"),
]

ACCESS_PENDING = "PENDING"
ACCESS_APPROVED = "APPROVED"
ACCESS_REJECTED = "REJECTED"
ACCESS_STATUS_CHOICES = [
    (ACCESS_PENDING, "Pending"),
    (ACCESS_APPROVED, "Approved"),
    (ACCESS_REJECTED, "Rejected"),
]

STEP_1_PROFILE = "STEP_1_PROFILE"
STEP_2_SEMESTER = "STEP_2_SEMESTER"
STEP_3_COURSES = "STEP_3_COURSES"
STEP_4_ASSESSMENTS = "STEP_4_ASSESSMENTS"
STEP_5_REMINDERS = "STEP_5_REMINDERS"
STEP_6_DASHBOARD = "STEP_6_DASHBOARD"

FEATURE_MOOD_BASIC = "MOOD_BASIC"
FEATURE_POMODORO_BASIC = "POMODORO_BASIC"
FEATURE_PLANNER_BASIC = "PLANNER_BASIC"
FEATURE_AGENDA_BASIC = "AGENDA_BASIC"
FEATURE_IN_APP_REMINDERS = "IN_APP_REMINDERS"
FEATURE_DASHBOARD_BASIC = "DASHBOARD_BASIC"
FEATURE_CONTENT_LIMITED = "CONTENT_LIMITED"
FEATURE_EMAIL_NOTIFICATIONS = "EMAIL_NOTIFICATIONS"
FEATURE_REPORTS_ADVANCED = "REPORTS_ADVANCED"
FEATURE_SEMESTER_SUMMARY = "SEMESTER_SUMMARY"
FEATURE_COACH_ADVANCED = "COACH_ADVANCED"
FEATURE_CONTENT_FULL = "CONTENT_FULL"
FEATURE_WHATSAPP = "WHATSAPP"
FEATURE_SMS = "SMS"

### utils/features.py
--------------------------------------------------------------------------------
from typing import Optional

from rest_framework.exceptions import PermissionDenied

from billing.models import Plan, UserSubscription
from utils.constants import PLAN_LITE


def get_user_plan(user) -> Optional[Plan]:
    if not user or not getattr(user, "is_authenticated", False):
        return None
    subscription = (
        UserSubscription.objects.filter(user=user, is_active=True)
        .select_related("plan")
        .first()
    )
    if subscription and subscription.plan and subscription.plan.is_active:
        return subscription.plan
    return Plan.objects.filter(code=PLAN_LITE, is_active=True).first()


def has_feature(user, feature_name: str) -> bool:
    plan = get_user_plan(user)
    if not plan or plan.features is None:
        return False
    if isinstance(plan.features, list):
        return feature_name in plan.features
    if isinstance(plan.features, dict):
        return bool(plan.features.get(feature_name))
    return False


def require_feature(user, feature_name: str, message: Optional[str] = None) -> None:
    if not has_feature(user, feature_name):
        raise PermissionDenied(message or "Seu plano atual nao permite este recurso.")

### utils/gating.py
--------------------------------------------------------------------------------
from typing import List, Tuple

from django.utils.translation import gettext_lazy as _

from utils.constants import (
    STEP_1_PROFILE,
    STEP_2_SEMESTER,
    STEP_3_COURSES,
    STEP_4_ASSESSMENTS,
    STEP_5_REMINDERS,
    STEP_6_DASHBOARD,
)

STEPS = [
    (STEP_1_PROFILE, "has_profile", _("Complete seu perfil para continuar.")),
    (STEP_2_SEMESTER, "has_active_semester", _("Crie um semestre ativo.")),
    (STEP_3_COURSES, "has_at_least_one_course", _("Cadastre ao menos uma disciplina.")),
    (STEP_4_ASSESSMENTS, "has_at_least_one_assessment", _("Cadastre ao menos uma avaliacao.")),
    (STEP_5_REMINDERS, "has_reminder_rule", _("Configure pelo menos uma regra de lembrete.")),
    (STEP_6_DASHBOARD, None, _("Tudo pronto para seu dashboard.")),
]


def get_or_create_progress(user):
    from onboarding.models import UserSetupProgress

    progress, _ = UserSetupProgress.objects.get_or_create(user=user)
    return progress


def compute_status(progress) -> Tuple[str, List[str], List[str]]:
    missing_steps = []
    required_actions = []
    for step, field, message in STEPS:
        if field is None:
            continue
        if not getattr(progress, field):
            missing_steps.append(step)
            required_actions.append(message)
    current_step = missing_steps[0] if missing_steps else STEP_6_DASHBOARD
    return current_step, missing_steps, required_actions


def gate_course_progress(course) -> Tuple[bool, str]:
    if not course.assessments.exists():
        return False, "Cadastre ao menos uma avaliacao antes de ver o progresso."
    return True, ""


def gate_finish_semester(semester) -> Tuple[bool, str]:
    if not semester.courses.exists():
        return False, "Nao e possivel finalizar um semestre sem disciplinas."
    return True, ""


def gate_generate_reminders(user) -> Tuple[bool, str]:
    from agenda.models import ReminderRule

    if not ReminderRule.objects.filter(user=user, is_active=True).exists():
        return False, "Configure uma regra de lembrete antes de gerar notificacoes."
    return True, ""

### utils/messages.py
--------------------------------------------------------------------------------
from dataclasses import dataclass
from datetime import timedelta
from typing import Iterable, Optional

from django.core.mail import send_mail
from django.utils import timezone

from notifications.models import NotificationQueue
from utils.constants import (
    CHANNEL_EMAIL,
    CHANNEL_IN_APP,
    CHANNEL_SMS,
    CHANNEL_WHATSAPP,
    FEATURE_EMAIL_NOTIFICATIONS,
    FEATURE_SMS,
    FEATURE_WHATSAPP,
    NOTIF_FAILED,
    NOTIF_SENT,
)
from utils.features import has_feature


MESSAGE_REMINDER = "REMINDER"
MESSAGE_CARE = "CARE"
MESSAGE_INCENTIVE = "INCENTIVE"
MESSAGE_WARNING = "WARNING"
MESSAGE_ACHIEVEMENT = "ACHIEVEMENT"
MESSAGE_SYSTEM = "SYSTEM"

PRIORITY_LOW = "LOW"
PRIORITY_NORMAL = "NORMAL"
PRIORITY_HIGH = "HIGH"


@dataclass
class MessageTemplate:
    title: str
    body: str
    suggested_action: Optional[str] = None
    priority: str = PRIORITY_NORMAL


TEMPLATES = {
    (MESSAGE_INCENTIVE, "assessment_progress_up"): MessageTemplate(
        title="Progresso em disciplina",
        body=(
            "Voce avancou bem na disciplina {course}. "
            "Seu progresso atual esta em {progress}% e segue em evoluo."
        ),
        suggested_action="Manter pequenos blocos de estudo pode ajudar a seguir tranquilo.",
        priority=PRIORITY_NORMAL,
    ),
    (MESSAGE_CARE, "assessment_progress_down"): MessageTemplate(
        title="Ajuste de ritmo",
        body=(
            "Seu progresso em {course} teve uma pequena queda. "
            "Isso pode acontecer em semanas mais intensas."
        ),
        suggested_action="Revisar pontos-chave com calma pode trazer mais estabilidade.",
        priority=PRIORITY_NORMAL,
    ),
    (MESSAGE_WARNING, "low_progress_upcoming"): MessageTemplate(
        title="Ateno suave",
        body=(
            "Talvez revisar {course} com pequenos blocos ajuda a reduzir a presso desta semana."
        ),
        suggested_action="Escolha um horario curto para revisar o conteudo mais importante.",
        priority=PRIORITY_HIGH,
    ),
    (MESSAGE_ACHIEVEMENT, "course_passed"): MessageTemplate(
        title="Meta alcanada",
        body=(
            "Voce atingiu a media necessaria em {course}. Otimo avanco."
        ),
        suggested_action="Continue acompanhando as proximas avaliaces com tranquilidade.",
        priority=PRIORITY_NORMAL,
    ),
    (MESSAGE_ACHIEVEMENT, "semester_all_passed"): MessageTemplate(
        title="Semestre concluido",
        body=(
            "Voce concluiu o semestre com todas as disciplinas aprovadas. "
            "Parabens pelo cuidado e consistencia."
        ),
        suggested_action="Reserve um tempo para celebrar e recarregar as energias.",
        priority=PRIORITY_NORMAL,
    ),
    (MESSAGE_CARE, "semester_with_fail"): MessageTemplate(
        title="Continuidade do semestre",
        body=(
            "Algumas disciplinas ficaram abaixo da media no fechamento. "
            "Isso no diminui seu esforco, siga firme."
        ),
        suggested_action="Podemos organizar um plano simples de retomada para o proximo ciclo.",
        priority=PRIORITY_NORMAL,
    ),
    (MESSAGE_INCENTIVE, "semester_continue"): MessageTemplate(
        title="Plano de continuidade",
        body=(
            "Com alguns ajustes, voce pode recuperar o ritmo nas proximas semanas."
        ),
        suggested_action="Defina metas curtas e realistas para reequilibrar as disciplinas.",
        priority=PRIORITY_LOW,
    ),
}


def _build_message(message_type: str, context: dict) -> MessageTemplate:
    event = context.get("event")
    template = TEMPLATES.get((message_type, event))
    if not template:
        template = MessageTemplate(
            title="Mensagem do Campus Calm",
            body=context.get("body", "Estamos aqui para apoiar sua jornada academica."),
            suggested_action=context.get("suggested_action"),
        )
    return MessageTemplate(
        title=template.title.format(**context),
        body=template.body.format(**context),
        suggested_action=template.suggested_action.format(**context)
        if template.suggested_action
        else None,
        priority=template.priority,
    )


def _should_skip_duplicate(user, title: str) -> bool:
    since = timezone.now() - timedelta(hours=24)
    return NotificationQueue.objects.filter(user=user, title=title, scheduled_for__gte=since).exists()


def send_message(user, message_type: str, context: dict, channels: Optional[Iterable[str]] = None) -> None:
    if channels is None:
        channels = [CHANNEL_IN_APP]
    channels = list(dict.fromkeys(channels))
    if CHANNEL_IN_APP not in channels:
        channels.insert(0, CHANNEL_IN_APP)

    message = _build_message(message_type, context)
    if _should_skip_duplicate(user, message.title):
        return

    base_body = message.body
    if message.suggested_action:
        base_body = f"{base_body}\n\nSugestao: {message.suggested_action}"

    now = timezone.now()
    for channel in channels:
        if channel == CHANNEL_EMAIL and not has_feature(user, FEATURE_EMAIL_NOTIFICATIONS):
            continue
        if channel == CHANNEL_WHATSAPP and not has_feature(user, FEATURE_WHATSAPP):
            continue
        if channel == CHANNEL_SMS and not has_feature(user, FEATURE_SMS):
            continue

        status = NOTIF_SENT
        if channel == CHANNEL_EMAIL:
            try:
                send_mail(message.title, base_body, None, [user.email])
            except Exception:
                status = NOTIF_FAILED

        NotificationQueue.objects.create(
            user=user,
            channel=channel,
            title=message.title,
            message=base_body,
            scheduled_for=now,
            status=status,
        )

### utils/triage.py
--------------------------------------------------------------------------------
import os
from typing import Dict

from utils.constants import (
    FEATURE_COACH_ADVANCED,
    FEATURE_EMAIL_NOTIFICATIONS,
    FEATURE_REPORTS_ADVANCED,
    FEATURE_SMS,
    FEATURE_WHATSAPP,
    PLAN_LITE,
    PLAN_PRO,
    REQUESTER_INSTITUTION,
)

TRIAGE_MODEL_NAME = os.getenv("TRIAGE_MODEL_NAME", "mock-v1")
TRIAGE_USE_LLM = os.getenv("TRIAGE_USE_LLM", "false").lower() == "true"


def rule_based_plan(access_request) -> str:
    if access_request.requester_type == REQUESTER_INSTITUTION:
        return PLAN_PRO
    if access_request.estimated_users and access_request.estimated_users >= 50:
        return PLAN_PRO
    wants = set(access_request.wants_features or [])
    pro_features = {
        FEATURE_REPORTS_ADVANCED,
        FEATURE_EMAIL_NOTIFICATIONS,
        FEATURE_WHATSAPP,
        FEATURE_SMS,
        FEATURE_COACH_ADVANCED,
    }
    if wants.intersection(pro_features):
        return PLAN_PRO
    return PLAN_LITE


def mock_ai_output(recommended_plan: str) -> Dict[str, object]:
    if recommended_plan == PLAN_PRO:
        score = 82
        rationale = "Solicitacao com sinais de necessidade avancada."
    else:
        score = 28
        rationale = "Solicitacao adequada ao plano basico."
    return {
        "score": score,
        "recommended_plan": recommended_plan,
        "rationale": rationale,
        "llm_enabled": TRIAGE_USE_LLM,
    }


def run_triage(access_request) -> Dict[str, object]:
    recommended_plan = rule_based_plan(access_request)
    output = mock_ai_output(recommended_plan)
    return {
        "recommended_plan": recommended_plan,
        "output_payload": output,
    }

